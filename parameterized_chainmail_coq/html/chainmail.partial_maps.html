<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<link href="coqdocjs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="config.js"></script>
<script type="text/javascript" src="coqdocjs.js"></script>
</head>

<body onload="document.getElementById('content').focus()">
  <div id="header">
    <span class="left">
      <span class="modulename"> <script> document.write(document.title) </script> </span>
    </span>

    <span class="button" id="toggle-proofs"></span>

    <span class="right">
      <a href="../">Project Page</a>
      <a href="./indexpage.html"> Index </a>
      <a href="./toc.html"> Table of Contents </a>
    </span>
</div>
    <div id="content" tabindex="-1" onblur="document.getElementById('content').focus()">
    <div id="main">
<h1 class="libtitle">chainmail.partial_maps</h1>

<div class="code">
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="chainmail.common.html#"><span class="id" title="library">common</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="chainmail.defs.html#"><span class="id" title="library">defs</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Lists.List.html#"><span class="id" title="library">List</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="chainmail.CpdtTactics.html#"><span class="id" title="library">CpdtTactics</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Logic.FunctionalExtensionality.html#"><span class="id" title="library">Coq.Logic.FunctionalExtensionality</span></a>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">notHyp</span> <span class="id" title="var">P</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" title="var">_</span> : <span class="id" title="var">P</span> |- <span class="id" title="var">_</span> ] =&gt; <span class="id" title="tactic">fail</span> 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">P</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| ?<span class="id" title="var">P1</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> ?<span class="id" title="var">P2</span> =&gt; <span class="id" title="tactic">first</span> [ <span class="id" title="var">notHyp</span> <span class="id" title="var">P1</span> | <span class="id" title="var">notHyp</span> <span class="id" title="var">P2</span> | <span class="id" title="tactic">fail</span> 2 ]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">idtac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">destruct_exists_loo</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| [<span class="id" title="var">H</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <span class="id" title="var">_</span> : <a class="idref" href="chainmail.defs.html#config"><span class="id" title="definition">config</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> σ := <span class="id" title="tactic">fresh</span> "σ" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> [σ]<br/>
&nbsp;&nbsp;| [<span class="id" title="var">H</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <span class="id" title="var">_</span> : <a class="idref" href="chainmail.defs.html#frame"><span class="id" title="record">frame</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">ϕ</span> := <span class="id" title="tactic">fresh</span> "ϕ" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">ϕ</span>]<br/>
&nbsp;&nbsp;| [<span class="id" title="var">H</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <span class="id" title="var">_</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="chainmail.defs.html#frame"><span class="id" title="record">frame</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> ψ := <span class="id" title="tactic">fresh</span> "ψ" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> [ψ]<br/>
&nbsp;&nbsp;| [<span class="id" title="var">H</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <span class="id" title="var">_</span> : <a class="idref" href="chainmail.defs.html#stack"><span class="id" title="definition">stack</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> ψ := <span class="id" title="tactic">fresh</span> "ψ" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> [ψ]<br/>
&nbsp;&nbsp;| [<span class="id" title="var">H</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <span class="id" title="var">_</span> : <a class="idref" href="chainmail.defs.html#heap"><span class="id" title="definition">heap</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> χ := <span class="id" title="tactic">fresh</span> "χ" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> [χ]<br/>
&nbsp;&nbsp;| [<span class="id" title="var">H</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <span class="id" title="var">_</span> : <a class="idref" href="chainmail.defs.html#stmt"><span class="id" title="inductive">stmt</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">s</span> := <span class="id" title="tactic">fresh</span> "s" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">s</span>]<br/>
&nbsp;&nbsp;| [<span class="id" title="var">H</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <span class="id" title="var">_</span> : <a class="idref" href="chainmail.defs.html#continuation"><span class="id" title="inductive">continuation</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">c</span> := <span class="id" title="tactic">fresh</span> "c" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">c</span>]<br/>
&nbsp;&nbsp;| [<span class="id" title="var">H</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <span class="id" title="var">_</span> : <a class="idref" href="chainmail.common.html#partial_map"><span class="id" title="definition">partial_map</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">f</span> := <span class="id" title="tactic">fresh</span> "f" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">f</span>]<br/>
&nbsp;&nbsp;| [<span class="id" title="var">H</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <span class="id" title="var">_</span> : <a class="idref" href="chainmail.defs.html#mth"><span class="id" title="inductive">mth</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">m</span> := <span class="id" title="tactic">fresh</span> "m" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">m</span>]<br/>
&nbsp;&nbsp;| [<span class="id" title="var">H</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <span class="id" title="var">_</span> : <a class="idref" href="chainmail.defs.html#fld"><span class="id" title="inductive">fld</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">f</span> := <span class="id" title="tactic">fresh</span> "f" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">f</span>]<br/>
&nbsp;&nbsp;| [<span class="id" title="var">H</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <span class="id" title="var">_</span> : <a class="idref" href="chainmail.defs.html#gfld"><span class="id" title="inductive">gfld</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">g</span> := <span class="id" title="tactic">fresh</span> "g" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">g</span>]<br/>
&nbsp;&nbsp;| [<span class="id" title="var">H</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <span class="id" title="var">_</span> : <a class="idref" href="chainmail.defs.html#cls"><span class="id" title="inductive">cls</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">C</span> := <span class="id" title="tactic">fresh</span> "C" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">C</span>]<br/>
&nbsp;&nbsp;| [<span class="id" title="var">H</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <span class="id" title="var">_</span> : <a class="idref" href="chainmail.defs.html#addr"><span class="id" title="inductive">addr</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">α</span> := <span class="id" title="tactic">fresh</span> "α" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">α</span>]<br/>
&nbsp;&nbsp;| [<span class="id" title="var">H</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <span class="id" title="var">_</span> : <a class="idref" href="chainmail.defs.html#value"><span class="id" title="inductive">value</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">v</span> := <span class="id" title="tactic">fresh</span> "v" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">v</span>]<br/>
&nbsp;&nbsp;| [<span class="id" title="var">H</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <span class="id" title="var">_</span> : <a class="idref" href="chainmail.defs.html#obj"><span class="id" title="constructor">obj</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">o</span> := <span class="id" title="tactic">fresh</span> "o" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">o</span>]<br/>
&nbsp;&nbsp;| [<span class="id" title="var">H</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <span class="id" title="var">_</span> : <a class="idref" href="chainmail.defs.html#mdl"><span class="id" title="definition">mdl</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">M</span> := <span class="id" title="tactic">fresh</span> "M" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">M</span>]<br/>
&nbsp;&nbsp;| [<span class="id" title="var">H</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">destruct_exists</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| [<span class="id" title="var">H</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">eq_auto</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
<br/>
&nbsp;&nbsp;| [<span class="id" title="var">Heqb</span> : <span class="id" title="keyword">context</span>[<a class="idref" href="chainmail.common.html#eqb"><span class="id" title="method">eqb</span></a> ?<span class="id" title="var">a</span> ?<span class="id" title="var">a</span>]|- <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">rewrite</span> <a class="idref" href="chainmail.common.html#eqb_refl"><span class="id" title="method">eqb_refl</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Heqb</span>; <span class="id" title="tactic">auto</span><br/>
&nbsp;&nbsp;| [|- <span class="id" title="keyword">context</span>[<a class="idref" href="chainmail.common.html#eqb"><span class="id" title="method">eqb</span></a> ?<span class="id" title="var">a</span> ?<span class="id" title="var">a</span>]] =&gt; <span class="id" title="tactic">rewrite</span> <a class="idref" href="chainmail.common.html#eqb_refl"><span class="id" title="method">eqb_refl</span></a>; <span class="id" title="tactic">auto</span><br/>
<br/>
&nbsp;&nbsp;| [<span class="id" title="var">Heq</span> : ?<span class="id" title="var">a1</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a0a5068f83a704fcfbda8cd473a6cfea"><span class="id" title="notation">&lt;&gt;</span></a> ?<span class="id" title="var">a2</span>, <span class="id" title="var">Heqb</span> : <span class="id" title="keyword">context</span>[<a class="idref" href="chainmail.common.html#eqb"><span class="id" title="method">eqb</span></a> ?<span class="id" title="var">a1</span> ?<span class="id" title="var">a2</span>]|- <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">rewrite</span> <a class="idref" href="chainmail.common.html#neq_eqb"><span class="id" title="method">neq_eqb</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Heqb</span>; <span class="id" title="tactic">auto</span><br/>
&nbsp;&nbsp;| [<span class="id" title="var">Heq</span> : ?<span class="id" title="var">a1</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a0a5068f83a704fcfbda8cd473a6cfea"><span class="id" title="notation">&lt;&gt;</span></a> ?<span class="id" title="var">a2</span>, <span class="id" title="var">Heqb</span> : <span class="id" title="keyword">context</span>[<a class="idref" href="chainmail.common.html#eqb"><span class="id" title="method">eqb</span></a> ?<span class="id" title="var">a2</span> ?<span class="id" title="var">a1</span>]|- <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">rewrite</span> <a class="idref" href="chainmail.common.html#eqb_sym"><span class="id" title="method">eqb_sym</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Heqb</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="chainmail.common.html#neq_eqb"><span class="id" title="method">neq_eqb</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Heqb</span>; <span class="id" title="tactic">auto</span><br/>
&nbsp;&nbsp;| [<span class="id" title="var">Heq</span> : ?<span class="id" title="var">a1</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a0a5068f83a704fcfbda8cd473a6cfea"><span class="id" title="notation">&lt;&gt;</span></a> ?<span class="id" title="var">a2</span> |- <span class="id" title="keyword">context</span>[<a class="idref" href="chainmail.common.html#eqb"><span class="id" title="method">eqb</span></a> ?<span class="id" title="var">a1</span> ?<span class="id" title="var">a2</span>]] =&gt; <span class="id" title="tactic">rewrite</span> <a class="idref" href="chainmail.common.html#neq_eqb"><span class="id" title="method">neq_eqb</span></a>; <span class="id" title="tactic">auto</span><br/>
&nbsp;&nbsp;| [<span class="id" title="var">Heq</span> : ?<span class="id" title="var">a1</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a0a5068f83a704fcfbda8cd473a6cfea"><span class="id" title="notation">&lt;&gt;</span></a> ?<span class="id" title="var">a2</span> |- <span class="id" title="keyword">context</span>[<a class="idref" href="chainmail.common.html#eqb"><span class="id" title="method">eqb</span></a> ?<span class="id" title="var">a2</span> ?<span class="id" title="var">a1</span>]] =&gt; <span class="id" title="tactic">rewrite</span> <a class="idref" href="chainmail.common.html#eqb_sym"><span class="id" title="method">eqb_sym</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="chainmail.common.html#neq_eqb"><span class="id" title="method">neq_eqb</span></a>; <span class="id" title="tactic">auto</span><br/>
<br/>
&nbsp;&nbsp;| [<span class="id" title="var">H</span> : <a class="idref" href="chainmail.common.html#eqb"><span class="id" title="method">eqb</span></a> ?<span class="id" title="var">a1</span> ?<span class="id" title="var">a2</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> |- <span class="id" title="var">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">Hnew</span> := <span class="id" title="tactic">fresh</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hnew</span> : <span class="id" title="var">a1</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">a2</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="tactic">eapply</span> <a class="idref" href="chainmail.common.html#eqb_eqp"><span class="id" title="method">eqb_eqp</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">auto</span>|<span class="id" title="tactic">subst</span>; <span class="id" title="tactic">auto</span>]<br/>
&nbsp;&nbsp;| [<span class="id" title="var">H</span> : <a class="idref" href="chainmail.common.html#eqb"><span class="id" title="method">eqb</span></a> ?<span class="id" title="var">a1</span> ?<span class="id" title="var">a2</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> |- <span class="id" title="var">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">Hnew</span> := <span class="id" title="tactic">fresh</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hnew</span> : <span class="id" title="var">a1</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a0a5068f83a704fcfbda8cd473a6cfea"><span class="id" title="notation">&lt;&gt;</span></a> <span class="id" title="var">a2</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="tactic">eapply</span> <a class="idref" href="chainmail.common.html#eqb_neq"><span class="id" title="method">eqb_neq</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">auto</span>|<span class="id" title="tactic">auto</span>]<br/>
<br/>
&nbsp;&nbsp;| [<span class="id" title="var">H</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> ?<span class="id" title="var">a1</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a0a5068f83a704fcfbda8cd473a6cfea"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> ?<span class="id" title="var">a2</span> |- <span class="id" title="var">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">notHyp</span> (<span class="id" title="var">a1</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a0a5068f83a704fcfbda8cd473a6cfea"><span class="id" title="notation">&lt;&gt;</span></a> <span class="id" title="var">a2</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">a1</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a0a5068f83a704fcfbda8cd473a6cfea"><span class="id" title="notation">&lt;&gt;</span></a> <span class="id" title="var">a2</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="tactic">intro</span> <span class="id" title="var">Hcontra</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="var">crush</span>|<span class="id" title="tactic">auto</span>]<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">map_rewrite</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| [<span class="id" title="var">H</span> : <span class="id" title="keyword">context</span>[<a class="idref" href="chainmail.common.html#update"><span class="id" title="definition">update</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>] |-<span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">unfold</span> <a class="idref" href="chainmail.common.html#update"><span class="id" title="definition">update</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">repeat</span> <span class="id" title="var">eq_auto</span><br/>
&nbsp;&nbsp;| [|- <span class="id" title="keyword">context</span>[<a class="idref" href="chainmail.common.html#update"><span class="id" title="definition">update</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>]] =&gt; <span class="id" title="tactic">unfold</span> <a class="idref" href="chainmail.common.html#update"><span class="id" title="definition">update</span></a>; <span class="id" title="tactic">repeat</span> <span class="id" title="var">eq_auto</span><br/>
&nbsp;&nbsp;| [<span class="id" title="var">H</span> : <span class="id" title="keyword">context</span>[<a class="idref" href="chainmail.common.html#t_update"><span class="id" title="definition">t_update</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>] |-<span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">unfold</span> <a class="idref" href="chainmail.common.html#t_update"><span class="id" title="definition">t_update</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">repeat</span> <span class="id" title="var">eq_auto</span><br/>
&nbsp;&nbsp;| [|- <span class="id" title="keyword">context</span>[<a class="idref" href="chainmail.common.html#t_update"><span class="id" title="definition">t_update</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>]] =&gt; <span class="id" title="tactic">unfold</span> <a class="idref" href="chainmail.common.html#t_update"><span class="id" title="definition">t_update</span></a>; <span class="id" title="tactic">repeat</span> <span class="id" title="var">eq_auto</span><br/>
&nbsp;&nbsp;| [<span class="id" title="var">H</span> : <span class="id" title="keyword">context</span>[<a class="idref" href="chainmail.common.html#empty"><span class="id" title="definition">empty</span></a>] |-<span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">unfold</span> <a class="idref" href="chainmail.common.html#empty"><span class="id" title="definition">empty</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">repeat</span> <span class="id" title="var">eq_auto</span><br/>
&nbsp;&nbsp;| [|- <span class="id" title="keyword">context</span>[<a class="idref" href="chainmail.common.html#empty"><span class="id" title="definition">empty</span></a>]] =&gt; <span class="id" title="tactic">unfold</span> <a class="idref" href="chainmail.common.html#empty"><span class="id" title="definition">empty</span></a>; <span class="id" title="tactic">repeat</span> <span class="id" title="var">eq_auto</span><br/>
&nbsp;&nbsp;| [<span class="id" title="var">H</span> : <span class="id" title="keyword">context</span>[<a class="idref" href="chainmail.common.html#t_empty"><span class="id" title="definition">t_empty</span></a>] |-<span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">unfold</span> <a class="idref" href="chainmail.common.html#t_empty"><span class="id" title="definition">t_empty</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">repeat</span> <span class="id" title="var">eq_auto</span><br/>
&nbsp;&nbsp;| [|- <span class="id" title="keyword">context</span>[<a class="idref" href="chainmail.common.html#t_empty"><span class="id" title="definition">t_empty</span></a>]] =&gt; <span class="id" title="tactic">unfold</span> <a class="idref" href="chainmail.common.html#t_empty"><span class="id" title="definition">t_empty</span></a>; <span class="id" title="tactic">repeat</span> <span class="id" title="var">eq_auto</span><br/>
&nbsp;&nbsp;| [<span class="id" title="var">H</span> : <span class="id" title="keyword">context</span>[<a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#fst"><span class="id" title="definition">fst</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>] |- <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">unfold</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#fst"><span class="id" title="definition">fst</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">repeat</span> <span class="id" title="var">eq_auto</span><br/>
&nbsp;&nbsp;| [|- <span class="id" title="keyword">context</span>[<a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#fst"><span class="id" title="definition">fst</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>]] =&gt; <span class="id" title="tactic">unfold</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#fst"><span class="id" title="definition">fst</span></a>; <span class="id" title="tactic">repeat</span> <span class="id" title="var">eq_auto</span><br/>
&nbsp;&nbsp;| [<span class="id" title="var">H</span> : <span class="id" title="keyword">context</span>[<a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#snd"><span class="id" title="definition">snd</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>] |- <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">unfold</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#snd"><span class="id" title="definition">snd</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">repeat</span> <span class="id" title="var">eq_auto</span><br/>
&nbsp;&nbsp;| [|- <span class="id" title="keyword">context</span>[<a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#snd"><span class="id" title="definition">snd</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>]] =&gt; <span class="id" title="tactic">unfold</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#snd"><span class="id" title="definition">snd</span></a>; <span class="id" title="tactic">repeat</span> <span class="id" title="var">eq_auto</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">empty_auto</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| [<span class="id" title="var">H</span> : <span class="id" title="keyword">context</span> [<a class="idref" href="chainmail.common.html#empty"><span class="id" title="definition">empty</span></a> <span class="id" title="var">_</span>] |- <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">unfold</span> <a class="idref" href="chainmail.common.html#empty"><span class="id" title="definition">empty</span></a>, <a class="idref" href="chainmail.common.html#t_empty"><span class="id" title="definition">t_empty</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>; <span class="id" title="var">crush</span><br/>
&nbsp;&nbsp;| [|- <span class="id" title="keyword">context</span> [<a class="idref" href="chainmail.common.html#empty"><span class="id" title="definition">empty</span></a> <span class="id" title="var">_</span>]] =&gt; <span class="id" title="tactic">unfold</span> <a class="idref" href="chainmail.common.html#empty"><span class="id" title="definition">empty</span></a>, <a class="idref" href="chainmail.common.html#t_empty"><span class="id" title="definition">t_empty</span></a>; <span class="id" title="var">crush</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">update_auto</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| [<span class="id" title="var">H</span> : (<a class="idref" href="chainmail.common.html#update"><span class="id" title="definition">update</span></a> ?<span class="id" title="var">a</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) ?<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> ?<span class="id" title="var">b'</span> |- <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">unfold</span> <a class="idref" href="chainmail.common.html#update"><span class="id" title="definition">update</span></a>, <a class="idref" href="chainmail.common.html#t_update"><span class="id" title="definition">t_update</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>; <span class="id" title="tactic">rewrite</span> <a class="idref" href="chainmail.common.html#eqb_refl"><span class="id" title="method">eqb_refl</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">subst</span><br/>
&nbsp;&nbsp;| [<span class="id" title="var">Hneq</span> : ?<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a0a5068f83a704fcfbda8cd473a6cfea"><span class="id" title="notation">&lt;&gt;</span></a> ?<span class="id" title="var">a'</span>, <span class="id" title="var">H</span> : (<a class="idref" href="chainmail.common.html#update"><span class="id" title="definition">update</span></a> ?<span class="id" title="var">a</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) ?<span class="id" title="var">a'</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">unfold</span> <a class="idref" href="chainmail.common.html#update"><span class="id" title="definition">update</span></a>, <a class="idref" href="chainmail.common.html#t_update"><span class="id" title="definition">t_update</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="chainmail.common.html#neq_eqb"><span class="id" title="method">neq_eqb</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hneq</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hneq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;| [<span class="id" title="var">Hneq</span> : ?<span class="id" title="var">a'</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a0a5068f83a704fcfbda8cd473a6cfea"><span class="id" title="notation">&lt;&gt;</span></a> ?<span class="id" title="var">a</span>, <span class="id" title="var">H</span> : (<a class="idref" href="chainmail.common.html#update"><span class="id" title="definition">update</span></a> ?<span class="id" title="var">a</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) ?<span class="id" title="var">a'</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">unfold</span> <a class="idref" href="chainmail.common.html#update"><span class="id" title="definition">update</span></a>, <a class="idref" href="chainmail.common.html#t_update"><span class="id" title="definition">t_update</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="chainmail.common.html#neq_eqb"><span class="id" title="method">neq_eqb</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hneq</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hneq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;| [<span class="id" title="var">H</span> : (<a class="idref" href="chainmail.common.html#update"><span class="id" title="definition">update</span></a> ?<span class="id" title="var">a</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) ?<span class="id" title="var">a'</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> ?<span class="id" title="var">b'</span> |- <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">unfold</span> <a class="idref" href="chainmail.common.html#update"><span class="id" title="definition">update</span></a>, <a class="idref" href="chainmail.common.html#t_update"><span class="id" title="definition">t_update</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">Heq</span> := <span class="id" title="tactic">fresh</span> "Heq" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">Hneq</span> := <span class="id" title="tactic">fresh</span> "Hneq" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="chainmail.common.html#eq_dec"><span class="id" title="method">eq_dec</span></a> <span class="id" title="var">a'</span> <span class="id" title="var">a</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">Heq</span>|<span class="id" title="var">Hneq</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="tactic">subst</span>; <span class="id" title="tactic">rewrite</span> <a class="idref" href="chainmail.common.html#eqb_refl"><span class="id" title="method">eqb_refl</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">subst</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">apply</span> <a class="idref" href="chainmail.common.html#neq_eqb"><span class="id" title="method">neq_eqb</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hneq</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hneq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>]<br/>
<br/>
&nbsp;&nbsp;| [<span class="id" title="var">H</span> : <span class="id" title="keyword">context</span>[(<a class="idref" href="chainmail.common.html#update"><span class="id" title="definition">update</span></a> ?<span class="id" title="var">a</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) ?<span class="id" title="var">a</span>]  |- <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">unfold</span> <a class="idref" href="chainmail.common.html#update"><span class="id" title="definition">update</span></a>, <a class="idref" href="chainmail.common.html#t_update"><span class="id" title="definition">t_update</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>; <span class="id" title="tactic">rewrite</span> <a class="idref" href="chainmail.common.html#eqb_refl"><span class="id" title="method">eqb_refl</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;| [<span class="id" title="var">Hneq</span> : ?<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a0a5068f83a704fcfbda8cd473a6cfea"><span class="id" title="notation">&lt;&gt;</span></a> ?<span class="id" title="var">a'</span>, <span class="id" title="var">H</span> : <span class="id" title="keyword">context</span>[(<a class="idref" href="chainmail.common.html#update"><span class="id" title="definition">update</span></a> ?<span class="id" title="var">a</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) ?<span class="id" title="var">a'</span>]  |- <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">unfold</span> <a class="idref" href="chainmail.common.html#update"><span class="id" title="definition">update</span></a>, <a class="idref" href="chainmail.common.html#t_update"><span class="id" title="definition">t_update</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="chainmail.common.html#neq_eqb"><span class="id" title="method">neq_eqb</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hneq</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hneq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;| [<span class="id" title="var">Hneq</span> : ?<span class="id" title="var">a'</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a0a5068f83a704fcfbda8cd473a6cfea"><span class="id" title="notation">&lt;&gt;</span></a> ?<span class="id" title="var">a</span>, <span class="id" title="var">H</span> : <span class="id" title="keyword">context</span>[(<a class="idref" href="chainmail.common.html#update"><span class="id" title="definition">update</span></a> ?<span class="id" title="var">a</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) ?<span class="id" title="var">a'</span>]  |- <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">unfold</span> <a class="idref" href="chainmail.common.html#update"><span class="id" title="definition">update</span></a>, <a class="idref" href="chainmail.common.html#t_update"><span class="id" title="definition">t_update</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="chainmail.common.html#neq_eqb"><span class="id" title="method">neq_eqb</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hneq</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hneq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;| [<span class="id" title="var">H</span> : <span class="id" title="keyword">context</span>[(<a class="idref" href="chainmail.common.html#update"><span class="id" title="definition">update</span></a> ?<span class="id" title="var">a</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) ?<span class="id" title="var">a'</span>]  |- <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">unfold</span> <a class="idref" href="chainmail.common.html#update"><span class="id" title="definition">update</span></a>, <a class="idref" href="chainmail.common.html#t_update"><span class="id" title="definition">t_update</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">Heq</span> := <span class="id" title="tactic">fresh</span> "Heq" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">Hneq</span> := <span class="id" title="tactic">fresh</span> "Hneq" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="chainmail.common.html#eq_dec"><span class="id" title="method">eq_dec</span></a> <span class="id" title="var">a'</span> <span class="id" title="var">a</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">Heq</span>|<span class="id" title="var">Hneq</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="tactic">subst</span>; <span class="id" title="tactic">rewrite</span> <a class="idref" href="chainmail.common.html#eqb_refl"><span class="id" title="method">eqb_refl</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">apply</span> <a class="idref" href="chainmail.common.html#neq_eqb"><span class="id" title="method">neq_eqb</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hneq</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hneq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;| [|- (<a class="idref" href="chainmail.common.html#update"><span class="id" title="definition">update</span></a> ?<span class="id" title="var">a</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) ?<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">unfold</span> <a class="idref" href="chainmail.common.html#update"><span class="id" title="definition">update</span></a>, <a class="idref" href="chainmail.common.html#t_update"><span class="id" title="definition">t_update</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>; <span class="id" title="tactic">rewrite</span> <a class="idref" href="chainmail.common.html#eqb_refl"><span class="id" title="method">eqb_refl</span></a><br/>
&nbsp;&nbsp;| [<span class="id" title="var">Hneq</span> : ?<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a0a5068f83a704fcfbda8cd473a6cfea"><span class="id" title="notation">&lt;&gt;</span></a> ?<span class="id" title="var">a'</span> |- (<a class="idref" href="chainmail.common.html#update"><span class="id" title="definition">update</span></a> ?<span class="id" title="var">a</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) ?<span class="id" title="var">a'</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">unfold</span> <a class="idref" href="chainmail.common.html#update"><span class="id" title="definition">update</span></a>, <a class="idref" href="chainmail.common.html#t_update"><span class="id" title="definition">t_update</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="chainmail.common.html#neq_eqb"><span class="id" title="method">neq_eqb</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hneq</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hneq</span><br/>
&nbsp;&nbsp;| [<span class="id" title="var">Hneq</span> : ?<span class="id" title="var">a'</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a0a5068f83a704fcfbda8cd473a6cfea"><span class="id" title="notation">&lt;&gt;</span></a> ?<span class="id" title="var">a</span> |- (<a class="idref" href="chainmail.common.html#update"><span class="id" title="definition">update</span></a> ?<span class="id" title="var">a</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) ?<span class="id" title="var">a'</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">unfold</span> <a class="idref" href="chainmail.common.html#update"><span class="id" title="definition">update</span></a>, <a class="idref" href="chainmail.common.html#t_update"><span class="id" title="definition">t_update</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="chainmail.common.html#neq_eqb"><span class="id" title="method">neq_eqb</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hneq</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hneq</span><br/>
&nbsp;&nbsp;| [|- (<a class="idref" href="chainmail.common.html#update"><span class="id" title="definition">update</span></a> ?<span class="id" title="var">a</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) ?<span class="id" title="var">a'</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> ?<span class="id" title="var">b'</span>] =&gt; <span class="id" title="tactic">unfold</span> <a class="idref" href="chainmail.common.html#update"><span class="id" title="definition">update</span></a>, <a class="idref" href="chainmail.common.html#t_update"><span class="id" title="definition">t_update</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">Heq</span> := <span class="id" title="tactic">fresh</span> "Heq" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">Hneq</span> := <span class="id" title="tactic">fresh</span> "Hneq" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="chainmail.common.html#eq_dec"><span class="id" title="method">eq_dec</span></a> <span class="id" title="var">a'</span> <span class="id" title="var">a</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">Heq</span>|<span class="id" title="var">Hneq</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="tactic">subst</span>; <span class="id" title="tactic">rewrite</span> <a class="idref" href="chainmail.common.html#eqb_refl"><span class="id" title="method">eqb_refl</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">apply</span> <a class="idref" href="chainmail.common.html#neq_eqb"><span class="id" title="method">neq_eqb</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hneq</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hneq</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;| [|- <span class="id" title="keyword">context</span>[(<a class="idref" href="chainmail.common.html#update"><span class="id" title="definition">update</span></a> ?<span class="id" title="var">a</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) ?<span class="id" title="var">a</span>]] =&gt; <span class="id" title="tactic">unfold</span> <a class="idref" href="chainmail.common.html#update"><span class="id" title="definition">update</span></a>, <a class="idref" href="chainmail.common.html#t_update"><span class="id" title="definition">t_update</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>; <span class="id" title="tactic">rewrite</span> <a class="idref" href="chainmail.common.html#eqb_refl"><span class="id" title="method">eqb_refl</span></a><br/>
&nbsp;&nbsp;| [<span class="id" title="var">Hneq</span> : ?<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a0a5068f83a704fcfbda8cd473a6cfea"><span class="id" title="notation">&lt;&gt;</span></a> ?<span class="id" title="var">a'</span> |- <span class="id" title="keyword">context</span>[(<a class="idref" href="chainmail.common.html#update"><span class="id" title="definition">update</span></a> ?<span class="id" title="var">a</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) ?<span class="id" title="var">a'</span>]] =&gt; <span class="id" title="tactic">unfold</span> <a class="idref" href="chainmail.common.html#update"><span class="id" title="definition">update</span></a>, <a class="idref" href="chainmail.common.html#t_update"><span class="id" title="definition">t_update</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="chainmail.common.html#neq_eqb"><span class="id" title="method">neq_eqb</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hneq</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hneq</span><br/>
&nbsp;&nbsp;| [<span class="id" title="var">Hneq</span> : ?<span class="id" title="var">a'</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a0a5068f83a704fcfbda8cd473a6cfea"><span class="id" title="notation">&lt;&gt;</span></a> ?<span class="id" title="var">a</span> |- <span class="id" title="keyword">context</span>[(<a class="idref" href="chainmail.common.html#update"><span class="id" title="definition">update</span></a> ?<span class="id" title="var">a</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) ?<span class="id" title="var">a'</span>]] =&gt; <span class="id" title="tactic">unfold</span> <a class="idref" href="chainmail.common.html#update"><span class="id" title="definition">update</span></a>, <a class="idref" href="chainmail.common.html#t_update"><span class="id" title="definition">t_update</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="chainmail.common.html#neq_eqb"><span class="id" title="method">neq_eqb</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hneq</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hneq</span><br/>
&nbsp;&nbsp;| [|- <span class="id" title="keyword">context</span>[(<a class="idref" href="chainmail.common.html#update"><span class="id" title="definition">update</span></a> ?<span class="id" title="var">a</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) ?<span class="id" title="var">a'</span>]] =&gt; <span class="id" title="tactic">unfold</span> <a class="idref" href="chainmail.common.html#update"><span class="id" title="definition">update</span></a>, <a class="idref" href="chainmail.common.html#t_update"><span class="id" title="definition">t_update</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">Heq</span> := <span class="id" title="tactic">fresh</span> "Heq" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">Hneq</span> := <span class="id" title="tactic">fresh</span> "Hneq" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="chainmail.common.html#eq_dec"><span class="id" title="method">eq_dec</span></a> <span class="id" title="var">a'</span> <span class="id" title="var">a</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">Heq</span>|<span class="id" title="var">Hneq</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="tactic">subst</span>; <span class="id" title="tactic">rewrite</span> <a class="idref" href="chainmail.common.html#eqb_refl"><span class="id" title="method">eqb_refl</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">apply</span> <a class="idref" href="chainmail.common.html#neq_eqb"><span class="id" title="method">neq_eqb</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hneq</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hneq</span>]<br/>
<br/>
&nbsp;&nbsp;| [<span class="id" title="var">H</span> : <span class="id" title="keyword">context</span>[<a class="idref" href="chainmail.common.html#empty"><span class="id" title="definition">empty</span></a> <span class="id" title="var">_</span>]|-<span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">unfold</span> <a class="idref" href="chainmail.common.html#empty"><span class="id" title="definition">empty</span></a>, <a class="idref" href="chainmail.common.html#t_empty"><span class="id" title="definition">t_empty</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;| [|- <span class="id" title="keyword">context</span>[<a class="idref" href="chainmail.common.html#empty"><span class="id" title="definition">empty</span></a> <span class="id" title="var">_</span>]] =&gt; <span class="id" title="tactic">unfold</span> <a class="idref" href="chainmail.common.html#empty"><span class="id" title="definition">empty</span></a>, <a class="idref" href="chainmail.common.html#t_empty"><span class="id" title="definition">t_empty</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">pmap_simpl</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> (<span class="id" title="tactic">try</span> <span class="id" title="var">empty_auto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">update_auto</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="one_to_one"><span class="id" title="definition">one_to_one</span></a> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>} `{<a class="idref" href="chainmail.common.html#Eq"><span class="id" title="class">Eq</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a>} (<span class="id" title="var">f</span> : <a class="idref" href="chainmail.common.html#partial_map"><span class="id" title="definition">partial_map</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a> <a class="idref" href="chainmail.partial_maps.html#B"><span class="id" title="variable">B</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">a1</span> <span class="id" title="var">a2</span> <span class="id" title="var">b</span>, <a class="idref" href="chainmail.partial_maps.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="chainmail.partial_maps.html#a1"><span class="id" title="variable">a1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="chainmail.partial_maps.html#b"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chainmail.partial_maps.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="chainmail.partial_maps.html#a2"><span class="id" title="variable">a2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="chainmail.partial_maps.html#b"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chainmail.partial_maps.html#a1"><span class="id" title="variable">a1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="chainmail.partial_maps.html#a2"><span class="id" title="variable">a2</span></a>.<br/>

<br/>
<span class="id" title="keyword">Program Instance</span> <a name="optionEq"><span class="id" title="instance">optionEq</span></a> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>}`{<a class="idref" href="chainmail.common.html#Eq"><span class="id" title="class">Eq</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a>} : <a class="idref" href="chainmail.common.html#Eq"><span class="id" title="class">Eq</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a>) :=<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chainmail.common.html#eqb"><span class="id" title="method">eqb</span></a> <span class="id" title="var">o1</span> <span class="id" title="var">o2</span> := <span class="id" title="keyword">match</span> <a class="idref" href="chainmail.partial_maps.html#o1"><span class="id" title="variable">o1</span></a>, <a class="idref" href="chainmail.partial_maps.html#o2"><span class="id" title="variable">o2</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">b1</span>, <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">b2</span> =&gt; <a class="idref" href="chainmail.common.html#eqb"><span class="id" title="method">eqb</span></a> <span class="id" title="var">b1</span> <span class="id" title="var">b2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span>, <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;}.<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| [<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">a</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <span class="id" title="var">A</span> |- <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>; <span class="id" title="tactic">eauto</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">Hcontra</span>; <span class="id" title="var">crush</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| [<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">a1</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <span class="id" title="var">A</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">a2</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <span class="id" title="var">A</span> |- <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">destruct</span> <span class="id" title="var">a1</span>; <span class="id" title="tactic">destruct</span> <span class="id" title="var">a2</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">Hcontra</span>; <span class="id" title="var">crush</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| [<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">a</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <span class="id" title="var">A</span> |- <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>; <span class="id" title="tactic">auto</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>; <span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">eq_db</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| [<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">a1</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <span class="id" title="var">A</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">a2</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <span class="id" title="var">A</span> |- <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">destruct</span> <span class="id" title="var">a1</span>; <span class="id" title="tactic">destruct</span> <span class="id" title="var">a2</span>; <span class="id" title="tactic">auto</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">eq_auto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">solve</span> [<span class="id" title="var">crush</span>].<br/>
<span class="id" title="keyword">Defined</span>.<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| [<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">a1</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <span class="id" title="var">A</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">a2</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <span class="id" title="var">A</span> |- <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">destruct</span> <span class="id" title="var">a1</span>; <span class="id" title="tactic">destruct</span> <span class="id" title="var">a2</span>; <span class="id" title="tactic">auto</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">solve</span> [<span class="id" title="var">eq_auto</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">solve</span> [<span class="id" title="var">crush</span>].<br/>
<span class="id" title="keyword">Defined</span>.<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| [<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">a1</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <span class="id" title="var">A</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">a2</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <span class="id" title="var">A</span> |- <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">destruct</span> <span class="id" title="var">a1</span>; <span class="id" title="tactic">destruct</span> <span class="id" title="var">a2</span>; <span class="id" title="tactic">repeat</span> <span class="id" title="var">eq_auto</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">solve</span> [<span class="id" title="var">crush</span>].<br/>
<span class="id" title="keyword">Defined</span>.<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| [<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">a1</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <span class="id" title="var">A</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">a2</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <span class="id" title="var">A</span> |- <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">destruct</span> <span class="id" title="var">a1</span>; <span class="id" title="tactic">destruct</span> <span class="id" title="var">a2</span>; <span class="id" title="tactic">repeat</span> <span class="id" title="var">eq_auto</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">solve</span> [<span class="id" title="var">crush</span>].<br/>
<span class="id" title="keyword">Defined</span>.<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| [<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">a1</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <span class="id" title="var">A</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">a2</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <span class="id" title="var">A</span> |- <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">destruct</span> <span class="id" title="var">a1</span>; <span class="id" title="tactic">destruct</span> <span class="id" title="var">a2</span>; <span class="id" title="tactic">repeat</span> <span class="id" title="var">eq_auto</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">solve</span> [<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">a1</span> : <span class="id" title="var">A</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">a2</span> : <span class="id" title="var">A</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Heq</span> : <a class="idref" href="chainmail.common.html#Eq"><span class="id" title="class">Eq</span></a> <span class="id" title="var">A</span> |- <span class="id" title="var">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="chainmail.common.html#eq_dec"><span class="id" title="method">eq_dec</span></a> <span class="id" title="var">a1</span> <span class="id" title="var">a2</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="tactic">left</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">auto</span>|<span class="id" title="tactic">right</span>; <span class="id" title="var">crush</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">solve</span> [<span class="id" title="tactic">right</span>; <span class="id" title="var">crush</span>].<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="partial_map_dec"><span class="id" title="lemma">partial_map_dec</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>} `{<a class="idref" href="chainmail.common.html#Eq"><span class="id" title="class">Eq</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a>} <span class="id" title="var">a</span> (<span class="id" title="var">m</span> : <a class="idref" href="chainmail.common.html#partial_map"><span class="id" title="definition">partial_map</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a> <a class="idref" href="chainmail.partial_maps.html#B"><span class="id" title="variable">B</span></a>), <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Specif.html#87727981cdc1579fef00b9d9c1d3b9da"><span class="id" title="notation">{</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="chainmail.partial_maps.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="chainmail.partial_maps.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="chainmail.partial_maps.html#b"><span class="id" title="variable">b</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Specif.html#87727981cdc1579fef00b9d9c1d3b9da"><span class="id" title="notation">}</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Specif.html#87727981cdc1579fef00b9d9c1d3b9da"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Specif.html#87727981cdc1579fef00b9d9c1d3b9da"><span class="id" title="notation">{</span></a><a class="idref" href="chainmail.partial_maps.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="chainmail.partial_maps.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Specif.html#87727981cdc1579fef00b9d9c1d3b9da"><span class="id" title="notation">}</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">m</span> <span class="id" title="var">a</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">b</span>|]; [<span class="id" title="tactic">left</span>; <span class="id" title="tactic">exists</span> <span class="id" title="var">b</span>|]; <span class="id" title="var">crush</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="not_some_implies_none"><span class="id" title="lemma">not_some_implies_none</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>} `{<a class="idref" href="chainmail.common.html#Eq"><span class="id" title="class">Eq</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a>} (<span class="id" title="var">f</span> : <a class="idref" href="chainmail.common.html#partial_map"><span class="id" title="definition">partial_map</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a> <a class="idref" href="chainmail.partial_maps.html#B"><span class="id" title="variable">B</span></a>) <span class="id" title="var">a</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">(</span></a><span class="id" title="keyword">forall</span> <span class="id" title="var">b</span>, <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">~</span></a> <a class="idref" href="chainmail.partial_maps.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="chainmail.partial_maps.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="chainmail.partial_maps.html#b"><span class="id" title="variable">b</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chainmail.partial_maps.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="chainmail.partial_maps.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="chainmail.partial_maps.html#partial_map_dec"><span class="id" title="lemma">partial_map_dec</span></a> <span class="id" title="var">a</span> <span class="id" title="var">f</span>); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">destruct_exists_loo</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">crush</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="not_none_implies_some"><span class="id" title="lemma">not_none_implies_some</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} `{<a class="idref" href="chainmail.common.html#Eq"><span class="id" title="class">Eq</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a>}(<span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">f</span> : <a class="idref" href="chainmail.common.html#partial_map"><span class="id" title="definition">partial_map</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a> <a class="idref" href="chainmail.partial_maps.html#B"><span class="id" title="variable">B</span></a>) <span class="id" title="var">a</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chainmail.partial_maps.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="chainmail.partial_maps.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a0a5068f83a704fcfbda8cd473a6cfea"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="chainmail.partial_maps.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="chainmail.partial_maps.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="chainmail.partial_maps.html#b"><span class="id" title="variable">b</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="chainmail.partial_maps.html#partial_map_dec"><span class="id" title="lemma">partial_map_dec</span></a> <span class="id" title="var">a</span> <span class="id" title="var">f</span>); <span class="id" title="tactic">auto</span>; <span class="id" title="var">crush</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Hint Rewrite</span> <a class="idref" href="chainmail.partial_maps.html#not_none_implies_some"><span class="id" title="lemma">not_none_implies_some</span></a> : <span class="id" title="var">map_db</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">not_none_implies_some</span> : <span class="id" title="var">map_db</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="update_neq_empty"><span class="id" title="lemma">update_neq_empty</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>}`{<a class="idref" href="chainmail.common.html#Eq"><span class="id" title="class">Eq</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a>} (<span class="id" title="var">a</span> : <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a>)(<span class="id" title="var">b</span> : <a class="idref" href="chainmail.partial_maps.html#B"><span class="id" title="variable">B</span></a>) <span class="id" title="var">m</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chainmail.common.html#update"><span class="id" title="definition">update</span></a> <a class="idref" href="chainmail.partial_maps.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="chainmail.partial_maps.html#b"><span class="id" title="variable">b</span></a> <a class="idref" href="chainmail.partial_maps.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a0a5068f83a704fcfbda8cd473a6cfea"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="chainmail.common.html#empty"><span class="id" title="definition">empty</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">Hcontra</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Heq</span> : <a class="idref" href="chainmail.common.html#update"><span class="id" title="definition">update</span></a> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">m</span> <span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hcontra</span>; <span class="id" title="var">pmap_simpl</span>|<span class="id" title="var">pmap_simpl</span>].<br/>
&nbsp;&nbsp;<span class="id" title="var">crush</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">update_empty_contra</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| [<span class="id" title="var">H</span> : <a class="idref" href="chainmail.common.html#update"><span class="id" title="definition">update</span></a> ?<span class="id" title="var">a</span> ?<span class="id" title="var">b</span> ?<span class="id" title="var">m</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="chainmail.common.html#empty"><span class="id" title="definition">empty</span></a> |- <span class="id" title="var">_</span>] =&gt; <span class="id" title="var">contradiction</span> (<a class="idref" href="chainmail.partial_maps.html#update_neq_empty"><span class="id" title="lemma">update_neq_empty</span></a> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">m</span>)<br/>
&nbsp;&nbsp;| [<span class="id" title="var">H</span> : <a class="idref" href="chainmail.common.html#empty"><span class="id" title="definition">empty</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="chainmail.common.html#update"><span class="id" title="definition">update</span></a> ?<span class="id" title="var">a</span> ?<span class="id" title="var">b</span> ?<span class="id" title="var">m</span> |- <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">symmetry</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>; <span class="id" title="var">contradiction</span> (<a class="idref" href="chainmail.partial_maps.html#update_neq_empty"><span class="id" title="lemma">update_neq_empty</span></a> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">m</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <a name="finite_normal_form"><span class="id" title="inductive">finite_normal_form</span></a> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>} `{<a class="idref" href="chainmail.common.html#Eq"><span class="id" title="class">Eq</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a>} : <a class="idref" href="chainmail.common.html#partial_map"><span class="id" title="definition">partial_map</span></a> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="keyword">Prop</span> :=<br/>
| <a name="norm_empty"><span class="id" title="constructor">norm_empty</span></a> : <a class="idref" href="chainmail.partial_maps.html#finite_normal_form"><span class="id" title="inductive">finite_normal_form</span></a> <a class="idref" href="chainmail.common.html#empty"><span class="id" title="definition">empty</span></a><br/>
| <a name="norm_update"><span class="id" title="constructor">norm_update</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">m</span>, <a class="idref" href="chainmail.partial_maps.html#finite_normal_form"><span class="id" title="inductive">finite_normal_form</span></a> <a class="idref" href="chainmail.partial_maps.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chainmail.partial_maps.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="chainmail.partial_maps.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chainmail.partial_maps.html#finite_normal_form"><span class="id" title="inductive">finite_normal_form</span></a> (<a class="idref" href="chainmail.common.html#update"><span class="id" title="definition">update</span></a> <a class="idref" href="chainmail.partial_maps.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="chainmail.partial_maps.html#b"><span class="id" title="variable">b</span></a> <a class="idref" href="chainmail.partial_maps.html#m"><span class="id" title="variable">m</span></a>).<br/>

<br/>
<span class="id" title="keyword">Hint Constructors</span> <a class="idref" href="chainmail.partial_maps.html#finite_normal_form"><span class="id" title="inductive">finite_normal_form</span></a> : <span class="id" title="var">map_db</span>.<br/>

<br/>
<span class="comment">(*)Lemma&nbsp;compose_normal_form&nbsp;:<br/>
&nbsp;&nbsp;forall&nbsp;{A&nbsp;B&nbsp;:&nbsp;Type}`{Eq&nbsp;A}`{Eq&nbsp;B}&nbsp;(m1&nbsp;:&nbsp;partial_map&nbsp;A&nbsp;B),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;finite_normal_form&nbsp;m1&nbsp;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;forall&nbsp;{C&nbsp;:&nbsp;Type}&nbsp;(m2&nbsp;:&nbsp;partial_map&nbsp;B&nbsp;C),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;exists&nbsp;m3,&nbsp;finite_normal_form&nbsp;m3&nbsp;/\&nbsp;m3&nbsp;=&nbsp;m1&nbsp;∘&nbsp;m2.<br/>
Proof.<br/>
&nbsp;&nbsp;intros&nbsp;A&nbsp;B&nbsp;HeqClassA&nbsp;HeqClassB&nbsp;m1&nbsp;Hnorm;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;induction&nbsp;Hnorm;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;intros;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;auto.<br/>
<br/>
&nbsp;&nbsp;exists&nbsp;empty;&nbsp;auto&nbsp;with&nbsp;map_db.<br/>
<br/>
&nbsp;&nbsp;destruct&nbsp;(IHHnorm&nbsp;C&nbsp;m2)&nbsp;as&nbsp;<span class="inlinecode"><span class="id" title="var">m3</span></span> <span class="inlinecode"><span class="id" title="var">IH</span></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;destruct&nbsp;IH&nbsp;as&nbsp;<span class="inlinecode"><span class="id" title="var">IH1</span></span> <span class="inlinecode"><span class="id" title="var">IH2</span></span>.<br/>
&nbsp;&nbsp;destruct&nbsp;(partial_map_dec&nbsp;b&nbsp;m2)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;as&nbsp;<span class="inlinecode"><span class="id" title="var">HSome</span>|<span class="id" title="var">HNone</span></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="inlinecode"><span class="id" title="tactic">destruct</span></span> <span class="inlinecode"><span class="id" title="var">HSome</span></span> <span class="inlinecode"><span class="id" title="keyword">as</span></span> <span class="inlinecode">[<span class="id" title="var">c</span></span> <span class="inlinecode"><span class="id" title="var">HSome</span>]|</span>.<br/>
&nbsp;&nbsp;exists&nbsp;(update&nbsp;a&nbsp;c&nbsp;m3);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;split;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="inlinecode"><span class="id" title="tactic">apply</span></span> <span class="inlinecode"><span class="id" title="var">norm_update</span>;</span>
     <span class="inlinecode"><span class="id" title="tactic">subst</span></span> <span class="inlinecode"><span class="id" title="var">m3</span>;</span> <span class="inlinecode">[<span class="id" title="tactic">auto</span>|<span class="id" title="var">crush</span>]|</span>.<br/>
&nbsp;&nbsp;apply&nbsp;functional_extensionality;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;intros&nbsp;a';<br/>
&nbsp;&nbsp;&nbsp;&nbsp;pmap_simpl;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;crush.<br/>
&nbsp;&nbsp;exists&nbsp;m3;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;split;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;auto.<br/>
&nbsp;&nbsp;subst;&nbsp;auto.<br/>
&nbsp;&nbsp;apply&nbsp;functional_extensionality;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;intros&nbsp;c;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;pmap_simpl;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;crush.<br/>
Qed.*)</span><br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="update_finite_normal_form"><span class="id" title="lemma">update_finite_normal_form</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>} `{<a class="idref" href="chainmail.common.html#Eq"><span class="id" title="class">Eq</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a>} (<span class="id" title="var">m</span> : <a class="idref" href="chainmail.common.html#partial_map"><span class="id" title="definition">partial_map</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a> <a class="idref" href="chainmail.partial_maps.html#B"><span class="id" title="variable">B</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chainmail.partial_maps.html#finite_normal_form"><span class="id" title="inductive">finite_normal_form</span></a> <a class="idref" href="chainmail.partial_maps.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>, <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <span class="id" title="var">m'</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="chainmail.partial_maps.html#finite_normal_form"><span class="id" title="inductive">finite_normal_form</span></a> <a class="idref" href="chainmail.partial_maps.html#m'"><span class="id" title="variable">m'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="chainmail.partial_maps.html#m'"><span class="id" title="variable">m'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><a class="idref" href="chainmail.common.html#update"><span class="id" title="definition">update</span></a> <a class="idref" href="chainmail.partial_maps.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="chainmail.partial_maps.html#b"><span class="id" title="variable">b</span></a> <a class="idref" href="chainmail.partial_maps.html#m"><span class="id" title="variable">m</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">HeqClass</span> <span class="id" title="var">m</span> <span class="id" title="var">Hfinite</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">Hfinite</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="tactic">exists</span> (<a class="idref" href="chainmail.common.html#update"><span class="id" title="definition">update</span></a> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <a class="idref" href="chainmail.common.html#empty"><span class="id" title="definition">empty</span></a>); <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">map_db</span>|].<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">IHHfinite</span> <span class="id" title="var">a0</span> <span class="id" title="var">b0</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">m'</span> <span class="id" title="var">Hnorm</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hnorm</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Hnorm</span> <span class="id" title="var">Heqm'</span>].<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="chainmail.common.html#eq_dec"><span class="id" title="method">eq_dec</span></a> <span class="id" title="var">a0</span> <span class="id" title="var">a</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">Heq</span>|<span class="id" title="var">Hneq</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="tactic">subst</span> <span class="id" title="var">a0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|].<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">m'</span>; <span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Logic.FunctionalExtensionality.html#functional_extensionality"><span class="id" title="lemma">functional_extensionality</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a'</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">pmap_simpl</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<a class="idref" href="chainmail.common.html#update"><span class="id" title="definition">update</span></a> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">m'</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="chainmail.partial_maps.html#partial_map_dec"><span class="id" title="lemma">partial_map_dec</span></a> <span class="id" title="var">a</span> <span class="id" title="var">m'</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">HSome</span>|<span class="id" title="var">HNone</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="tactic">destruct</span> <span class="id" title="var">HSome</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">b'</span> <span class="id" title="var">HSome</span>]; <span class="id" title="tactic">subst</span>; <span class="id" title="var">pmap_simpl</span>; <span class="id" title="var">crush</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">apply</span> <a class="idref" href="chainmail.partial_maps.html#norm_update"><span class="id" title="constructor">norm_update</span></a>; <span class="id" title="tactic">auto</span>].<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Logic.FunctionalExtensionality.html#functional_extensionality"><span class="id" title="lemma">functional_extensionality</span></a>; <span class="id" title="tactic">intros</span> <span class="id" title="var">a'</span>; <span class="id" title="var">pmap_simpl</span>; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="chainmail.common.html#neq_eqb"><span class="id" title="method">neq_eqb</span></a>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="chainmail.common.html#eq_dec"><span class="id" title="method">eq_dec</span></a> <span class="id" title="var">a'</span> <span class="id" title="var">a0</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">Heqa'</span>|<span class="id" title="var">Hneqa'</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="tactic">subst</span>; <span class="id" title="var">pmap_simpl</span>|<span class="id" title="var">pmap_simpl</span>].<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="finite_exists_normal_form"><span class="id" title="lemma">finite_exists_normal_form</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>} `{<a class="idref" href="chainmail.common.html#Eq"><span class="id" title="class">Eq</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a>} (<span class="id" title="var">m</span> : <a class="idref" href="chainmail.common.html#partial_map"><span class="id" title="definition">partial_map</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a> <a class="idref" href="chainmail.partial_maps.html#B"><span class="id" title="variable">B</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chainmail.common.html#finite"><span class="id" title="inductive">finite</span></a> <a class="idref" href="chainmail.partial_maps.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <span class="id" title="var">m'</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="chainmail.partial_maps.html#finite_normal_form"><span class="id" title="inductive">finite_normal_form</span></a> <a class="idref" href="chainmail.partial_maps.html#m'"><span class="id" title="variable">m'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="chainmail.partial_maps.html#m'"><span class="id" title="variable">m'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="chainmail.partial_maps.html#m"><span class="id" title="variable">m</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">HeqClass</span> <span class="id" title="var">m</span> <span class="id" title="var">Hfinite</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">Hfinite</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="tactic">exists</span> <a class="idref" href="chainmail.common.html#empty"><span class="id" title="definition">empty</span></a>; <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">map_db</span>|].<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="chainmail.partial_maps.html#update_finite_normal_form"><span class="id" title="lemma">update_finite_normal_form</span></a>; <span class="id" title="var">crush</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="finite_normal_form_implies_finite"><span class="id" title="lemma">finite_normal_form_implies_finite</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>} `{<a class="idref" href="chainmail.common.html#Eq"><span class="id" title="class">Eq</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a>} (<span class="id" title="var">m</span> : <a class="idref" href="chainmail.common.html#partial_map"><span class="id" title="definition">partial_map</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a> <a class="idref" href="chainmail.partial_maps.html#B"><span class="id" title="variable">B</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chainmail.partial_maps.html#finite_normal_form"><span class="id" title="inductive">finite_normal_form</span></a> <a class="idref" href="chainmail.partial_maps.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chainmail.common.html#finite"><span class="id" title="inductive">finite</span></a> <a class="idref" href="chainmail.partial_maps.html#m"><span class="id" title="variable">m</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">HeqClass</span> <span class="id" title="var">m</span> <span class="id" title="var">Hnorm</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">Hnorm</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">map_db</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="finite_implies_normal_form"><span class="id" title="lemma">finite_implies_normal_form</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>} `{<a class="idref" href="chainmail.common.html#Eq"><span class="id" title="class">Eq</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a>} (<span class="id" title="var">m</span> : <a class="idref" href="chainmail.common.html#partial_map"><span class="id" title="definition">partial_map</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a> <a class="idref" href="chainmail.partial_maps.html#B"><span class="id" title="variable">B</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chainmail.common.html#finite"><span class="id" title="inductive">finite</span></a> <a class="idref" href="chainmail.partial_maps.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chainmail.partial_maps.html#finite_normal_form"><span class="id" title="inductive">finite_normal_form</span></a> <a class="idref" href="chainmail.partial_maps.html#m"><span class="id" title="variable">m</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="chainmail.partial_maps.html#finite_exists_normal_form"><span class="id" title="lemma">finite_exists_normal_form</span></a> <span class="id" title="var">m</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">andDestruct</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">finite_implies_normal_form</span> <span class="id" title="var">finite_exists_normal_form</span> <span class="id" title="var">finite_normal_form_implies_finite</span> : <span class="id" title="var">map_db</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="one_to_one_f_nequal"><span class="id" title="lemma">one_to_one_f_nequal</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>}`{<a class="idref" href="chainmail.common.html#Eq"><span class="id" title="class">Eq</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a>} (<span class="id" title="var">f</span> : <a class="idref" href="chainmail.common.html#partial_map"><span class="id" title="definition">partial_map</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a> <a class="idref" href="chainmail.partial_maps.html#B"><span class="id" title="variable">B</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chainmail.partial_maps.html#one_to_one"><span class="id" title="definition">one_to_one</span></a> <a class="idref" href="chainmail.partial_maps.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">a1</span> <span class="id" title="var">a2</span>, <a class="idref" href="chainmail.partial_maps.html#a1"><span class="id" title="variable">a1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a0a5068f83a704fcfbda8cd473a6cfea"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="chainmail.partial_maps.html#a2"><span class="id" title="variable">a2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="chainmail.partial_maps.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="chainmail.partial_maps.html#a1"><span class="id" title="variable">a1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="chainmail.partial_maps.html#b"><span class="id" title="variable">b</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chainmail.partial_maps.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="chainmail.partial_maps.html#a1"><span class="id" title="variable">a1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a0a5068f83a704fcfbda8cd473a6cfea"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="chainmail.partial_maps.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="chainmail.partial_maps.html#a2"><span class="id" title="variable">a2</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">H</span> <span class="id" title="var">f</span> <span class="id" title="var">H1t1</span> <span class="id" title="var">a1</span> <span class="id" title="var">a2</span> <span class="id" title="var">Hneq</span> <span class="id" title="var">Hex</span> <span class="id" title="var">Hcontra</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="chainmail.partial_maps.html#partial_map_dec"><span class="id" title="lemma">partial_map_dec</span></a> <span class="id" title="var">a1</span> <span class="id" title="var">f</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">Hsome1</span>|<span class="id" title="var">Hnone1</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">destruct_exists_loo</span>|].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> (<a class="idref" href="chainmail.partial_maps.html#partial_map_dec"><span class="id" title="lemma">partial_map_dec</span></a> <span class="id" title="var">a2</span> <span class="id" title="var">f</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">Hsome2</span>|<span class="id" title="var">Hnone2</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">destruct_exists_loo</span>|<span class="id" title="var">crush</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hcontra</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">H1</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">a1</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">a2</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="tactic">unfold</span> <a class="idref" href="chainmail.partial_maps.html#one_to_one"><span class="id" title="definition">one_to_one</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H1t1</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">H1t1</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">b</span>:=<span class="id" title="var">x0</span>)|];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">crush</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> (<a class="idref" href="chainmail.partial_maps.html#partial_map_dec"><span class="id" title="lemma">partial_map_dec</span></a> <span class="id" title="var">a2</span> <span class="id" title="var">f</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">Hsome2</span>|<span class="id" title="var">Hnone2</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">crush</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_exists</span>; <span class="id" title="var">crush</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="one_to_one_bind_f_nequal"><span class="id" title="lemma">one_to_one_bind_f_nequal</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>}`{<a class="idref" href="chainmail.common.html#Eq"><span class="id" title="class">Eq</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a>} (<span class="id" title="var">f</span> : <a class="idref" href="chainmail.common.html#partial_map"><span class="id" title="definition">partial_map</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a> <a class="idref" href="chainmail.partial_maps.html#B"><span class="id" title="variable">B</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chainmail.partial_maps.html#one_to_one"><span class="id" title="definition">one_to_one</span></a> <a class="idref" href="chainmail.partial_maps.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">a1</span> <span class="id" title="var">a2</span>, <a class="idref" href="chainmail.partial_maps.html#a1"><span class="id" title="variable">a1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a0a5068f83a704fcfbda8cd473a6cfea"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="chainmail.partial_maps.html#a2"><span class="id" title="variable">a2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="chainmail.common.html#bind"><span class="id" title="method">bind</span></a> <a class="idref" href="chainmail.partial_maps.html#a1"><span class="id" title="variable">a1</span></a> <a class="idref" href="chainmail.partial_maps.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="chainmail.partial_maps.html#b"><span class="id" title="variable">b</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chainmail.common.html#bind"><span class="id" title="method">bind</span></a> <a class="idref" href="chainmail.partial_maps.html#a1"><span class="id" title="variable">a1</span></a> <a class="idref" href="chainmail.partial_maps.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a0a5068f83a704fcfbda8cd473a6cfea"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="chainmail.common.html#bind"><span class="id" title="method">bind</span></a> <a class="idref" href="chainmail.partial_maps.html#a2"><span class="id" title="variable">a2</span></a> <a class="idref" href="chainmail.partial_maps.html#f"><span class="id" title="variable">f</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">H</span> <span class="id" title="var">f</span> <span class="id" title="var">H1t1</span> <span class="id" title="var">a1</span> <span class="id" title="var">a2</span> <span class="id" title="var">Hneq</span> <span class="id" title="var">Hex</span> <span class="id" title="var">Hcontra</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">a1</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">a2</span>); <span class="id" title="tactic">auto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_exists</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">crush</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">contradiction</span> <span class="id" title="var">Hneq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">erewrite</span> <span class="id" title="var">H1t1</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">a1</span>:=<span class="id" title="var">a</span>)(<span class="id" title="var">a2</span>:=<span class="id" title="var">a0</span>); <span class="id" title="tactic">eauto</span>; <span class="id" title="var">crush</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">maps_into_from_auto</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| [<span class="id" title="var">Ha</span> : <a class="idref" href="chainmail.common.html#maps_into"><span class="id" title="definition">maps_into</span></a> ?<span class="id" title="var">f</span> ?<span class="id" title="var">g</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Hb</span> : ?<span class="id" title="var">f</span> ?<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> ?<span class="id" title="var">b</span> |- <span class="id" title="var">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id" title="var">Hex</span> : <span class="id" title="var">g</span> <span class="id" title="var">b</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">fail</span> 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">destruct</span> (<span class="id" title="var">Ha</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>); <span class="id" title="tactic">auto</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;| [<span class="id" title="var">Ha</span> : <a class="idref" href="chainmail.common.html#maps_from"><span class="id" title="definition">maps_from</span></a> ?<span class="id" title="var">g</span> ?<span class="id" title="var">f</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Hb</span> : ?<span class="id" title="var">g</span> ?<span class="id" title="var">b</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> ?<span class="id" title="var">c</span> |- <span class="id" title="var">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id" title="var">Hex</span> : <span class="id" title="var">f</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">b</span> |- <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">fail</span> 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">destruct</span> (<span class="id" title="var">Ha</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span>); <span class="id" title="tactic">auto</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">eq_explode</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| [<span class="id" title="var">Heq</span> : <a class="idref" href="chainmail.common.html#Eq"><span class="id" title="class">Eq</span></a> ?<span class="id" title="var">A</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">a1</span> : ?<span class="id" title="var">A</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">a2</span> : ?<span class="id" title="var">A</span> |- <span class="id" title="var">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">notHyp</span> (<span class="id" title="var">a1</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a0a5068f83a704fcfbda8cd473a6cfea"><span class="id" title="notation">&lt;&gt;</span></a> <span class="id" title="var">a2</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">notHyp</span> (<span class="id" title="var">a2</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a0a5068f83a704fcfbda8cd473a6cfea"><span class="id" title="notation">&lt;&gt;</span></a> <span class="id" title="var">a1</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">Hneq</span> := <span class="id" title="tactic">fresh</span> "Hneq" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="chainmail.common.html#eq_dec"><span class="id" title="method">eq_dec</span></a> <span class="id" title="var">a1</span> <span class="id" title="var">a2</span>) <span class="id" title="keyword">as</span> [|<span class="id" title="var">Hneq</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">option_crush</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| [<span class="id" title="var">H</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> |- <span class="id" title="var">_</span>] =&gt; <span class="id" title="var">crush</span><br/>
&nbsp;&nbsp;| [<span class="id" title="var">H</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span>] =&gt; <span class="id" title="var">crush</span><br/>
<br/>
&nbsp;&nbsp;| [<span class="id" title="var">Ha</span> : ?<span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Hb</span> : ?<span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> |- <span class="id" title="var">_</span>] =&gt; <span class="id" title="var">crush</span><br/>
&nbsp;&nbsp;| [<span class="id" title="var">Ha</span> : ?<span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Hb</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> ?<span class="id" title="var">x</span> |- <span class="id" title="var">_</span>] =&gt; <span class="id" title="var">crush</span><br/>
&nbsp;&nbsp;| [<span class="id" title="var">Ha</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> ?<span class="id" title="var">x</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Hb</span> : ?<span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> |- <span class="id" title="var">_</span>] =&gt; <span class="id" title="var">crush</span><br/>
&nbsp;&nbsp;| [<span class="id" title="var">Ha</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> ?<span class="id" title="var">x</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Hb</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> ?<span class="id" title="var">x</span> |- <span class="id" title="var">_</span>] =&gt; <span class="id" title="var">crush</span><br/>
<br/>
&nbsp;&nbsp;| [<span class="id" title="var">H</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;| [<span class="id" title="var">Ha</span> : ?<span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Hb</span> : ?<span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Ha</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hb</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Hb</span>; <span class="id" title="tactic">subst</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">auto_specialize</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| [<span class="id" title="var">H</span> : ?<span class="id" title="var">P</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> ?<span class="id" title="var">Q</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">H'</span> : ?<span class="id" title="var">P</span> |- <span class="id" title="var">_</span> ] =&gt; <span class="id" title="tactic">specialize</span> (<span class="id" title="var">H</span> <span class="id" title="var">H'</span>)<br/>
&nbsp;&nbsp;| [<span class="id" title="var">Ha</span> : ?<span class="id" title="var">P</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25"><span class="id" title="notation">\/</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="var">_</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Hb</span> : ?<span class="id" title="var">P</span> |- <span class="id" title="var">_</span> ] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">Ha</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#or_introl"><span class="id" title="constructor">or_introl</span></a> <span class="id" title="var">Hb</span>))<br/>
&nbsp;&nbsp;| [<span class="id" title="var">Ha</span> : <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25"><span class="id" title="notation">\/</span></a> ?<span class="id" title="var">P</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="var">_</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Hb</span> : ?<span class="id" title="var">P</span> |- <span class="id" title="var">_</span> ] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">Ha</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#or_intror"><span class="id" title="constructor">or_intror</span></a> <span class="id" title="var">Hb</span>))<br/>
&nbsp;&nbsp;| [<span class="id" title="var">Ha</span> : ?<span class="id" title="var">P</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25"><span class="id" title="notation">\/</span></a> ?<span class="id" title="var">Q</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="var">_</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Hb</span> : ?<span class="id" title="var">P</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Hc</span> : ?<span class="id" title="var">Q</span> |- <span class="id" title="var">_</span> ] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">Ha</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#conj"><span class="id" title="constructor">conj</span></a> <span class="id" title="var">Ha</span> <span class="id" title="var">Hb</span>))<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="inv"><span class="id" title="definition">inv</span></a> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>}`{<a class="idref" href="chainmail.common.html#Eq"><span class="id" title="class">Eq</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a>}`{<a class="idref" href="chainmail.common.html#Eq"><span class="id" title="class">Eq</span></a> <a class="idref" href="chainmail.partial_maps.html#B"><span class="id" title="variable">B</span></a>}(<span class="id" title="var">f</span> : <a class="idref" href="chainmail.common.html#partial_map"><span class="id" title="definition">partial_map</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a> <a class="idref" href="chainmail.partial_maps.html#B"><span class="id" title="variable">B</span></a>)(<span class="id" title="var">f'</span> : <a class="idref" href="chainmail.common.html#partial_map"><span class="id" title="definition">partial_map</span></a> <a class="idref" href="chainmail.partial_maps.html#B"><span class="id" title="variable">B</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a>) :=<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">(</span></a><span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>, <a class="idref" href="chainmail.partial_maps.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="chainmail.partial_maps.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="chainmail.partial_maps.html#b"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chainmail.partial_maps.html#f'"><span class="id" title="variable">f'</span></a> <a class="idref" href="chainmail.partial_maps.html#b"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="chainmail.partial_maps.html#a"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">(</span></a><span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>, <a class="idref" href="chainmail.partial_maps.html#f'"><span class="id" title="variable">f'</span></a> <a class="idref" href="chainmail.partial_maps.html#b"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="chainmail.partial_maps.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chainmail.partial_maps.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="chainmail.partial_maps.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="chainmail.partial_maps.html#b"><span class="id" title="variable">b</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">)</span></a>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="inv_empty"><span class="id" title="lemma">inv_empty</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span>{<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>}{<span class="id" title="var">HeqA</span> : <a class="idref" href="chainmail.common.html#Eq"><span class="id" title="class">Eq</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a>}{<span class="id" title="var">HeqB</span> : <a class="idref" href="chainmail.common.html#Eq"><span class="id" title="class">Eq</span></a> <a class="idref" href="chainmail.partial_maps.html#B"><span class="id" title="variable">B</span></a>},<br/>
&nbsp;&nbsp;&nbsp;&nbsp;@<a class="idref" href="chainmail.partial_maps.html#inv"><span class="id" title="definition">inv</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a> <a class="idref" href="chainmail.partial_maps.html#B"><span class="id" title="variable">B</span></a> <a class="idref" href="chainmail.partial_maps.html#HeqA"><span class="id" title="variable">HeqA</span></a> <a class="idref" href="chainmail.partial_maps.html#HeqB"><span class="id" title="variable">HeqB</span></a> <a class="idref" href="chainmail.common.html#empty"><span class="id" title="definition">empty</span></a> <a class="idref" href="chainmail.common.html#empty"><span class="id" title="definition">empty</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="chainmail.partial_maps.html#inv"><span class="id" title="definition">inv</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="var">map_rewrite</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">crush</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">inv_empty</span> : <span class="id" title="var">map_db</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">inv_auto</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| [<span class="id" title="var">Hinv</span> : <a class="idref" href="chainmail.partial_maps.html#inv"><span class="id" title="definition">inv</span></a> ?<span class="id" title="var">f</span> ?<span class="id" title="var">f'</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">H</span> : ?<span class="id" title="var">f</span> ?<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> ?<span class="id" title="var">b</span> |- <span class="id" title="var">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">notHyp</span> (<span class="id" title="var">f'</span> <span class="id" title="var">b</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">a</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">f'</span> <span class="id" title="var">b</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">a</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="tactic">unfold</span> <a class="idref" href="chainmail.partial_maps.html#inv"><span class="id" title="definition">inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hinv</span>; <span class="id" title="var">andDestruct</span>; <span class="id" title="var">crush</span>|]<br/>
&nbsp;&nbsp;| [<span class="id" title="var">Hinv</span> : <a class="idref" href="chainmail.partial_maps.html#inv"><span class="id" title="definition">inv</span></a> ?<span class="id" title="var">f</span> ?<span class="id" title="var">f'</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">H</span> : ?<span class="id" title="var">f'</span> ?<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> ?<span class="id" title="var">b</span> |- <span class="id" title="var">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">notHyp</span> (<span class="id" title="var">f</span> <span class="id" title="var">b</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">a</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">f</span> <span class="id" title="var">b</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">a</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="tactic">unfold</span> <a class="idref" href="chainmail.partial_maps.html#inv"><span class="id" title="definition">inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hinv</span>; <span class="id" title="var">andDestruct</span>; <span class="id" title="var">crush</span>|]<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="inv_one_to_one_1"><span class="id" title="lemma">inv_one_to_one_1</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>}`{<a class="idref" href="chainmail.common.html#Eq"><span class="id" title="class">Eq</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a>}`{<a class="idref" href="chainmail.common.html#Eq"><span class="id" title="class">Eq</span></a> <a class="idref" href="chainmail.partial_maps.html#B"><span class="id" title="variable">B</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span> : <a class="idref" href="chainmail.common.html#partial_map"><span class="id" title="definition">partial_map</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a> <a class="idref" href="chainmail.partial_maps.html#B"><span class="id" title="variable">B</span></a>) (<span class="id" title="var">f'</span> : <a class="idref" href="chainmail.common.html#partial_map"><span class="id" title="definition">partial_map</span></a> <a class="idref" href="chainmail.partial_maps.html#B"><span class="id" title="variable">B</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chainmail.partial_maps.html#inv"><span class="id" title="definition">inv</span></a> <a class="idref" href="chainmail.partial_maps.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="chainmail.partial_maps.html#f'"><span class="id" title="variable">f'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chainmail.partial_maps.html#one_to_one"><span class="id" title="definition">one_to_one</span></a> <a class="idref" href="chainmail.partial_maps.html#f"><span class="id" title="variable">f</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">HeqA</span> <span class="id" title="var">HeqB</span> <span class="id" title="var">f</span> <span class="id" title="var">f'</span> <span class="id" title="var">Hinv</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="chainmail.partial_maps.html#one_to_one"><span class="id" title="definition">one_to_one</span></a>; <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="var">inv_auto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="var">option_crush</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="inv_one_to_one_2"><span class="id" title="lemma">inv_one_to_one_2</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>}`{<a class="idref" href="chainmail.common.html#Eq"><span class="id" title="class">Eq</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a>}`{<a class="idref" href="chainmail.common.html#Eq"><span class="id" title="class">Eq</span></a> <a class="idref" href="chainmail.partial_maps.html#B"><span class="id" title="variable">B</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span> : <a class="idref" href="chainmail.common.html#partial_map"><span class="id" title="definition">partial_map</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a> <a class="idref" href="chainmail.partial_maps.html#B"><span class="id" title="variable">B</span></a>) (<span class="id" title="var">f'</span> : <a class="idref" href="chainmail.common.html#partial_map"><span class="id" title="definition">partial_map</span></a> <a class="idref" href="chainmail.partial_maps.html#B"><span class="id" title="variable">B</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chainmail.partial_maps.html#inv"><span class="id" title="definition">inv</span></a> <a class="idref" href="chainmail.partial_maps.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="chainmail.partial_maps.html#f'"><span class="id" title="variable">f'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chainmail.partial_maps.html#one_to_one"><span class="id" title="definition">one_to_one</span></a> <a class="idref" href="chainmail.partial_maps.html#f'"><span class="id" title="variable">f'</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">HeqA</span> <span class="id" title="var">HeqB</span> <span class="id" title="var">f</span> <span class="id" title="var">f'</span> <span class="id" title="var">Hinv</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="chainmail.partial_maps.html#one_to_one"><span class="id" title="definition">one_to_one</span></a>; <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="chainmail.partial_maps.html#inv"><span class="id" title="definition">inv</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="var">andDestruct</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| [<span class="id" title="var">H</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>, ?<span class="id" title="var">f'</span> <a class="idref" href="chainmail.partial_maps.html#b"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="chainmail.partial_maps.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> ?<span class="id" title="var">f</span> <a class="idref" href="chainmail.partial_maps.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="chainmail.partial_maps.html#b"><span class="id" title="variable">b</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Ha</span> : ?<span class="id" title="var">f'</span> ?<span class="id" title="var">a1</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> ?<span class="id" title="var">b'</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Hb</span> : ?<span class="id" title="var">f'</span> ?<span class="id" title="var">a2</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> ?<span class="id" title="var">b'</span> |-<span class="id" title="var">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Ha</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hb</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hb</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Ha</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">crush</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="one_to_one_empty"><span class="id" title="lemma">one_to_one_empty</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>}{<span class="id" title="var">Heq</span> : <a class="idref" href="chainmail.common.html#Eq"><span class="id" title="class">Eq</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a>},<br/>
&nbsp;&nbsp;&nbsp;&nbsp;@<a class="idref" href="chainmail.partial_maps.html#one_to_one"><span class="id" title="definition">one_to_one</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a> <a class="idref" href="chainmail.partial_maps.html#B"><span class="id" title="variable">B</span></a> <a class="idref" href="chainmail.partial_maps.html#Heq"><span class="id" title="variable">Heq</span></a> <a class="idref" href="chainmail.common.html#empty"><span class="id" title="definition">empty</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="chainmail.partial_maps.html#one_to_one"><span class="id" title="definition">one_to_one</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="var">map_rewrite</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">crush</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">one_to_one_empty</span> : <span class="id" title="var">map_db</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="one_to_one_fnf_update"><span class="id" title="lemma">one_to_one_fnf_update</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>}`{<a class="idref" href="chainmail.common.html#Eq"><span class="id" title="class">Eq</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a>} (<span class="id" title="var">f</span> : <a class="idref" href="chainmail.common.html#partial_map"><span class="id" title="definition">partial_map</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a> <a class="idref" href="chainmail.partial_maps.html#B"><span class="id" title="variable">B</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chainmail.partial_maps.html#finite_normal_form"><span class="id" title="inductive">finite_normal_form</span></a> <a class="idref" href="chainmail.partial_maps.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>, <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">(</span></a><a class="idref" href="chainmail.partial_maps.html#one_to_one"><span class="id" title="definition">one_to_one</span></a> (<a class="idref" href="chainmail.common.html#update"><span class="id" title="definition">update</span></a> <a class="idref" href="chainmail.partial_maps.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="chainmail.partial_maps.html#b"><span class="id" title="variable">b</span></a> <a class="idref" href="chainmail.partial_maps.html#f"><span class="id" title="variable">f</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chainmail.partial_maps.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="chainmail.partial_maps.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chainmail.partial_maps.html#one_to_one"><span class="id" title="definition">one_to_one</span></a> <a class="idref" href="chainmail.partial_maps.html#f"><span class="id" title="variable">f</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">HeqA</span> <span class="id" title="var">f</span> <span class="id" title="var">Hfin</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">Hfin</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">map_db</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="chainmail.partial_maps.html#one_to_one"><span class="id" title="definition">one_to_one</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="var">map_rewrite</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="var">eq_explode</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="var">eq_auto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">map_db</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="var">option_crush</span>.<br/>

<br/>
&nbsp;&nbsp;- <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id" title="var">H</span> : <a class="idref" href="chainmail.partial_maps.html#one_to_one"><span class="id" title="definition">one_to_one</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="keyword">if</span> <span class="id" title="var">_</span> <span class="id" title="keyword">then</span> <span class="id" title="var">_</span> <span class="id" title="keyword">else</span> <span class="id" title="keyword">if</span> <span class="id" title="var">_</span> <span class="id" title="keyword">then</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> ?<span class="id" title="var">b'</span> <span class="id" title="keyword">else</span> <span class="id" title="var">_</span>) |- ?<span class="id" title="var">a1</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> ?<span class="id" title="var">a2</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">b</span>:=<span class="id" title="var">b'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="var">eq_auto</span>.<br/>

<br/>
&nbsp;&nbsp;- <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id" title="var">H</span> : <a class="idref" href="chainmail.partial_maps.html#one_to_one"><span class="id" title="definition">one_to_one</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="keyword">if</span> <span class="id" title="var">_</span> <span class="id" title="keyword">then</span> <span class="id" title="var">_</span> <span class="id" title="keyword">else</span> <span class="id" title="keyword">if</span> <span class="id" title="var">_</span> <span class="id" title="keyword">then</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> ?<span class="id" title="var">b'</span> <span class="id" title="keyword">else</span> <span class="id" title="var">_</span>) |- ?<span class="id" title="var">a1</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> ?<span class="id" title="var">a2</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">b</span>:=<span class="id" title="var">b'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="var">eq_auto</span>.<br/>

<br/>
&nbsp;&nbsp;- <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id" title="var">H</span> : <a class="idref" href="chainmail.partial_maps.html#one_to_one"><span class="id" title="definition">one_to_one</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="keyword">if</span> <span class="id" title="var">_</span> <span class="id" title="keyword">then</span> <span class="id" title="var">_</span> <span class="id" title="keyword">else</span> <span class="id" title="keyword">if</span> <span class="id" title="var">_</span> <span class="id" title="keyword">then</span> <span class="id" title="var">_</span> <span class="id" title="keyword">else</span> ?<span class="id" title="var">m</span> <a class="idref" href="chainmail.partial_maps.html#x"><span class="id" title="variable">x</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Ha</span> : ?<span class="id" title="var">m</span> ?<span class="id" title="var">a1</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> ?<span class="id" title="var">b'</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Hb</span> : ?<span class="id" title="var">m</span> ?<span class="id" title="var">a2</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> ?<span class="id" title="var">b'</span> |- ?<span class="id" title="var">a1</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> ?<span class="id" title="var">a2</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">b1</span>:=<span class="id" title="var">b'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="var">eq_auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="inv_update"><span class="id" title="lemma">inv_update</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span>}`{<a class="idref" href="chainmail.common.html#Eq"><span class="id" title="class">Eq</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a>}`{<a class="idref" href="chainmail.common.html#Eq"><span class="id" title="class">Eq</span></a> <a class="idref" href="chainmail.partial_maps.html#B"><span class="id" title="variable">B</span></a>} (<span class="id" title="var">f</span> : <a class="idref" href="chainmail.common.html#partial_map"><span class="id" title="definition">partial_map</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a> <a class="idref" href="chainmail.partial_maps.html#B"><span class="id" title="variable">B</span></a>)(<span class="id" title="var">f'</span> : <a class="idref" href="chainmail.common.html#partial_map"><span class="id" title="definition">partial_map</span></a> <a class="idref" href="chainmail.partial_maps.html#B"><span class="id" title="variable">B</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chainmail.partial_maps.html#inv"><span class="id" title="definition">inv</span></a> <a class="idref" href="chainmail.partial_maps.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="chainmail.partial_maps.html#f'"><span class="id" title="variable">f'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chainmail.partial_maps.html#f'"><span class="id" title="variable">f'</span></a> <a class="idref" href="chainmail.partial_maps.html#b"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chainmail.partial_maps.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="chainmail.partial_maps.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chainmail.partial_maps.html#inv"><span class="id" title="definition">inv</span></a> (<a class="idref" href="chainmail.common.html#update"><span class="id" title="definition">update</span></a> <a class="idref" href="chainmail.partial_maps.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="chainmail.partial_maps.html#b"><span class="id" title="variable">b</span></a> <a class="idref" href="chainmail.partial_maps.html#f"><span class="id" title="variable">f</span></a>) (<a class="idref" href="chainmail.common.html#update"><span class="id" title="definition">update</span></a> <a class="idref" href="chainmail.partial_maps.html#b"><span class="id" title="variable">b</span></a> <a class="idref" href="chainmail.partial_maps.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="chainmail.partial_maps.html#f'"><span class="id" title="variable">f'</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="chainmail.partial_maps.html#inv"><span class="id" title="definition">inv</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="var">eq_explode</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="var">map_rewrite</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="var">eq_auto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="var">inv_auto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="var">option_crush</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">crush</span>.<br/>

<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="one_to_one_update_none"><span class="id" title="lemma">one_to_one_update_none</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>}`{<a class="idref" href="chainmail.common.html#Eq"><span class="id" title="class">Eq</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a>}`{<a class="idref" href="chainmail.common.html#Eq"><span class="id" title="class">Eq</span></a> <a class="idref" href="chainmail.partial_maps.html#B"><span class="id" title="variable">B</span></a>} (<span class="id" title="var">f</span> : <a class="idref" href="chainmail.common.html#partial_map"><span class="id" title="definition">partial_map</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a> <a class="idref" href="chainmail.partial_maps.html#B"><span class="id" title="variable">B</span></a>) <span class="id" title="var">a</span> <span class="id" title="var">b</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chainmail.partial_maps.html#one_to_one"><span class="id" title="definition">one_to_one</span></a> (<a class="idref" href="chainmail.common.html#update"><span class="id" title="definition">update</span></a> <a class="idref" href="chainmail.partial_maps.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="chainmail.partial_maps.html#b"><span class="id" title="variable">b</span></a> <a class="idref" href="chainmail.partial_maps.html#f"><span class="id" title="variable">f</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">a'</span>, <a class="idref" href="chainmail.partial_maps.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="chainmail.partial_maps.html#a'"><span class="id" title="variable">a'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="chainmail.partial_maps.html#b"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="chainmail.partial_maps.html#a'"><span class="id" title="variable">a'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="chainmail.partial_maps.html#a"><span class="id" title="variable">a</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">HeqA</span> <span class="id" title="var">HeqB</span> <span class="id" title="var">f</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">Hone2one</span> <span class="id" title="var">a'</span> <span class="id" title="var">Hmap</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="chainmail.partial_maps.html#one_to_one"><span class="id" title="definition">one_to_one</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="var">eq_explode</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Hone2one</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">b0</span>:=<span class="id" title="var">b</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="var">map_rewrite</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="var">eq_auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">one_to_one_auto</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| [<span class="id" title="var">H</span> : <a class="idref" href="chainmail.partial_maps.html#one_to_one"><span class="id" title="definition">one_to_one</span></a> ?<span class="id" title="var">f</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Ha</span> : ?<span class="id" title="var">f</span> ?<span class="id" title="var">a1</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> ?<span class="id" title="var">b</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Hb</span> : ?<span class="id" title="var">f</span> ?<span class="id" title="var">a2</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> ?<span class="id" title="var">b</span> |- <span class="id" title="var">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">Htmp</span> := <span class="id" title="tactic">fresh</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Htmp</span> : <span class="id" title="var">a1</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">a2</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="tactic">apply</span> (<span class="id" title="var">H</span> <span class="id" title="var">a1</span> <span class="id" title="var">a2</span> <span class="id" title="var">b</span> <span class="id" title="var">Ha</span> <span class="id" title="var">Hb</span>)|<span class="id" title="tactic">subst</span> <span class="id" title="var">a1</span>]<br/>
&nbsp;&nbsp;| [<span class="id" title="var">Ha</span> : <a class="idref" href="chainmail.partial_maps.html#finite_normal_form"><span class="id" title="inductive">finite_normal_form</span></a> ?<span class="id" title="var">f</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Hb</span> : <a class="idref" href="chainmail.partial_maps.html#one_to_one"><span class="id" title="definition">one_to_one</span></a> (<a class="idref" href="chainmail.common.html#update"><span class="id" title="definition">update</span></a> ?<span class="id" title="var">a</span> ?<span class="id" title="var">b</span> ?<span class="id" title="var">f</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Hc</span> : ?<span class="id" title="var">f</span> ?<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> |- <span class="id" title="var">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">notHyp</span> (<a class="idref" href="chainmail.partial_maps.html#one_to_one"><span class="id" title="definition">one_to_one</span></a> <span class="id" title="var">f</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="chainmail.partial_maps.html#one_to_one"><span class="id" title="definition">one_to_one</span></a> <span class="id" title="var">f</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="tactic">apply</span> <a class="idref" href="chainmail.partial_maps.html#one_to_one_fnf_update"><span class="id" title="lemma">one_to_one_fnf_update</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hb</span>; <span class="id" title="tactic">auto</span>|]<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="one_to_one_exists_inv_fnf"><span class="id" title="lemma">one_to_one_exists_inv_fnf</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>)`{<a class="idref" href="chainmail.common.html#Eq"><span class="id" title="class">Eq</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a>}`{<a class="idref" href="chainmail.common.html#Eq"><span class="id" title="class">Eq</span></a> <a class="idref" href="chainmail.partial_maps.html#B"><span class="id" title="variable">B</span></a>} (<span class="id" title="var">f</span> : <a class="idref" href="chainmail.common.html#partial_map"><span class="id" title="definition">partial_map</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a> <a class="idref" href="chainmail.partial_maps.html#B"><span class="id" title="variable">B</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chainmail.partial_maps.html#finite_normal_form"><span class="id" title="inductive">finite_normal_form</span></a> <a class="idref" href="chainmail.partial_maps.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chainmail.partial_maps.html#one_to_one"><span class="id" title="definition">one_to_one</span></a> <a class="idref" href="chainmail.partial_maps.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <span class="id" title="var">f'</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="chainmail.partial_maps.html#inv"><span class="id" title="definition">inv</span></a> <a class="idref" href="chainmail.partial_maps.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="chainmail.partial_maps.html#f'"><span class="id" title="variable">f'</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">HeqA</span> <span class="id" title="var">Heqb</span> <span class="id" title="var">f</span> <span class="id" title="var">Hfin</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">Hfin</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>

<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exists</span> <a class="idref" href="chainmail.common.html#empty"><span class="id" title="definition">empty</span></a>; <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">map_db</span>.<br/>

<br/>
&nbsp;&nbsp;- <span class="id" title="var">one_to_one_auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">auto_specialize</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_exists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eexists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="chainmail.partial_maps.html#inv_update"><span class="id" title="lemma">inv_update</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="keyword">forall</span> <span class="id" title="var">a'</span>, <span class="id" title="var">m</span> <a class="idref" href="chainmail.partial_maps.html#a'"><span class="id" title="variable">a'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">b</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="chainmail.partial_maps.html#a'"><span class="id" title="variable">a'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">a</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="tactic">apply</span> <a class="idref" href="chainmail.partial_maps.html#one_to_one_update_none"><span class="id" title="lemma">one_to_one_update_none</span></a>; <span class="id" title="tactic">auto</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="chainmail.partial_maps.html#not_some_implies_none"><span class="id" title="lemma">not_some_implies_none</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a'</span> <span class="id" title="var">Hcontra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="var">inv_auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id" title="var">_</span> : ?<span class="id" title="var">m</span> ?<span class="id" title="var">a'</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> ?<span class="id" title="var">b</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">H</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a''</span>, ?<span class="id" title="var">m</span> <a class="idref" href="chainmail.partial_maps.html#a''"><span class="id" title="variable">a''</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> ?<span class="id" title="var">b</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="chainmail.partial_maps.html#a''"><span class="id" title="variable">a''</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> ?<span class="id" title="var">a</span> |- <span class="id" title="var">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">a'</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">a</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="tactic">apply</span> <span class="id" title="var">H3</span>; <span class="id" title="tactic">auto</span>|<span class="id" title="tactic">subst</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">option_crush</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="one_to_one_exists_inv_fin"><span class="id" title="lemma">one_to_one_exists_inv_fin</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>)`{<a class="idref" href="chainmail.common.html#Eq"><span class="id" title="class">Eq</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a>}`{<a class="idref" href="chainmail.common.html#Eq"><span class="id" title="class">Eq</span></a> <a class="idref" href="chainmail.partial_maps.html#B"><span class="id" title="variable">B</span></a>} (<span class="id" title="var">f</span> : <a class="idref" href="chainmail.common.html#partial_map"><span class="id" title="definition">partial_map</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a> <a class="idref" href="chainmail.partial_maps.html#B"><span class="id" title="variable">B</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chainmail.common.html#finite"><span class="id" title="inductive">finite</span></a> <a class="idref" href="chainmail.partial_maps.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chainmail.partial_maps.html#one_to_one"><span class="id" title="definition">one_to_one</span></a> <a class="idref" href="chainmail.partial_maps.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <span class="id" title="var">f'</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="chainmail.partial_maps.html#inv"><span class="id" title="definition">inv</span></a> <a class="idref" href="chainmail.partial_maps.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="chainmail.partial_maps.html#f'"><span class="id" title="variable">f'</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="chainmail.partial_maps.html#one_to_one_exists_inv_fnf"><span class="id" title="lemma">one_to_one_exists_inv_fnf</span></a>; <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">map_db</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Parameter</span> <a name="one_to_one_exists_inv"><span class="id" title="axiom">one_to_one_exists_inv</span></a>:<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>)`{<a class="idref" href="chainmail.common.html#Eq"><span class="id" title="class">Eq</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a>}`{<a class="idref" href="chainmail.common.html#Eq"><span class="id" title="class">Eq</span></a> <a class="idref" href="chainmail.partial_maps.html#B"><span class="id" title="variable">B</span></a>} (<span class="id" title="var">f</span> : <a class="idref" href="chainmail.common.html#partial_map"><span class="id" title="definition">partial_map</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a> <a class="idref" href="chainmail.partial_maps.html#B"><span class="id" title="variable">B</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chainmail.partial_maps.html#one_to_one"><span class="id" title="definition">one_to_one</span></a> <a class="idref" href="chainmail.partial_maps.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <span class="id" title="var">f'</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="chainmail.partial_maps.html#inv"><span class="id" title="definition">inv</span></a> <a class="idref" href="chainmail.partial_maps.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="chainmail.partial_maps.html#f'"><span class="id" title="variable">f'</span></a>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="inv_symmetry"><span class="id" title="lemma">inv_symmetry</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>}`{<a class="idref" href="chainmail.common.html#Eq"><span class="id" title="class">Eq</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a>}`{<a class="idref" href="chainmail.common.html#Eq"><span class="id" title="class">Eq</span></a> <a class="idref" href="chainmail.partial_maps.html#B"><span class="id" title="variable">B</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span> : <a class="idref" href="chainmail.common.html#partial_map"><span class="id" title="definition">partial_map</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a> <a class="idref" href="chainmail.partial_maps.html#B"><span class="id" title="variable">B</span></a>)(<span class="id" title="var">f'</span> : <a class="idref" href="chainmail.common.html#partial_map"><span class="id" title="definition">partial_map</span></a> <a class="idref" href="chainmail.partial_maps.html#B"><span class="id" title="variable">B</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chainmail.partial_maps.html#inv"><span class="id" title="definition">inv</span></a> <a class="idref" href="chainmail.partial_maps.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="chainmail.partial_maps.html#f'"><span class="id" title="variable">f'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chainmail.partial_maps.html#inv"><span class="id" title="definition">inv</span></a> <a class="idref" href="chainmail.partial_maps.html#f'"><span class="id" title="variable">f'</span></a> <a class="idref" href="chainmail.partial_maps.html#f"><span class="id" title="variable">f</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="chainmail.partial_maps.html#inv"><span class="id" title="definition">inv</span></a> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">andDestruct</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="inverse_maps_into"><span class="id" title="lemma">inverse_maps_into</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>}`{<a class="idref" href="chainmail.common.html#Eq"><span class="id" title="class">Eq</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a>}`{<a class="idref" href="chainmail.common.html#Eq"><span class="id" title="class">Eq</span></a> <a class="idref" href="chainmail.partial_maps.html#B"><span class="id" title="variable">B</span></a>}(<span class="id" title="var">f</span> : <a class="idref" href="chainmail.common.html#partial_map"><span class="id" title="definition">partial_map</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a> <a class="idref" href="chainmail.partial_maps.html#B"><span class="id" title="variable">B</span></a>)(<span class="id" title="var">f'</span> : <a class="idref" href="chainmail.common.html#partial_map"><span class="id" title="definition">partial_map</span></a> <a class="idref" href="chainmail.partial_maps.html#B"><span class="id" title="variable">B</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chainmail.partial_maps.html#inv"><span class="id" title="definition">inv</span></a> <a class="idref" href="chainmail.partial_maps.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="chainmail.partial_maps.html#f'"><span class="id" title="variable">f'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chainmail.common.html#maps_into"><span class="id" title="definition">maps_into</span></a> <a class="idref" href="chainmail.partial_maps.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="chainmail.partial_maps.html#f'"><span class="id" title="variable">f'</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="chainmail.partial_maps.html#inv"><span class="id" title="definition">inv</span></a> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">andDestruct</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="chainmail.common.html#maps_into"><span class="id" title="definition">maps_into</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| [<span class="id" title="var">Ha</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>, ?<span class="id" title="var">f</span> <a class="idref" href="chainmail.partial_maps.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="chainmail.partial_maps.html#b"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> ?<span class="id" title="var">f'</span> <a class="idref" href="chainmail.partial_maps.html#b"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="chainmail.partial_maps.html#a"><span class="id" title="variable">a</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Hb</span> : ?<span class="id" title="var">f</span> ?<span class="id" title="var">a'</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> ?<span class="id" title="var">b'</span> |- <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <span class="id" title="var">c</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> ?<span class="id" title="var">f'</span> ?<span class="id" title="var">b'</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="chainmail.partial_maps.html#c"><span class="id" title="variable">c</span></a> ] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Ha</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hb</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eexists</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eauto</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="inverse_maps_from"><span class="id" title="lemma">inverse_maps_from</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>}`{<a class="idref" href="chainmail.common.html#Eq"><span class="id" title="class">Eq</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a>}`{<a class="idref" href="chainmail.common.html#Eq"><span class="id" title="class">Eq</span></a> <a class="idref" href="chainmail.partial_maps.html#B"><span class="id" title="variable">B</span></a>}(<span class="id" title="var">f</span> : <a class="idref" href="chainmail.common.html#partial_map"><span class="id" title="definition">partial_map</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a> <a class="idref" href="chainmail.partial_maps.html#B"><span class="id" title="variable">B</span></a>)(<span class="id" title="var">f'</span> : <a class="idref" href="chainmail.common.html#partial_map"><span class="id" title="definition">partial_map</span></a> <a class="idref" href="chainmail.partial_maps.html#B"><span class="id" title="variable">B</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chainmail.partial_maps.html#inv"><span class="id" title="definition">inv</span></a> <a class="idref" href="chainmail.partial_maps.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="chainmail.partial_maps.html#f'"><span class="id" title="variable">f'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chainmail.common.html#maps_from"><span class="id" title="definition">maps_from</span></a> <a class="idref" href="chainmail.partial_maps.html#f'"><span class="id" title="variable">f'</span></a> <a class="idref" href="chainmail.partial_maps.html#f"><span class="id" title="variable">f</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="chainmail.partial_maps.html#inv"><span class="id" title="definition">inv</span></a> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">andDestruct</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="chainmail.common.html#maps_from"><span class="id" title="definition">maps_from</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| [<span class="id" title="var">Ha</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>, ?<span class="id" title="var">f'</span> <a class="idref" href="chainmail.partial_maps.html#b"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="chainmail.partial_maps.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> ?<span class="id" title="var">f</span> <a class="idref" href="chainmail.partial_maps.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="chainmail.partial_maps.html#b"><span class="id" title="variable">b</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Hb</span> : ?<span class="id" title="var">f'</span> ?<span class="id" title="var">b'</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> ?<span class="id" title="var">c'</span> |- <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> ?<span class="id" title="var">f</span> <a class="idref" href="chainmail.partial_maps.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> ?<span class="id" title="var">b'</span> ] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Ha</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hb</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eexists</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eauto</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">inverse_maps_from</span> <span class="id" title="var">inverse_maps_into</span> : <span class="id" title="var">map_db</span>.<br/>

<br/>
<span class="comment">(*)Lemma&nbsp;inverse_compose_left&nbsp;:<br/>
&nbsp;&nbsp;forall&nbsp;{A&nbsp;B&nbsp;C&nbsp;:&nbsp;Type}`{Eq&nbsp;A}`{Eq&nbsp;B}(m&nbsp;:&nbsp;partial_map&nbsp;A&nbsp;C)(f&nbsp;:&nbsp;partial_map&nbsp;A&nbsp;B)(f'&nbsp;:&nbsp;partial_map&nbsp;B&nbsp;A),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;inv&nbsp;f&nbsp;f'&nbsp;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;maps_from&nbsp;m&nbsp;f'&nbsp;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;f&nbsp;∘&nbsp;f'&nbsp;∘&nbsp;m&nbsp;=&nbsp;m.<br/>
Proof.<br/>
&nbsp;&nbsp;intros.<br/>
&nbsp;&nbsp;apply&nbsp;functional_extensionality;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;intros&nbsp;a;&nbsp;unfold&nbsp;id;&nbsp;simpl.<br/>
&nbsp;&nbsp;destruct&nbsp;(partial_map_dec&nbsp;a&nbsp;f)&nbsp;as&nbsp;<span class="inlinecode">|<span class="id" title="var">Hnone</span></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="inlinecode"><span class="id" title="var">destruct_exists</span>|<span class="id" title="tactic">rewrite</span></span> <span class="inlinecode"><span class="id" title="var">Hnone</span></span>.<br/>
<br/>
&nbsp;&nbsp;-&nbsp;repeat&nbsp;maps_into_from_auto;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;repeat&nbsp;inv_auto;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;crush.<br/>
&nbsp;&nbsp;-&nbsp;symmetry;&nbsp;apply&nbsp;not_some_implies_none;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;intros&nbsp;b&nbsp;Hcontra.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;maps_into_from_auto.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;inv_auto.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;crush.<br/>
Qed.<br/>
<br/>
Lemma&nbsp;compose_assoc&nbsp;:<br/>
&nbsp;&nbsp;forall&nbsp;{A&nbsp;B&nbsp;C&nbsp;D&nbsp;:&nbsp;Type}`{Eq&nbsp;A}`{Eq&nbsp;B}`{Eq&nbsp;C}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(f&nbsp;:&nbsp;partial_map&nbsp;A&nbsp;B)(g&nbsp;:&nbsp;partial_map&nbsp;B&nbsp;C)(h&nbsp;:&nbsp;partial_map&nbsp;C&nbsp;D),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(f&nbsp;∘&nbsp;g)&nbsp;∘&nbsp;h&nbsp;=&nbsp;f&nbsp;∘&nbsp;(g&nbsp;∘&nbsp;h).<br/>
Proof.<br/>
&nbsp;&nbsp;intros&nbsp;A&nbsp;B&nbsp;C&nbsp;D&nbsp;HeqA&nbsp;HeqB&nbsp;HeqC&nbsp;&nbsp;f&nbsp;g&nbsp;h.<br/>
&nbsp;&nbsp;apply&nbsp;functional_extensionality;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;intros&nbsp;a;&nbsp;simpl;&nbsp;auto.<br/>
&nbsp;&nbsp;destruct&nbsp;(f&nbsp;a);&nbsp;auto.<br/>
Qed.*)</span><br/>

<br/>
<span class="comment">(*Lemma&nbsp;bind_inverse_right&nbsp;:<br/>
&nbsp;&nbsp;forall&nbsp;{A&nbsp;B&nbsp;C&nbsp;:&nbsp;Type}`{Eq&nbsp;A}`{Eq&nbsp;B}`{Eq&nbsp;C}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(f&nbsp;:&nbsp;partial_map&nbsp;B&nbsp;C)(f'&nbsp;:&nbsp;partial_map&nbsp;C&nbsp;B),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;inv&nbsp;f&nbsp;f'&nbsp;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;forall&nbsp;(m&nbsp;:&nbsp;partial_map&nbsp;A&nbsp;B),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(forall&nbsp;a&nbsp;b,&nbsp;m&nbsp;a&nbsp;=&nbsp;Some&nbsp;b&nbsp;-&gt;&nbsp;exists&nbsp;c,&nbsp;f&nbsp;b&nbsp;=&nbsp;Some&nbsp;c)&nbsp;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(fun&nbsp;x&nbsp;=&gt;&nbsp;bind&nbsp;(bind&nbsp;(m&nbsp;x)&nbsp;f)&nbsp;f')&nbsp;=&nbsp;m.<br/>
Proof.<br/>
&nbsp;&nbsp;intros.<br/>
&nbsp;&nbsp;unfold&nbsp;bind;&nbsp;simpl.<br/>
&nbsp;&nbsp;apply&nbsp;functional_extensionality;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;intros&nbsp;a.<br/>
&nbsp;&nbsp;match&nbsp;goal&nbsp;with<br/>
&nbsp;&nbsp;|&nbsp;<span class="inlinecode">|-</span> <span class="inlinecode"><span class="id" title="var">_</span></span> <span class="inlinecode">=</span> <span class="inlinecode">?<span class="id" title="var">m</span></span> <span class="inlinecode">?<span class="id" title="var">a</span></span>&nbsp;=&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;destruct&nbsp;(partial_map_dec&nbsp;a&nbsp;m)&nbsp;as&nbsp;<span class="inlinecode"><span class="id" title="var">Hsome</span>|<span class="id" title="var">Hnone</span></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="inlinecode"><span class="id" title="var">destruct_exists</span>|<span class="id" title="tactic">rewrite</span></span> <span class="inlinecode"><span class="id" title="var">Hnone</span>;</span> <span class="inlinecode"><span class="id" title="tactic">auto</span></span><br/>
&nbsp;&nbsp;end.<br/>
&nbsp;&nbsp;match&nbsp;goal&nbsp;with<br/>
&nbsp;&nbsp;|&nbsp;<span class="inlinecode"><span class="id" title="var">H</span></span> <span class="inlinecode">:</span> <span class="inlinecode">?<span class="id" title="var">m</span></span> <span class="inlinecode">?<span class="id" title="var">a</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">Some</span></span> <span class="inlinecode">?<span class="id" title="var">b</span>,</span>
         <span class="inlinecode"><span class="id" title="var">Hmap</span></span> <span class="inlinecode">:</span> <span class="inlinecode"><span class="id" title="keyword">forall</span></span> <span class="inlinecode"><span class="id" title="var">a'</span></span> <span class="inlinecode"><span class="id" title="var">b'</span>,</span> <span class="inlinecode">?<span class="id" title="var">m</span></span> <span class="inlinecode"><span class="id" title="var">a'</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">Some</span></span> <span class="inlinecode"><span class="id" title="var">b'</span></span> <span class="inlinecode">-&gt;</span> <span class="inlinecode"><span class="id" title="var">_</span></span> <span class="inlinecode">|-</span> <span class="inlinecode"><span class="id" title="var">_</span></span> <span class="inlinecode">=</span> <span class="inlinecode">?<span class="id" title="var">m</span></span> <span class="inlinecode">?<span class="id" title="var">a</span></span>&nbsp;=&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;rewrite&nbsp;H;&nbsp;apply&nbsp;Hmap&nbsp;in&nbsp;H;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;destruct_exists<br/>
&nbsp;&nbsp;end.<br/>
&nbsp;&nbsp;unfold&nbsp;inv&nbsp;in&nbsp;*;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;andDestruct.<br/>
&nbsp;&nbsp;crush.<br/>
Qed.<br/>
<br/>
Lemma&nbsp;bind_inverse_left&nbsp;:<br/>
&nbsp;&nbsp;forall&nbsp;{A&nbsp;B&nbsp;C&nbsp;:&nbsp;Type}`{Eq&nbsp;A}`{Eq&nbsp;B}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(f&nbsp;:&nbsp;partial_map&nbsp;A&nbsp;B)(f'&nbsp;:&nbsp;partial_map&nbsp;B&nbsp;A),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;inv&nbsp;f&nbsp;f'&nbsp;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;forall&nbsp;(m&nbsp;:&nbsp;partial_map&nbsp;B&nbsp;C),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(forall&nbsp;a&nbsp;b,&nbsp;f&nbsp;a&nbsp;=&nbsp;Some&nbsp;b&nbsp;-&gt;&nbsp;exists&nbsp;c,&nbsp;m&nbsp;b&nbsp;=&nbsp;Some&nbsp;c)&nbsp;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(forall&nbsp;b&nbsp;c,&nbsp;m&nbsp;b&nbsp;=&nbsp;Some&nbsp;c&nbsp;-&gt;&nbsp;exists&nbsp;a,&nbsp;f&nbsp;a&nbsp;=&nbsp;Some&nbsp;b)&nbsp;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(fun&nbsp;x&nbsp;&nbsp;=&gt;&nbsp;bind&nbsp;(f'&nbsp;x)&nbsp;(fun&nbsp;y&nbsp;=&gt;&nbsp;bind&nbsp;(f&nbsp;y)&nbsp;m))&nbsp;=&nbsp;m.<br/>
Proof.<br/>
&nbsp;&nbsp;intros.<br/>
&nbsp;&nbsp;unfold&nbsp;bind;&nbsp;simpl.<br/>
&nbsp;&nbsp;apply&nbsp;functional_extensionality;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;intros&nbsp;b.<br/>
&nbsp;&nbsp;match&nbsp;goal&nbsp;with<br/>
&nbsp;&nbsp;|&nbsp;<span class="inlinecode"><span class="id" title="var">_</span></span> <span class="inlinecode">:</span> <span class="inlinecode"><span class="id" title="var">inv</span></span> <span class="inlinecode">?<span class="id" title="var">f</span></span> <span class="inlinecode">?<span class="id" title="var">f'</span></span> <span class="inlinecode">|-</span> <span class="inlinecode"><span class="id" title="keyword">context</span>[?<span class="id" title="var">f'</span></span> <span class="inlinecode">?<span class="id" title="var">b</span>]</span>&nbsp;=&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;destruct&nbsp;(partial_map_dec&nbsp;b&nbsp;f')&nbsp;as&nbsp;<span class="inlinecode"><span class="id" title="var">Hsome</span>|<span class="id" title="var">Hnone</span></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="inlinecode"><span class="id" title="var">destruct_exists</span>|<span class="id" title="tactic">rewrite</span></span> <span class="inlinecode"><span class="id" title="var">Hnone</span>;</span> <span class="inlinecode"><span class="id" title="tactic">auto</span></span><br/>
&nbsp;&nbsp;end.<br/>
<br/>
&nbsp;&nbsp;-&nbsp;match&nbsp;goal&nbsp;with<br/>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;<span class="inlinecode"><span class="id" title="var">H</span></span> <span class="inlinecode">:</span> <span class="inlinecode">?<span class="id" title="var">f'</span></span> <span class="inlinecode">?<span class="id" title="var">b</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">Some</span></span> <span class="inlinecode">?<span class="id" title="var">a</span></span> <span class="inlinecode">|-</span> <span class="inlinecode"><span class="id" title="keyword">context</span>[?<span class="id" title="var">f'</span></span> <span class="inlinecode">?<span class="id" title="var">b</span>]</span>&nbsp;=&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rewrite&nbsp;H<br/>
&nbsp;&nbsp;&nbsp;&nbsp;end.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;unfold&nbsp;inv&nbsp;in&nbsp;*;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;andDestruct.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;goal&nbsp;with<br/>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;<span class="inlinecode"><span class="id" title="var">Hmap</span></span> <span class="inlinecode">:</span> <span class="inlinecode">?<span class="id" title="var">f'</span></span> <span class="inlinecode">?<span class="id" title="var">b</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">Some</span></span> <span class="inlinecode">?<span class="id" title="var">a</span>,</span>
              <span class="inlinecode"><span class="id" title="var">Ha</span></span> <span class="inlinecode">:</span> <span class="inlinecode"><span class="id" title="keyword">forall</span></span> <span class="inlinecode"><span class="id" title="var">a'</span></span> <span class="inlinecode"><span class="id" title="var">b'</span>,</span> <span class="inlinecode">?<span class="id" title="var">f'</span></span> <span class="inlinecode"><span class="id" title="var">b'</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">Some</span></span> <span class="inlinecode"><span class="id" title="var">a'</span></span> <span class="inlinecode">-&gt;</span> <span class="inlinecode"><span class="id" title="var">_</span></span> <span class="inlinecode">|-</span> <span class="inlinecode"><span class="id" title="var">_</span></span> <span class="inlinecode"></span>&nbsp;=&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;apply&nbsp;Ha&nbsp;in&nbsp;Hmap<br/>
&nbsp;&nbsp;&nbsp;&nbsp;end.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;crush.<br/>
<br/>
&nbsp;&nbsp;-&nbsp;match&nbsp;goal&nbsp;with<br/>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;<span class="inlinecode">|-</span> <span class="inlinecode"><span class="id" title="var">None</span></span> <span class="inlinecode">=</span> <span class="inlinecode">?<span class="id" title="var">m</span></span> <span class="inlinecode">?<span class="id" title="var">b</span></span>&nbsp;=&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;destruct&nbsp;(partial_map_dec&nbsp;b&nbsp;m)&nbsp;as&nbsp;<span class="inlinecode"><span class="id" title="var">Hsome'</span>|<span class="id" title="var">Hnone'</span></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;auto<br/>
&nbsp;&nbsp;&nbsp;&nbsp;end.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;destruct_exists.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;goal&nbsp;with<br/>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;<span class="inlinecode"><span class="id" title="var">H</span></span> <span class="inlinecode">:</span> <span class="inlinecode">?<span class="id" title="var">m</span></span> <span class="inlinecode">?<span class="id" title="var">b</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">Some</span></span> <span class="inlinecode"><span class="id" title="var">_</span>,</span>
           <span class="inlinecode"><span class="id" title="var">Ha</span></span> <span class="inlinecode">:</span> <span class="inlinecode"><span class="id" title="keyword">forall</span></span> <span class="inlinecode"><span class="id" title="var">b'</span></span> <span class="inlinecode"><span class="id" title="var">c'</span>,</span> <span class="inlinecode">?<span class="id" title="var">m</span></span> <span class="inlinecode"><span class="id" title="var">b'</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">Some</span></span> <span class="inlinecode"><span class="id" title="var">c'</span></span> <span class="inlinecode">-&gt;</span> <span class="inlinecode"><span class="id" title="var">_</span></span> <span class="inlinecode">|-</span> <span class="inlinecode"><span class="id" title="var">_</span></span> <span class="inlinecode">=</span> <span class="inlinecode">?<span class="id" title="var">m</span></span> <span class="inlinecode">?<span class="id" title="var">b</span></span>&nbsp;=&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;apply&nbsp;Ha&nbsp;in&nbsp;H;&nbsp;destruct_exists<br/>
&nbsp;&nbsp;&nbsp;&nbsp;end.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;unfold&nbsp;inv&nbsp;in&nbsp;*;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;andDestruct.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;goal&nbsp;with<br/>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;<span class="inlinecode"><span class="id" title="var">H</span></span> <span class="inlinecode">:</span> <span class="inlinecode">?<span class="id" title="var">f</span></span> <span class="inlinecode">?<span class="id" title="var">a</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">Some</span></span> <span class="inlinecode">?<span class="id" title="var">b</span>,</span>
           <span class="inlinecode"><span class="id" title="var">Ha</span></span> <span class="inlinecode">:</span> <span class="inlinecode">?<span class="id" title="var">f'</span></span> <span class="inlinecode">?<span class="id" title="var">b</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">None</span>,</span>
           <span class="inlinecode"><span class="id" title="var">Hb</span></span> <span class="inlinecode">:</span> <span class="inlinecode"><span class="id" title="keyword">forall</span></span> <span class="inlinecode"><span class="id" title="var">a'</span></span> <span class="inlinecode"><span class="id" title="var">b'</span>,</span> <span class="inlinecode">?<span class="id" title="var">f</span></span> <span class="inlinecode"><span class="id" title="var">a'</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">Some</span></span> <span class="inlinecode"><span class="id" title="var">b'</span></span> <span class="inlinecode">-&gt;</span> <span class="inlinecode">?<span class="id" title="var">f'</span></span> <span class="inlinecode"><span class="id" title="var">b'</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">Some</span></span> <span class="inlinecode"><span class="id" title="var">a'</span></span> <span class="inlinecode">|-</span> <span class="inlinecode"><span class="id" title="var">_</span></span>&nbsp;=&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;apply&nbsp;Hb&nbsp;in&nbsp;H<br/>
&nbsp;&nbsp;&nbsp;&nbsp;end.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;crush.<br/>
Qed.*)</span><br/>

<br/>
<span class="comment">(*)Lemma&nbsp;compose_one_to_one_eq&nbsp;:<br/>
&nbsp;&nbsp;forall&nbsp;{A&nbsp;B&nbsp;C:&nbsp;Type}&nbsp;`{Eq&nbsp;A}`{Eq&nbsp;B}&nbsp;(f1&nbsp;f2&nbsp;:&nbsp;partial_map&nbsp;A&nbsp;B)&nbsp;(g&nbsp;:&nbsp;partial_map&nbsp;B&nbsp;C),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;one_to_one&nbsp;g&nbsp;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;maps_into&nbsp;f1&nbsp;g&nbsp;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;maps_into&nbsp;f2&nbsp;g&nbsp;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;f1&nbsp;∘&nbsp;g&nbsp;=&nbsp;f2&nbsp;∘&nbsp;g&nbsp;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;f1&nbsp;=&nbsp;f2.<br/>
Proof.<br/>
&nbsp;&nbsp;intros.<br/>
&nbsp;&nbsp;apply&nbsp;functional_extensionality;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;intros&nbsp;a.<br/>
<br/>
&nbsp;&nbsp;match&nbsp;goal&nbsp;with<br/>
&nbsp;&nbsp;|&nbsp;<span class="inlinecode"><span class="id" title="var">H</span></span> <span class="inlinecode">:</span> <span class="inlinecode">?<span class="id" title="var">m1</span></span> <span class="inlinecode">∘</span> <span class="inlinecode">?<span class="id" title="var">f</span></span> <span class="inlinecode">=</span> <span class="inlinecode">?<span class="id" title="var">m2</span></span> <span class="inlinecode">∘</span> <span class="inlinecode">?<span class="id" title="var">f</span></span> <span class="inlinecode">|-</span> <span class="inlinecode">?<span class="id" title="var">m1</span></span> <span class="inlinecode">?<span class="id" title="var">y</span></span> <span class="inlinecode">=</span> <span class="inlinecode">?<span class="id" title="var">m2</span></span> <span class="inlinecode">?<span class="id" title="var">y</span></span> <span class="inlinecode"></span>&nbsp;=&gt;&nbsp;apply&nbsp;equal_f&nbsp;with&nbsp;(x:=y)&nbsp;in&nbsp;H<br/>
&nbsp;&nbsp;end.<br/>
<br/>
&nbsp;&nbsp;match&nbsp;goal&nbsp;with<br/>
&nbsp;&nbsp;|&nbsp;<span class="inlinecode">|-</span> <span class="inlinecode">?<span class="id" title="var">n</span></span> <span class="inlinecode">=</span> <span class="inlinecode">?<span class="id" title="var">m</span></span>&nbsp;=&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;destruct&nbsp;(eq_dec&nbsp;n&nbsp;m);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;simpl&nbsp;in&nbsp;*;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;auto<br/>
&nbsp;&nbsp;end.<br/>
&nbsp;&nbsp;match&nbsp;goal&nbsp;with<br/>
&nbsp;&nbsp;|&nbsp;<span class="inlinecode"><span class="id" title="var">H</span></span> <span class="inlinecode">:</span> <span class="inlinecode"><span class="id" title="var">one_to_one</span></span> <span class="inlinecode">?<span class="id" title="var">g</span>,</span>
     <span class="inlinecode"><span class="id" title="var">Hneq</span></span> <span class="inlinecode">:</span> <span class="inlinecode">?<span class="id" title="var">f1</span></span> <span class="inlinecode">?<span class="id" title="var">a</span></span> <span class="inlinecode">&lt;&gt;</span> <span class="inlinecode">?<span class="id" title="var">f2</span></span> <span class="inlinecode">?<span class="id" title="var">a</span></span> <span class="inlinecode">|-</span> <span class="inlinecode">?<span class="id" title="var">f1</span></span> <span class="inlinecode">?<span class="id" title="var">a</span></span> <span class="inlinecode">=</span> <span class="inlinecode">?<span class="id" title="var">f2</span></span> <span class="inlinecode">?<span class="id" title="var">a</span></span>&nbsp;=&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;apply&nbsp;(one_to_one_bind_f_nequal&nbsp;g&nbsp;H&nbsp;(f1&nbsp;a)&nbsp;(f2&nbsp;a))&nbsp;in&nbsp;Hneq;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="inlinecode"><span class="id" title="tactic">destruct</span></span> <span class="inlinecode">(<span class="id" title="var">f1</span></span> <span class="inlinecode"><span class="id" title="var">a</span>);</span>
       <span class="inlinecode"><span class="id" title="tactic">destruct</span></span> <span class="inlinecode">(<span class="id" title="var">f2</span></span> <span class="inlinecode"><span class="id" title="var">a</span>);</span>
       <span class="inlinecode"><span class="id" title="tactic">simpl</span></span> <span class="inlinecode"><span class="id" title="tactic">in</span></span> <span class="inlinecode">*;</span>
       <span class="inlinecode"><span class="id" title="tactic">eauto</span></span> <span class="inlinecode"><span class="id" title="keyword">with</span></span> <span class="inlinecode"><span class="id" title="var">eq_db</span>|</span><br/>
&nbsp;&nbsp;end.<br/>
<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;destruct&nbsp;(partial_map_dec&nbsp;a&nbsp;f1)&nbsp;as&nbsp;<span class="inlinecode"><span class="id" title="var">Hsome1</span>|<span class="id" title="var">Hnone1</span></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="inlinecode"><span class="id" title="var">destruct_exists</span>|<span class="id" title="tactic">rewrite</span></span> <span class="inlinecode"><span class="id" title="var">Hnone1</span></span> <span class="inlinecode"><span class="id" title="tactic">in</span></span> <span class="inlinecode">*</span>.<br/>
&nbsp;&nbsp;-&nbsp;match&nbsp;goal&nbsp;with<br/>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;<span class="inlinecode"><span class="id" title="var">H</span></span> <span class="inlinecode">:</span> <span class="inlinecode">?<span class="id" title="var">f</span></span> <span class="inlinecode">?<span class="id" title="var">a</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">Some</span></span> <span class="inlinecode">?<span class="id" title="var">x</span></span> <span class="inlinecode">|-<span class="id" title="var">_</span></span>&nbsp;=&gt;&nbsp;rewrite&nbsp;H&nbsp;in&nbsp;*;&nbsp;simpl&nbsp;in&nbsp;*<br/>
&nbsp;&nbsp;&nbsp;&nbsp;end.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;destruct&nbsp;(partial_map_dec&nbsp;a&nbsp;f2)&nbsp;as&nbsp;<span class="inlinecode"><span class="id" title="var">Hsome2</span>|<span class="id" title="var">Hnone2</span></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="inlinecode"><span class="id" title="var">destruct_exists</span>|<span class="id" title="tactic">eauto</span></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;match&nbsp;goal&nbsp;with<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;<span class="inlinecode"><span class="id" title="var">H</span></span> <span class="inlinecode">:</span> <span class="inlinecode">?<span class="id" title="var">f</span></span> <span class="inlinecode">?<span class="id" title="var">a</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">Some</span></span> <span class="inlinecode">?<span class="id" title="var">x</span></span> <span class="inlinecode">|-<span class="id" title="var">_</span></span>&nbsp;=&gt;&nbsp;rewrite&nbsp;H&nbsp;in&nbsp;*;&nbsp;simpl&nbsp;in&nbsp;*<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;repeat&nbsp;maps_into_from_auto.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;goal&nbsp;with<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;<span class="inlinecode"><span class="id" title="var">H</span></span> <span class="inlinecode">:</span> <span class="inlinecode">?<span class="id" title="var">g</span></span> <span class="inlinecode"><span class="id" title="var">_</span></span> <span class="inlinecode">=</span> <span class="inlinecode">?<span class="id" title="var">g</span></span> <span class="inlinecode"><span class="id" title="var">_</span></span> <span class="inlinecode">|-</span> <span class="inlinecode"><span class="id" title="var">_</span></span>&nbsp;=&gt;&nbsp;rewrite&nbsp;H&nbsp;in&nbsp;*<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;goal&nbsp;with<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;<span class="inlinecode"><span class="id" title="var">H</span></span> <span class="inlinecode">:</span> <span class="inlinecode">?<span class="id" title="var">g</span></span> <span class="inlinecode"><span class="id" title="var">_</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">Some</span></span> <span class="inlinecode"><span class="id" title="var">_</span></span> <span class="inlinecode">|-</span> <span class="inlinecode"><span class="id" title="var">_</span></span>&nbsp;=&gt;&nbsp;rewrite&nbsp;H&nbsp;in&nbsp;*<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;one_to_one_auto.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;crush.<br/>
<br/>
&nbsp;&nbsp;-&nbsp;assert&nbsp;(Hneq&nbsp;:&nbsp;f2&nbsp;a&nbsp;&lt;&gt;&nbsp;None);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="inlinecode"><span class="id" title="var">crush</span></span>
      <span class="inlinecode">|<span class="id" title="tactic">apply</span></span> <span class="inlinecode"><span class="id" title="var">not_none_implies_some</span></span> <span class="inlinecode"><span class="id" title="tactic">in</span></span> <span class="inlinecode"><span class="id" title="var">Hneq</span>;</span>
       <span class="inlinecode"><span class="id" title="var">destruct_exists</span></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;repeat&nbsp;maps_into_from_auto.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;crush;&nbsp;eexists;&nbsp;eauto.<br/>
Qed.*)</span><br/>

<br/>
<span class="comment">(*)Lemma&nbsp;compose_one_to_one&nbsp;:<br/>
&nbsp;&nbsp;forall&nbsp;{A&nbsp;B&nbsp;C&nbsp;:&nbsp;Type}`{Eq&nbsp;A}`{Eq&nbsp;B}&nbsp;(f&nbsp;:&nbsp;partial_map&nbsp;A&nbsp;B)(g&nbsp;:&nbsp;partial_map&nbsp;B&nbsp;C),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;one_to_one&nbsp;f&nbsp;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;one_to_one&nbsp;g&nbsp;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;one_to_one&nbsp;(f&nbsp;∘&nbsp;g).<br/>
Proof.<br/>
&nbsp;&nbsp;intros;&nbsp;unfold&nbsp;one_to_one;&nbsp;intros.<br/>
&nbsp;&nbsp;unfold&nbsp;bind&nbsp;in&nbsp;*;&nbsp;simpl&nbsp;in&nbsp;*.<br/>
&nbsp;&nbsp;destruct&nbsp;(partial_map_dec&nbsp;a1&nbsp;f)&nbsp;as&nbsp;<span class="inlinecode"><span class="id" title="var">Hsome1</span>|<span class="id" title="var">Hnone1</span></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;destruct&nbsp;(partial_map_dec&nbsp;a2&nbsp;f)&nbsp;as&nbsp;<span class="inlinecode"><span class="id" title="var">Hsome2</span>|<span class="id" title="var">Hnone2</span></span>;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;rewrite&nbsp;Hnone1&nbsp;in&nbsp;*;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;rewrite&nbsp;Hnone2&nbsp;in&nbsp;*;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;repeat&nbsp;destruct_exists;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;match&nbsp;goal&nbsp;with<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;<span class="inlinecode"><span class="id" title="var">H</span></span> <span class="inlinecode">:</span> <span class="inlinecode"><span class="id" title="var">None</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">Some</span></span> <span class="inlinecode"><span class="id" title="var">_</span></span> <span class="inlinecode">|-</span> <span class="inlinecode"><span class="id" title="var">_</span></span>&nbsp;=&gt;&nbsp;inversion&nbsp;H<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end.<br/>
<br/>
&nbsp;&nbsp;-&nbsp;repeat&nbsp;match&nbsp;goal&nbsp;with<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;<span class="inlinecode"><span class="id" title="var">H</span></span> <span class="inlinecode">:</span> <span class="inlinecode">?<span class="id" title="var">f</span></span> <span class="inlinecode">?<span class="id" title="var">a</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">Some</span></span> <span class="inlinecode"><span class="id" title="var">_</span></span> <span class="inlinecode">|-</span> <span class="inlinecode"><span class="id" title="var">_</span></span>&nbsp;=&gt;&nbsp;rewrite&nbsp;H&nbsp;in&nbsp;*<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;repeat&nbsp;one_to_one_auto;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;auto.<br/>
Qed.*)</span><br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="extend_some_1"><span class="id" title="lemma">extend_some_1</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>}`{<a class="idref" href="chainmail.common.html#Eq"><span class="id" title="class">Eq</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a>}(<span class="id" title="var">f</span> <span class="id" title="var">g</span> : <a class="idref" href="chainmail.common.html#partial_map"><span class="id" title="definition">partial_map</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a> <a class="idref" href="chainmail.partial_maps.html#B"><span class="id" title="variable">B</span></a>) <span class="id" title="var">a</span> <span class="id" title="var">b</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chainmail.partial_maps.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="chainmail.partial_maps.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="chainmail.partial_maps.html#b"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="chainmail.partial_maps.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="chainmail.common.html#ee7d96fc379cbf67726a95b71cdead1d"><span class="id" title="notation">∪</span></a> <a class="idref" href="chainmail.partial_maps.html#g"><span class="id" title="variable">g</span></a>) <a class="idref" href="chainmail.partial_maps.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="chainmail.partial_maps.html#b"><span class="id" title="variable">b</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>; <span class="id" title="tactic">unfold</span> <a class="idref" href="chainmail.common.html#extend"><span class="id" title="definition">extend</span></a>; <span class="id" title="var">crush</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="extend_application"><span class="id" title="lemma">extend_application</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>}`{<a class="idref" href="chainmail.common.html#Eq"><span class="id" title="class">Eq</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a>}(<span class="id" title="var">f</span> <span class="id" title="var">g</span> : <a class="idref" href="chainmail.common.html#partial_map"><span class="id" title="definition">partial_map</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a> <a class="idref" href="chainmail.partial_maps.html#B"><span class="id" title="variable">B</span></a>) <span class="id" title="var">a</span> <span class="id" title="var">b</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="chainmail.partial_maps.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="chainmail.common.html#ee7d96fc379cbf67726a95b71cdead1d"><span class="id" title="notation">∪</span></a> <a class="idref" href="chainmail.partial_maps.html#g"><span class="id" title="variable">g</span></a>) <a class="idref" href="chainmail.partial_maps.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="chainmail.partial_maps.html#b"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chainmail.partial_maps.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="chainmail.partial_maps.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="chainmail.partial_maps.html#b"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25"><span class="id" title="notation">\/</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25"><span class="id" title="notation">(</span></a><a class="idref" href="chainmail.partial_maps.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="chainmail.partial_maps.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="chainmail.partial_maps.html#g"><span class="id" title="variable">g</span></a> <a class="idref" href="chainmail.partial_maps.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="chainmail.partial_maps.html#b"><span class="id" title="variable">b</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="chainmail.common.html#extend"><span class="id" title="definition">extend</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">f</span> <span class="id" title="var">a</span>); <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="comment">(*&nbsp;TODO&nbsp;:&nbsp;need&nbsp;to&nbsp;figure&nbsp;this&nbsp;out&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;specialize&nbsp;universal&nbsp;quantification&nbsp;for&nbsp;all&nbsp;possible&nbsp;terms&nbsp;*)</span><br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">broken</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| [<span class="id" title="var">H</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">_</span> : ?<span class="id" title="var">A</span>), <span class="id" title="var">_</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">a</span> : ?<span class="id" title="var">A</span> |- <span class="id" title="var">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">notHyp</span> (<span class="id" title="var">H</span> <span class="id" title="var">a</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">H'</span> := <span class="id" title="tactic">fresh</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">H'</span> := <span class="id" title="var">H</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">H</span> <span class="id" title="var">a</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="disjoint_dom_symmetry"><span class="id" title="lemma">disjoint_dom_symmetry</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> : <span class="id" title="keyword">Type</span>}`{<a class="idref" href="chainmail.common.html#Eq"><span class="id" title="class">Eq</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a>}(<span class="id" title="var">f</span> : <a class="idref" href="chainmail.common.html#partial_map"><span class="id" title="definition">partial_map</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a> <a class="idref" href="chainmail.partial_maps.html#B"><span class="id" title="variable">B</span></a>)(<span class="id" title="var">g</span> : <a class="idref" href="chainmail.common.html#partial_map"><span class="id" title="definition">partial_map</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a> <a class="idref" href="chainmail.partial_maps.html#C"><span class="id" title="variable">C</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chainmail.common.html#disjoint_dom"><span class="id" title="definition">disjoint_dom</span></a> <a class="idref" href="chainmail.partial_maps.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="chainmail.partial_maps.html#g"><span class="id" title="variable">g</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chainmail.common.html#disjoint_dom"><span class="id" title="definition">disjoint_dom</span></a> <a class="idref" href="chainmail.partial_maps.html#g"><span class="id" title="variable">g</span></a> <a class="idref" href="chainmail.partial_maps.html#f"><span class="id" title="variable">f</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="chainmail.common.html#disjoint_dom"><span class="id" title="definition">disjoint_dom</span></a> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="chainmail.partial_maps.html#not_some_implies_none"><span class="id" title="lemma">not_some_implies_none</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">b'</span> <span class="id" title="var">Hcontra</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">H0</span> <span class="id" title="var">a</span> <span class="id" title="var">b'</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">auto_specialize</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">crush</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">disjoint_dom_symmetry</span> : <span class="id" title="var">map_db</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">disjoint_dom_sym_auto</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| [<span class="id" title="var">H</span> : <a class="idref" href="chainmail.common.html#disjoint_dom"><span class="id" title="definition">disjoint_dom</span></a> ?<span class="id" title="var">f</span> ?<span class="id" title="var">g</span> |- <span class="id" title="var">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">notHyp</span> (<a class="idref" href="chainmail.common.html#disjoint_dom"><span class="id" title="definition">disjoint_dom</span></a> <span class="id" title="var">g</span> <span class="id" title="var">f</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="chainmail.common.html#disjoint_dom"><span class="id" title="definition">disjoint_dom</span></a> <span class="id" title="var">g</span> <span class="id" title="var">f</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="tactic">apply</span> <a class="idref" href="chainmail.partial_maps.html#disjoint_dom_symmetry"><span class="id" title="lemma">disjoint_dom_symmetry</span></a>; <span class="id" title="tactic">auto</span>|]<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="extend_some_2"><span class="id" title="lemma">extend_some_2</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>}`{<a class="idref" href="chainmail.common.html#Eq"><span class="id" title="class">Eq</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a>}(<span class="id" title="var">f</span> <span class="id" title="var">g</span> : <a class="idref" href="chainmail.common.html#partial_map"><span class="id" title="definition">partial_map</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a> <a class="idref" href="chainmail.partial_maps.html#B"><span class="id" title="variable">B</span></a>) <span class="id" title="var">a</span> <span class="id" title="var">b</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chainmail.partial_maps.html#g"><span class="id" title="variable">g</span></a> <a class="idref" href="chainmail.partial_maps.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="chainmail.partial_maps.html#b"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chainmail.common.html#disjoint_dom"><span class="id" title="definition">disjoint_dom</span></a> <a class="idref" href="chainmail.partial_maps.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="chainmail.partial_maps.html#g"><span class="id" title="variable">g</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="chainmail.partial_maps.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="chainmail.common.html#ee7d96fc379cbf67726a95b71cdead1d"><span class="id" title="notation">∪</span></a> <a class="idref" href="chainmail.partial_maps.html#g"><span class="id" title="variable">g</span></a>) <a class="idref" href="chainmail.partial_maps.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="chainmail.partial_maps.html#b"><span class="id" title="variable">b</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>; <span class="id" title="tactic">unfold</span> <a class="idref" href="chainmail.common.html#extend"><span class="id" title="definition">extend</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">disjoint_dom_sym_auto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="chainmail.common.html#disjoint_dom"><span class="id" title="definition">disjoint_dom</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| [<span class="id" title="var">Ha</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>, ?<span class="id" title="var">g</span> <a class="idref" href="chainmail.partial_maps.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="chainmail.partial_maps.html#b"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> ?<span class="id" title="var">f</span> <a class="idref" href="chainmail.partial_maps.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Hb</span> : ?<span class="id" title="var">g</span> ?<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> ?<span class="id" title="var">b</span> |- <span class="id" title="keyword">context</span>[?<span class="id" title="var">f</span> ?<span class="id" title="var">a</span>]] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">Ha</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="extend_into"><span class="id" title="lemma">extend_into</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> : <span class="id" title="keyword">Type</span>}`{<a class="idref" href="chainmail.common.html#Eq"><span class="id" title="class">Eq</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a>}`{<a class="idref" href="chainmail.common.html#Eq"><span class="id" title="class">Eq</span></a> <a class="idref" href="chainmail.partial_maps.html#B"><span class="id" title="variable">B</span></a>}(<span class="id" title="var">f</span> <span class="id" title="var">g</span> : <a class="idref" href="chainmail.common.html#partial_map"><span class="id" title="definition">partial_map</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a> <a class="idref" href="chainmail.partial_maps.html#B"><span class="id" title="variable">B</span></a>)(<span class="id" title="var">h</span> : <a class="idref" href="chainmail.common.html#partial_map"><span class="id" title="definition">partial_map</span></a> <a class="idref" href="chainmail.partial_maps.html#B"><span class="id" title="variable">B</span></a> <a class="idref" href="chainmail.partial_maps.html#C"><span class="id" title="variable">C</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chainmail.common.html#maps_into"><span class="id" title="definition">maps_into</span></a> (<a class="idref" href="chainmail.partial_maps.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="chainmail.common.html#ee7d96fc379cbf67726a95b71cdead1d"><span class="id" title="notation">∪</span></a> <a class="idref" href="chainmail.partial_maps.html#g"><span class="id" title="variable">g</span></a>) <a class="idref" href="chainmail.partial_maps.html#h"><span class="id" title="variable">h</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chainmail.common.html#maps_into"><span class="id" title="definition">maps_into</span></a> <a class="idref" href="chainmail.partial_maps.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="chainmail.partial_maps.html#h"><span class="id" title="variable">h</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="chainmail.common.html#maps_into"><span class="id" title="definition">maps_into</span></a> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| [<span class="id" title="var">H</span> : ?<span class="id" title="var">f</span> ?<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> ?<span class="id" title="var">b</span> |- <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">eapply</span> <a class="idref" href="chainmail.partial_maps.html#extend_some_1"><span class="id" title="lemma">extend_some_1</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">eauto</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">extend_into</span> : <span class="id" title="var">map_db</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="extend_into_disjoint"><span class="id" title="lemma">extend_into_disjoint</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> : <span class="id" title="keyword">Type</span>}`{<a class="idref" href="chainmail.common.html#Eq"><span class="id" title="class">Eq</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a>}`{<a class="idref" href="chainmail.common.html#Eq"><span class="id" title="class">Eq</span></a> <a class="idref" href="chainmail.partial_maps.html#B"><span class="id" title="variable">B</span></a>}(<span class="id" title="var">f</span> <span class="id" title="var">g</span> : <a class="idref" href="chainmail.common.html#partial_map"><span class="id" title="definition">partial_map</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a> <a class="idref" href="chainmail.partial_maps.html#B"><span class="id" title="variable">B</span></a>)(<span class="id" title="var">h</span> : <a class="idref" href="chainmail.common.html#partial_map"><span class="id" title="definition">partial_map</span></a> <a class="idref" href="chainmail.partial_maps.html#B"><span class="id" title="variable">B</span></a> <a class="idref" href="chainmail.partial_maps.html#C"><span class="id" title="variable">C</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chainmail.common.html#maps_into"><span class="id" title="definition">maps_into</span></a> (<a class="idref" href="chainmail.partial_maps.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="chainmail.common.html#ee7d96fc379cbf67726a95b71cdead1d"><span class="id" title="notation">∪</span></a> <a class="idref" href="chainmail.partial_maps.html#g"><span class="id" title="variable">g</span></a>) <a class="idref" href="chainmail.partial_maps.html#h"><span class="id" title="variable">h</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chainmail.common.html#disjoint_dom"><span class="id" title="definition">disjoint_dom</span></a> <a class="idref" href="chainmail.partial_maps.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="chainmail.partial_maps.html#g"><span class="id" title="variable">g</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chainmail.common.html#maps_into"><span class="id" title="definition">maps_into</span></a> <a class="idref" href="chainmail.partial_maps.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="chainmail.partial_maps.html#h"><span class="id" title="variable">h</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="chainmail.common.html#maps_into"><span class="id" title="definition">maps_into</span></a> <a class="idref" href="chainmail.partial_maps.html#g"><span class="id" title="variable">g</span></a> <a class="idref" href="chainmail.partial_maps.html#h"><span class="id" title="variable">h</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>; <span class="id" title="tactic">split</span>; <span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">map_db</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">disjoint_dom_sym_auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="chainmail.common.html#maps_into"><span class="id" title="definition">maps_into</span></a> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="chainmail.common.html#disjoint_dom"><span class="id" title="definition">disjoint_dom</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| [<span class="id" title="var">Ha</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a'</span> <span class="id" title="var">b'</span>, <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <span class="id" title="var">c'</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> ?<span class="id" title="var">h</span> <a class="idref" href="chainmail.partial_maps.html#b'"><span class="id" title="variable">b'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="chainmail.partial_maps.html#c'"><span class="id" title="variable">c'</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Hb</span> : ?<span class="id" title="var">g</span> ?<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> ?<span class="id" title="var">b</span> |- <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <span class="id" title="var">c</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> ?<span class="id" title="var">h</span> ?<span class="id" title="var">b</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="chainmail.partial_maps.html#c"><span class="id" title="variable">c</span></a>] =&gt; <span class="id" title="tactic">eapply</span> (<span class="id" title="var">Ha</span> <span class="id" title="var">a</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="chainmail.partial_maps.html#extend_some_2"><span class="id" title="lemma">extend_some_2</span></a>; <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">map_db</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="into_extend"><span class="id" title="lemma">into_extend</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> : <span class="id" title="keyword">Type</span>}`{<a class="idref" href="chainmail.common.html#Eq"><span class="id" title="class">Eq</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a>}`{<a class="idref" href="chainmail.common.html#Eq"><span class="id" title="class">Eq</span></a> <a class="idref" href="chainmail.partial_maps.html#B"><span class="id" title="variable">B</span></a>}(<span class="id" title="var">f</span> <span class="id" title="var">g</span> : <a class="idref" href="chainmail.common.html#partial_map"><span class="id" title="definition">partial_map</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a> <a class="idref" href="chainmail.partial_maps.html#B"><span class="id" title="variable">B</span></a>)(<span class="id" title="var">h</span> : <a class="idref" href="chainmail.common.html#partial_map"><span class="id" title="definition">partial_map</span></a> <a class="idref" href="chainmail.partial_maps.html#B"><span class="id" title="variable">B</span></a> <a class="idref" href="chainmail.partial_maps.html#C"><span class="id" title="variable">C</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chainmail.common.html#maps_into"><span class="id" title="definition">maps_into</span></a> <a class="idref" href="chainmail.partial_maps.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="chainmail.partial_maps.html#h"><span class="id" title="variable">h</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chainmail.common.html#maps_into"><span class="id" title="definition">maps_into</span></a> <a class="idref" href="chainmail.partial_maps.html#g"><span class="id" title="variable">g</span></a> <a class="idref" href="chainmail.partial_maps.html#h"><span class="id" title="variable">h</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chainmail.common.html#maps_into"><span class="id" title="definition">maps_into</span></a> (<a class="idref" href="chainmail.partial_maps.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="chainmail.common.html#ee7d96fc379cbf67726a95b71cdead1d"><span class="id" title="notation">∪</span></a> <a class="idref" href="chainmail.partial_maps.html#g"><span class="id" title="variable">g</span></a>) <a class="idref" href="chainmail.partial_maps.html#h"><span class="id" title="variable">h</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="chainmail.common.html#maps_into"><span class="id" title="definition">maps_into</span></a> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="chainmail.partial_maps.html#extend_application"><span class="id" title="lemma">extend_application</span></a> <span class="id" title="var">f</span> <span class="id" title="var">g</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>); <span class="id" title="tactic">auto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[|<span class="id" title="var">andDestruct</span>]; <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">maps_into_ext_decompose</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| [<span class="id" title="var">Ha</span> : <a class="idref" href="chainmail.common.html#maps_into"><span class="id" title="definition">maps_into</span></a> (?<span class="id" title="var">f</span> <a class="idref" href="chainmail.common.html#ee7d96fc379cbf67726a95b71cdead1d"><span class="id" title="notation">∪</span></a> ?<span class="id" title="var">g</span>) ?<span class="id" title="var">h</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Hb</span> : <a class="idref" href="chainmail.common.html#disjoint_dom"><span class="id" title="definition">disjoint_dom</span></a> ?<span class="id" title="var">f</span> ?<span class="id" title="var">g</span> |- <span class="id" title="var">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="chainmail.common.html#maps_into"><span class="id" title="definition">maps_into</span></a> <span class="id" title="var">f</span> <span class="id" title="var">h</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="chainmail.common.html#maps_into"><span class="id" title="definition">maps_into</span></a> <span class="id" title="var">g</span> <span class="id" title="var">h</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="tactic">eapply</span> <a class="idref" href="chainmail.partial_maps.html#extend_into_disjoint"><span class="id" title="lemma">extend_into_disjoint</span></a>; <span class="id" title="tactic">eauto</span>|]<br/>
&nbsp;&nbsp;| [<span class="id" title="var">H</span> : <a class="idref" href="chainmail.common.html#maps_into"><span class="id" title="definition">maps_into</span></a> (?<span class="id" title="var">f</span> <a class="idref" href="chainmail.common.html#ee7d96fc379cbf67726a95b71cdead1d"><span class="id" title="notation">∪</span></a> ?<span class="id" title="var">g</span>) ?<span class="id" title="var">h</span> |- <span class="id" title="var">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="chainmail.common.html#maps_into"><span class="id" title="definition">maps_into</span></a> <span class="id" title="var">f</span> <span class="id" title="var">h</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="tactic">eapply</span> <a class="idref" href="chainmail.partial_maps.html#extend_into"><span class="id" title="lemma">extend_into</span></a>; <span class="id" title="tactic">eauto</span>|]<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="comment">(*)Lemma&nbsp;extend_compose_distr&nbsp;:<br/>
&nbsp;&nbsp;forall&nbsp;{A&nbsp;B&nbsp;C&nbsp;:&nbsp;Type}`{Eq&nbsp;A}`{Eq&nbsp;B}(f&nbsp;g&nbsp;:&nbsp;partial_map&nbsp;A&nbsp;B)(h&nbsp;:&nbsp;partial_map&nbsp;B&nbsp;C),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;maps_into&nbsp;(f&nbsp;∪&nbsp;g)&nbsp;h&nbsp;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(f&nbsp;∪&nbsp;g)&nbsp;∘&nbsp;h&nbsp;=&nbsp;(f&nbsp;∘&nbsp;h)&nbsp;∪&nbsp;(g&nbsp;∘&nbsp;h).<br/>
Proof.<br/>
&nbsp;&nbsp;intros;&nbsp;maps_into_ext_decompose.<br/>
&nbsp;&nbsp;apply&nbsp;functional_extensionality;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;intros&nbsp;a.<br/>
&nbsp;&nbsp;simpl.<br/>
&nbsp;&nbsp;unfold&nbsp;extend.<br/>
&nbsp;&nbsp;destruct&nbsp;(partial_map_dec&nbsp;a&nbsp;f)&nbsp;as&nbsp;<span class="inlinecode">|<span class="id" title="var">Hnone</span></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="inlinecode"><span class="id" title="var">destruct_exists</span>|<span class="id" title="tactic">rewrite</span></span> <span class="inlinecode"><span class="id" title="var">Hnone</span>;</span> <span class="inlinecode"><span class="id" title="tactic">auto</span></span>.<br/>
&nbsp;&nbsp;maps_into_from_auto.<br/>
&nbsp;&nbsp;crush.<br/>
Qed.*)</span><br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="empty_maps_into"><span class="id" title="lemma">empty_maps_into</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> : <span class="id" title="keyword">Type</span>}{<span class="id" title="var">HeqA</span> : <a class="idref" href="chainmail.common.html#Eq"><span class="id" title="class">Eq</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a>}{<span class="id" title="var">HeqB</span> : <a class="idref" href="chainmail.common.html#Eq"><span class="id" title="class">Eq</span></a> <a class="idref" href="chainmail.partial_maps.html#B"><span class="id" title="variable">B</span></a>} (<span class="id" title="var">f</span> : <a class="idref" href="chainmail.common.html#partial_map"><span class="id" title="definition">partial_map</span></a> <a class="idref" href="chainmail.partial_maps.html#B"><span class="id" title="variable">B</span></a> <a class="idref" href="chainmail.partial_maps.html#C"><span class="id" title="variable">C</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chainmail.common.html#maps_into"><span class="id" title="definition">maps_into</span></a> (@<a class="idref" href="chainmail.common.html#empty"><span class="id" title="definition">empty</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a> <a class="idref" href="chainmail.partial_maps.html#B"><span class="id" title="variable">B</span></a> <a class="idref" href="chainmail.partial_maps.html#HeqA"><span class="id" title="variable">HeqA</span></a>) <a class="idref" href="chainmail.partial_maps.html#f"><span class="id" title="variable">f</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="chainmail.common.html#maps_into"><span class="id" title="definition">maps_into</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="var">map_rewrite</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">crush</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">empty_maps_into</span> : <span class="id" title="var">map_db</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="empty_maps_from"><span class="id" title="lemma">empty_maps_from</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> : <span class="id" title="keyword">Type</span>}`{<a class="idref" href="chainmail.common.html#Eq"><span class="id" title="class">Eq</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a>}{<span class="id" title="var">HeqB</span> : <a class="idref" href="chainmail.common.html#Eq"><span class="id" title="class">Eq</span></a> <a class="idref" href="chainmail.partial_maps.html#B"><span class="id" title="variable">B</span></a>} (<span class="id" title="var">f</span> : <a class="idref" href="chainmail.common.html#partial_map"><span class="id" title="definition">partial_map</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a> <a class="idref" href="chainmail.partial_maps.html#B"><span class="id" title="variable">B</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chainmail.common.html#maps_from"><span class="id" title="definition">maps_from</span></a> (@<a class="idref" href="chainmail.common.html#empty"><span class="id" title="definition">empty</span></a> <a class="idref" href="chainmail.partial_maps.html#B"><span class="id" title="variable">B</span></a> <a class="idref" href="chainmail.partial_maps.html#C"><span class="id" title="variable">C</span></a> <a class="idref" href="chainmail.partial_maps.html#HeqB"><span class="id" title="variable">HeqB</span></a>) <a class="idref" href="chainmail.partial_maps.html#f"><span class="id" title="variable">f</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="chainmail.common.html#maps_from"><span class="id" title="definition">maps_from</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="var">map_rewrite</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">crush</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">empty_maps_from</span> : <span class="id" title="var">map_db</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="empty_onto_empty"><span class="id" title="lemma">empty_onto_empty</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> : <span class="id" title="keyword">Type</span>}{<span class="id" title="var">HeqA</span> : <a class="idref" href="chainmail.common.html#Eq"><span class="id" title="class">Eq</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a>}{<span class="id" title="var">HeqB</span> : <a class="idref" href="chainmail.common.html#Eq"><span class="id" title="class">Eq</span></a> <a class="idref" href="chainmail.partial_maps.html#B"><span class="id" title="variable">B</span></a>},<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chainmail.common.html#onto"><span class="id" title="definition">onto</span></a> (@<a class="idref" href="chainmail.common.html#empty"><span class="id" title="definition">empty</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a> <a class="idref" href="chainmail.partial_maps.html#B"><span class="id" title="variable">B</span></a> <a class="idref" href="chainmail.partial_maps.html#HeqA"><span class="id" title="variable">HeqA</span></a>) (@<a class="idref" href="chainmail.common.html#empty"><span class="id" title="definition">empty</span></a> <a class="idref" href="chainmail.partial_maps.html#B"><span class="id" title="variable">B</span></a> <a class="idref" href="chainmail.partial_maps.html#C"><span class="id" title="variable">C</span></a> <a class="idref" href="chainmail.partial_maps.html#HeqB"><span class="id" title="variable">HeqB</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">map_db</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">empty_onto_empty</span> : <span class="id" title="var">map_db</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Disjointedness&nbsp;*)</span><br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="empty_disjoint_1"><span class="id" title="lemma">empty_disjoint_1</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> : <span class="id" title="keyword">Type</span>}{<span class="id" title="var">HeqA</span> : <a class="idref" href="chainmail.common.html#Eq"><span class="id" title="class">Eq</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a>}(<span class="id" title="var">f</span> : <a class="idref" href="chainmail.common.html#partial_map"><span class="id" title="definition">partial_map</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a> <a class="idref" href="chainmail.partial_maps.html#B"><span class="id" title="variable">B</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chainmail.common.html#disjoint_dom"><span class="id" title="definition">disjoint_dom</span></a> <a class="idref" href="chainmail.partial_maps.html#f"><span class="id" title="variable">f</span></a> (@<a class="idref" href="chainmail.common.html#empty"><span class="id" title="definition">empty</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a> <a class="idref" href="chainmail.partial_maps.html#C"><span class="id" title="variable">C</span></a> <a class="idref" href="chainmail.partial_maps.html#HeqA"><span class="id" title="variable">HeqA</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="chainmail.common.html#disjoint_dom"><span class="id" title="definition">disjoint_dom</span></a>; <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">empty_disjoint_1</span> : <span class="id" title="var">map_db</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="empty_disjoint_2"><span class="id" title="lemma">empty_disjoint_2</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> : <span class="id" title="keyword">Type</span>}{<span class="id" title="var">HeqA</span> : <a class="idref" href="chainmail.common.html#Eq"><span class="id" title="class">Eq</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a>}(<span class="id" title="var">f</span> : <a class="idref" href="chainmail.common.html#partial_map"><span class="id" title="definition">partial_map</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a> <a class="idref" href="chainmail.partial_maps.html#B"><span class="id" title="variable">B</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chainmail.common.html#disjoint_dom"><span class="id" title="definition">disjoint_dom</span></a> (@<a class="idref" href="chainmail.common.html#empty"><span class="id" title="definition">empty</span></a> <a class="idref" href="chainmail.partial_maps.html#A"><span class="id" title="variable">A</span></a> <a class="idref" href="chainmail.partial_maps.html#C"><span class="id" title="variable">C</span></a> <a class="idref" href="chainmail.partial_maps.html#HeqA"><span class="id" title="variable">HeqA</span></a>) <a class="idref" href="chainmail.partial_maps.html#f"><span class="id" title="variable">f</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">eapply</span> <a class="idref" href="chainmail.partial_maps.html#disjoint_dom_symmetry"><span class="id" title="lemma">disjoint_dom_symmetry</span></a>; <span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">map_db</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">empty_disjoint_2</span> : <span class="id" title="var">map_db</span>.<br/>
</div>
</div>
<div id="footer">
  Generated by <a href="http://coq.inria.fr/">coqdoc</a> and improved with <a href="https://github.com/tebbi/coqdocjs">CoqdocJS</a>
</div>
</div>
</body>

</html>
