
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module classical_properties</title>
<meta name="description" content="Documentation of Coq module classical_properties" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module classical_properties</h1>
<div class="coq">
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">common</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">loo_def</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">chainmail</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">fundamental_properties</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">function_operations</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">sbst</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">List</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">String</span>.<br/>
<span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">string_scope</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">CpdtTactics</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Coq.Logic.FunctionalExtensionality</span>.<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id">prop_and_if_sat_and</span> :<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">M1</span> <span class="id">M2</span> σ <span class="id">A1</span> <span class="id">A2</span>, <span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ ⊨ (<span class="id">a_and</span> <span class="id">A1</span> <span class="id">A2</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ ⊨ <span class="id">A1</span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ ⊨ <span class="id">A2</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof234')">Proof.</div>
<div class="proofscript" id="proof234">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">M1</span> <span class="id">M2</span> σ <span class="id">A1</span> <span class="id">A2</span> <span class="id">Hsat</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hsat</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id">prop_or_if_nsat_and</span> :<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">M1</span> <span class="id">M2</span> σ <span class="id">A1</span> <span class="id">A2</span>, <span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ ⊭ (<span class="id">a_and</span> <span class="id">A1</span> <span class="id">A2</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ ⊭ <span class="id">A1</span> \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ ⊭ <span class="id">A2</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof235')">Proof.</div>
<div class="proofscript" id="proof235">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">M1</span> <span class="id">M2</span> σ <span class="id">A1</span> <span class="id">A2</span> <span class="id">Hnsat</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hnsat</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Lemma 5: Classical (4) </div>
<div class="doc">This is yet to be proven. </div>
<span class="kwd">Theorem</span> <span class="id">sat_implies_not_nsat_mutind</span> :<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">M1</span> <span class="id">M2</span> σ <span class="id">A</span>, <span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ ⊨ <span class="id">A</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~ <span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ ⊭ <span class="id">A</span>) /\<br/>
<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">M1</span> <span class="id">M2</span> σ <span class="id">A</span>, <span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ ⊭ <span class="id">A</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~ <span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ ⊨ <span class="id">A</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof236')">Proof.</div>
<div class="proofscript" id="proof236">
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">sat_mutind</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">Hcontra</span>.<br/>
<br/>
<div class="doc">Case 1: sat_exp </div>
&nbsp;&nbsp;<span class="tactic">try</span> <span class="id">solve</span> [<span class="tactic">inversion</span> <span class="id">Hcontra</span>; <span class="id">crush</span>].<br/>
<br/>
<div class="doc">Case 2: sat_eq</div>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hcontra</span>; <span class="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eval_rewrite</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">crush</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
<br/>
<div class="doc">Case 3: sat_class </div>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hcontra</span>; <span class="tactic">subst</span>; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">eval_rewrite</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">crush</span>|<span class="id">crush</span>; <span class="tactic">eauto</span>].<br/>
<br/>
<div class="doc">Case 4: sat_set </div>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hcontra</span>; <span class="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">interpretation_rewrite</span>;  <span class="id">crush</span>; <span class="tactic">eauto</span>.<br/>
<br/>
<div class="doc">Case 5: sat_and </div>
&nbsp;&nbsp;<span class="tactic">try</span> <span class="id">solve</span> [<span class="tactic">inversion</span> <span class="id">Hcontra</span>; <span class="id">crush</span>].<br/>
<br/>
<div class="doc">Case 6: sat_or1 </div>
&nbsp;&nbsp;<span class="tactic">try</span> <span class="id">solve</span> [<span class="tactic">inversion</span> <span class="id">Hcontra</span>; <span class="id">crush</span>].<br/>
<br/>
<div class="doc">Case 7: sat_or2 </div>
&nbsp;&nbsp;<span class="tactic">try</span> <span class="id">solve</span> [<span class="tactic">inversion</span> <span class="id">Hcontra</span>; <span class="id">crush</span>].<br/>
<br/>
<div class="doc">Case 8: sat_arr1 </div>
&nbsp;&nbsp;<span class="tactic">try</span> <span class="id">solve</span> [<span class="tactic">inversion</span> <span class="id">Hcontra</span>; <span class="id">crush</span>].<br/>
<br/>
<div class="doc">Case 9: sat_arr2 </div>
&nbsp;&nbsp;<span class="tactic">try</span> <span class="id">solve</span> [<span class="tactic">inversion</span> <span class="id">Hcontra</span>; <span class="id">crush</span>].<br/>
<br/>
<div class="doc">Case 10: sat_neg </div>
&nbsp;&nbsp;<span class="tactic">try</span> <span class="id">solve</span> [<span class="tactic">inversion</span> <span class="id">Hcontra</span>; <span class="id">crush</span>].<br/>
<br/>
<div class="doc">Case 11: sat_all_x </div>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hcontra</span>; <span class="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contradiction</span> (<span class="id">H</span> <span class="id">y</span> <span class="id">v</span>) <span class="kwd">with</span> (<span class="id">z</span>:=<span class="id">z</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
<br/>
<div class="doc">Case 12: sat_ex_x </div>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hcontra</span>; <span class="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contradiction</span> <span class="id">H</span>; <span class="tactic">eauto</span>.<br/>
<br/>
<div class="doc">Case 13: sat_all_Σ</div>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hcontra</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span> <span class="kwd">in</span> <span class="id">H1</span>; <span class="id">crush</span>.<br/>
<br/>
<div class="doc">Case 13: sat_ex_Σ</div>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hcontra</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H4</span> <span class="kwd">in</span> <span class="id">e</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">crush</span>.<br/>
<br/>
<div class="doc">Case 13: sat_access1 </div>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hcontra</span>; <span class="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contradiction</span> (<span class="id">H1</span> α α); <span class="tactic">auto</span>.<br/>
<br/>
<div class="doc">Case 14: sat_access2 </div>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hcontra</span>; <span class="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contradiction</span> (<span class="id">H5</span> α' α α <span class="id">f</span> <span class="id">o</span>); <span class="tactic">auto</span>.<br/>
<br/>
<div class="doc">Case 15: sat_access3 </div>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hcontra</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H6</span> <span class="kwd">as</span> [<span class="id">Hcontra</span>'|<span class="id">Hcontra</span>'];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">contradiction</span> (<span class="id">Hcontra</span>' α1 α1); <span class="tactic">auto</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id">contradiction</span> (<span class="id">Hcontra</span>' <span class="id">z</span> α2 <span class="id">i1</span> <span class="id">i2</span> ψ ϕ χ <span class="id">s</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>].<br/>
<br/>
<div class="doc">Case 16: sat_call </div>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hcontra</span>; <span class="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">interpretation_rewrite</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H4</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">H4</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H4</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">H7</span> <span class="id">x</span>' <span class="id">y</span>' <span class="id">s</span>) <span class="kwd">as</span> [<span class="id">Ha</span> <span class="id">Hb</span>].<br/>
&nbsp;&nbsp;<span class="id">contradiction</span> (<span class="id">Hb</span> (<span class="id">v_addr</span> α<span class="id">y</span>) (<span class="id">v_addr</span> α<span class="id">y</span>)); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">H7</span> <span class="id">x</span>' <span class="id">y</span>' <span class="id">s</span>) <span class="kwd">as</span> [<span class="id">Ha</span> <span class="id">Hb</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hb</span> <span class="kwd">as</span> [<span class="id">x</span>'' <span class="id">Hb</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hb</span> <span class="kwd">as</span> [<span class="id">v1</span> <span class="id">Hb</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hb</span> <span class="kwd">as</span> [<span class="id">v2</span> <span class="id">Hb</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">andDestruct</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H4</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">H4</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H4</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Ha</span> <span class="kwd">in</span> <span class="id">e0</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">e0</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">compose_v_to_av_equality</span> <span class="kwd">in</span> <span class="id">H6</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">admit</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;external&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hcontra</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">interpretation_rewrite</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">crush</span>.<br/>
&nbsp;&nbsp;<span class="id">contradiction</span> (<span class="id">H3</span> α).<br/>
<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;internal&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hcontra</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">interpretation_rewrite</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">crush</span>.<br/>
&nbsp;&nbsp;<span class="id">contradiction</span> (<span class="id">H3</span> α).<br/>
<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;in&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hcontra</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">restriction_rewrite</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">crush</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;next&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hcontra</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H1</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;will&nbsp;*)</span><br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<br/>
Admitted.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id">sat_implies_not_nsat</span> :<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">M1</span> <span class="id">M2</span> σ <span class="id">A</span>, <span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ ⊨ <span class="id">A</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~ <span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ ⊭ <span class="id">A</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof237')">Proof.</div>
<div class="proofscript" id="proof237">
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">sat_implies_not_nsat_mutind</span>; <span class="id">crush</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id">nsat_implies_not_sat</span> :<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">M1</span> <span class="id">M2</span> σ <span class="id">A</span>, <span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ ⊭ <span class="id">A</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~ <span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ ⊨ <span class="id">A</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof238')">Proof.</div>
<div class="proofscript" id="proof238">
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">sat_implies_not_nsat_mutind</span>; <span class="id">crush</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Lemma 5: Classical (1) </div>
<div class="doc">Yet to be proven </div>
<span class="kwd">Lemma</span> <span class="id">sat_excluded_middle</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">M1</span> <span class="id">M2</span> σ <span class="id">A</span>, (<span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ ⊨ <span class="id">A</span>) \/ (<span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ ⊭ <span class="id">A</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof239')">Proof.</div>
<div class="proofscript" id="proof239">
Admitted.</div>
<br/>
<br/>
<div class="doc">Lemma 5: Classical (5) </div>
<span class="kwd">Lemma</span> <span class="id">arr_true</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">M1</span> <span class="id">M2</span> σ <span class="id">A1</span> <span class="id">A2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ ⊨ (<span class="id">A1</span> ⇒ <span class="id">A2</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ ⊨ <span class="id">A1</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ ⊨ <span class="id">A2</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof240')">Proof.</div>
<div class="proofscript" id="proof240">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">M1</span> <span class="id">M2</span> σ <span class="id">A1</span> <span class="id">A2</span> <span class="id">Hsat</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hsat</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">sat_implies_not_nsat_mutind</span> <span class="kwd">in</span> <span class="id">H3</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">crush</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">arr_false</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">M1</span> <span class="id">M2</span> σ <span class="id">A1</span> <span class="id">A2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ ⊨ (<span class="id">A1</span> ⇒ <span class="id">A2</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ ⊭ <span class="id">A2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ ⊭ <span class="id">A1</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof241')">Proof.</div>
<div class="proofscript" id="proof241">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">M1</span> <span class="id">M2</span> σ <span class="id">A1</span> <span class="id">A2</span> <span class="id">Hsat</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hsat</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">sat_implies_not_nsat_mutind</span> <span class="kwd">in</span> <span class="id">H3</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">crush</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">arr_prop1</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">M1</span> <span class="id">M2</span> σ <span class="id">A1</span> <span class="id">A2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ ⊨ <span class="id">A1</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ ⊨ <span class="id">A2</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ ⊨ (<span class="id">A1</span> ⇒ <span class="id">A2</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof242')">Proof.</div>
<div class="proofscript" id="proof242">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">sat_excluded_middle</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> (<span class="id">M1</span>:=<span class="id">M1</span>)(<span class="id">M2</span>:=<span class="id">M2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(σ:=σ)(<span class="id">A</span>:=<span class="id">A1</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">chainmail_db</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">arr_prop2</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">M1</span> <span class="id">M2</span> σ <span class="id">A1</span> <span class="id">A2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ ⊨ (<span class="id">A1</span> ⇒ <span class="id">A2</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ ⊨ <span class="id">A1</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ ⊨ <span class="id">A2</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof243')">Proof.</div>
<div class="proofscript" id="proof243">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">arr_true</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">arr_prop</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">M1</span> <span class="id">M2</span> σ <span class="id">A1</span> <span class="id">A2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ ⊨ (<span class="id">A1</span> ⇒ <span class="id">A2</span>) &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ ⊨ <span class="id">A1</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ ⊨ <span class="id">A2</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof244')">Proof.</div>
<div class="proofscript" id="proof244">
&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="tactic">apply</span> <span class="id">arr_prop2</span>|<span class="tactic">apply</span> <span class="id">arr_prop1</span>].<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">all_x_prop</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">M1</span> <span class="id">M2</span> σ <span class="id">A</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ ⊨ (∀<span class="id">x</span>∙<span class="id">A</span>) &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">y</span> <span class="id">v</span>, <span class="id">mapp</span> σ <span class="id">y</span> = <span class="id">Some</span> <span class="id">v</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">z</span>, <span class="id">fresh_x_</span>σ <span class="id">z</span> σ <span class="id">A</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ (<span class="id">update_</span>σ<span class="id">_map</span> σ <span class="id">z</span> <span class="id">v</span>) ⊨ ([<span class="id">z</span> /<span class="id">s</span> 0]<span class="id">A</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof245')">Proof.</div>
<div class="proofscript" id="proof245">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">split</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">chainmail_db</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">ex_x_prop</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">M1</span> <span class="id">M2</span> σ <span class="id">A</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ ⊨ (∃<span class="id">x</span>∙<span class="id">A</span>) &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">exists</span> <span class="id">y</span> <span class="id">v</span> <span class="id">z</span>, <span class="id">mapp</span> σ <span class="id">y</span> = <span class="id">Some</span> <span class="id">v</span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">fresh_x_</span>σ <span class="id">z</span> σ <span class="id">A</span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ (<span class="id">update_</span>σ<span class="id">_map</span> σ <span class="id">z</span> <span class="id">v</span>) ⊨ ([<span class="id">z</span> /<span class="id">s</span> 0] <span class="id">A</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof246')">Proof.</div>
<div class="proofscript" id="proof246">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">split</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">chainmail_db</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;- <span class="id">eexists</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">repeat</span> <span class="id">destruct_exists_loo</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">andDestruct</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">chainmail_db</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Lemma 5: Classical (2) </div>
<span class="kwd">Lemma</span> <span class="id">and_iff</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">M1</span> <span class="id">M2</span> σ <span class="id">A1</span> <span class="id">A2</span>, (<span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ ⊨ (<span class="id">A1</span> ∧ <span class="id">A2</span>)) &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ ⊨ <span class="id">A1</span> /\ <span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ ⊨ <span class="id">A2</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof247')">Proof.</div>
<div class="proofscript" id="proof247">
&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">Ha</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Ha</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">chainmail_db</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Lemma 5: Classical (3) </div>
<span class="kwd">Lemma</span> <span class="id">or_iff</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">M1</span> <span class="id">M2</span> σ <span class="id">A1</span> <span class="id">A2</span>, (<span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ ⊨ (<span class="id">A1</span> ∨ <span class="id">A2</span>)) &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ ⊨ <span class="id">A1</span> \/ <span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ ⊨ <span class="id">A2</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof248')">Proof.</div>
<div class="proofscript" id="proof248">
&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">Ha</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Ha</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">chainmail_db</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">negate_elim_sat</span> :<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">A</span> <span class="id">M1</span> <span class="id">M2</span> σ, <span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ ⊨ (¬ ¬ <span class="id">A</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ ⊨ <span class="id">A</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof249')">Proof.</div>
<div class="proofscript" id="proof249">
&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H4</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">negate_elim_nsat</span> :<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">A</span> <span class="id">M1</span> <span class="id">M2</span> σ, <span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ ⊭ (¬ ¬ <span class="id">A</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ ⊭ <span class="id">A</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof250')">Proof.</div>
<div class="proofscript" id="proof250">
&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H4</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">negate_intro_sat</span> :<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">A</span> <span class="id">M1</span> <span class="id">M2</span> σ, <span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ ⊨ <span class="id">A</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ ⊨ (¬ ¬ <span class="id">A</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof251')">Proof.</div>
<div class="proofscript" id="proof251">
&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">chainmail_db</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">negate_intro_nsat</span> :<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">A</span> <span class="id">M1</span> <span class="id">M2</span> σ, <span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ ⊭ <span class="id">A</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ ⊭ (¬ ¬ <span class="id">A</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof252')">Proof.</div>
<div class="proofscript" id="proof252">
&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">chainmail_db</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">will_arr</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">M1</span> <span class="id">M2</span> σ <span class="id">A1</span> <span class="id">A2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ ⊨ <span class="id">a_will</span>(<span class="id">A1</span> ⇒ <span class="id">A2</span> ∧ <span class="id">A1</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ ⊨ <span class="id">a_will</span>(<span class="id">A2</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof253')">Proof.</div>
<div class="proofscript" id="proof253">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H7</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">sat_will</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> (ϕ:=ϕ)(ψ:=ψ)(χ:=χ)(σ':=σ')(σ'':=σ'');<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">arr_true</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Inductive</span> <span class="id">entails</span> : <span class="id">asrt</span> -&gt; <span class="id">asrt</span> -&gt; <span class="kwd">Prop</span> :=<br/>
| <span class="id">ent</span> : <span class="kwd">forall</span> <span class="id">A1</span> <span class="id">A2</span>, (<span class="kwd">forall</span> χ ϕ ψ <span class="id">M1</span> <span class="id">M2</span>, <span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ (χ, ϕ::ψ) ⊨ <span class="id">A1</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ (χ, ϕ::ψ) ⊨ <span class="id">A2</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">entails</span> <span class="id">A1</span> <span class="id">A2</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">equiv_a</span> (<span class="id">A1</span> <span class="id">A2</span> : <span class="id">asrt</span>): <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;(<span class="id">entails</span> <span class="id">A1</span> <span class="id">A2</span>) /\ (<span class="id">entails</span> <span class="id">A2</span> <span class="id">A1</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">sat_and_nsat_entails_false</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span>, <span class="id">entails</span> (<span class="id">A</span> ∧ ¬ <span class="id">A</span>) (<span class="id">a_exp</span> (<span class="id">e_false</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof254')">Proof.</div>
<div class="proofscript" id="proof254">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">ent</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">and_iff</span> <span class="kwd">in</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">andDestruct</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hb</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">sat_implies_not_nsat</span> <span class="kwd">in</span> <span class="id">Ha</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">crush</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">sat_and_nsat_entails_false</span> : <span class="id">chainmail_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">false_entails_sat_and_nsat</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span>, <span class="id">entails</span> (<span class="id">a_exp</span> (<span class="id">e_false</span>)) (<span class="id">A</span> ∧ ¬ <span class="id">A</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof255')">Proof.</div>
<div class="proofscript" id="proof255">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">ent</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H4</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">false_entails_sat_and_nsat</span> : <span class="id">chainmail_db</span>.<br/>
<br/>
<div class="doc">Lemma 6: (1) </div>
<span class="kwd">Lemma</span> <span class="id">sat_and_nsat_equiv_false</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span>, <span class="id">equiv_a</span> (<span class="id">A</span> ∧ ¬ <span class="id">A</span>) (<span class="id">a_exp</span> (<span class="id">e_false</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof256')">Proof.</div>
<div class="proofscript" id="proof256">
&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">equiv_a</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">chainmail_db</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">or_commutative</span>' :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A1</span> <span class="id">A2</span>, <span class="id">entails</span> (<span class="id">A1</span> ∨ <span class="id">A2</span>) (<span class="id">A2</span> ∨ <span class="id">A1</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof257')">Proof.</div>
<div class="proofscript" id="proof257">
&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">ent</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">chainmail_db</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">or_commutative</span>' : <span class="id">chainmail_db</span>.<br/>
<br/>
<div class="doc">Lemma 6: (4) </div>
<span class="kwd">Lemma</span> <span class="id">or_commutative</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A1</span> <span class="id">A2</span>, <span class="id">equiv_a</span> (<span class="id">A1</span> ∨ <span class="id">A2</span>) (<span class="id">A2</span> ∨ <span class="id">A1</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof258')">Proof.</div>
<div class="proofscript" id="proof258">
&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">equiv_a</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">chainmail_db</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">or_commutative</span> : <span class="id">chainmail_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">and_commutative</span>' :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A1</span> <span class="id">A2</span>, <span class="id">entails</span> (<span class="id">A1</span> ∧ <span class="id">A2</span>) (<span class="id">A2</span> ∧ <span class="id">A1</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof259')">Proof.</div>
<div class="proofscript" id="proof259">
&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">ent</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">chainmail_db</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">and_commutative</span>' : <span class="id">chainmail_db</span>.<br/>
<br/>
<div class="doc">Lemma 6: (3) </div>
<span class="kwd">Lemma</span> <span class="id">and_commutative</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A1</span> <span class="id">A2</span>, <span class="id">equiv_a</span> (<span class="id">A1</span> ∧ <span class="id">A2</span>) (<span class="id">A2</span> ∧ <span class="id">A1</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof260')">Proof.</div>
<div class="proofscript" id="proof260">
&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">equiv_a</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">chainmail_db</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">and_commutative</span> : <span class="id">chainmail_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">or_associative_1</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A1</span> <span class="id">A2</span> <span class="id">A3</span>, <span class="id">entails</span> ((<span class="id">A1</span> ∨ <span class="id">A2</span>) ∨ <span class="id">A3</span>) (<span class="id">A1</span> ∨ (<span class="id">A2</span> ∨ <span class="id">A3</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof261')">Proof.</div>
<div class="proofscript" id="proof261">
&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">ent</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H4</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">chainmail_db</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">or_associative_1</span> : <span class="id">chainmail_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">or_associative_2</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A1</span> <span class="id">A2</span> <span class="id">A3</span>, <span class="id">entails</span> (<span class="id">A1</span> ∨ (<span class="id">A2</span> ∨ <span class="id">A3</span>)) ((<span class="id">A1</span> ∨ <span class="id">A2</span>) ∨ <span class="id">A3</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof262')">Proof.</div>
<div class="proofscript" id="proof262">
&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">ent</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H4</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">chainmail_db</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">or_associative_2</span> : <span class="id">chainmail_db</span>.<br/>
<br/>
<div class="doc">Lemma 6: (5) </div>
<span class="kwd">Lemma</span> <span class="id">or_associative</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A1</span> <span class="id">A2</span> <span class="id">A3</span>, <span class="id">equiv_a</span> ((<span class="id">A1</span> ∨ <span class="id">A2</span>) ∨ <span class="id">A3</span>) (<span class="id">A1</span> ∨ (<span class="id">A2</span> ∨ <span class="id">A3</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof263')">Proof.</div>
<div class="proofscript" id="proof263">
&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">equiv_a</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">chainmail_db</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">or_associative</span> : <span class="id">chainmail_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">and_distributive_1</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A1</span> <span class="id">A2</span> <span class="id">A3</span>, <span class="id">entails</span> ((<span class="id">A1</span> ∨ <span class="id">A2</span>) ∧ <span class="id">A3</span>) ((<span class="id">A1</span> ∧ <span class="id">A3</span>) ∨ (<span class="id">A2</span> ∧ <span class="id">A3</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof264')">Proof.</div>
<div class="proofscript" id="proof264">
&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">ent</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H5</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">chainmail_db</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">and_distributive_1</span> : <span class="id">chainmail_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">and_distributive_2</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A1</span> <span class="id">A2</span> <span class="id">A3</span>, <span class="id">entails</span> ((<span class="id">A1</span> ∧ <span class="id">A3</span>) ∨ (<span class="id">A2</span> ∧ <span class="id">A3</span>)) ((<span class="id">A1</span> ∨ <span class="id">A2</span>) ∧ <span class="id">A3</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof265')">Proof.</div>
<div class="proofscript" id="proof265">
&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">ent</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H4</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">chainmail_db</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">and_distributive_2</span> : <span class="id">chainmail_db</span>.<br/>
<br/>
<div class="doc">Lemma 6: (6) </div>
<span class="kwd">Lemma</span> <span class="id">and_distributive</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A1</span> <span class="id">A2</span> <span class="id">A3</span>, <span class="id">equiv_a</span> ((<span class="id">A1</span> ∨ <span class="id">A2</span>) ∧ <span class="id">A3</span>) ((<span class="id">A1</span> ∧ <span class="id">A3</span>) ∨ (<span class="id">A2</span> ∧ <span class="id">A3</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof266')">Proof.</div>
<div class="proofscript" id="proof266">
&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">equiv_a</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">chainmail_db</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">and_distributive</span> : <span class="id">chainmail_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">or_distributive_1</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A1</span> <span class="id">A2</span> <span class="id">A3</span>, <span class="id">entails</span> ((<span class="id">A1</span> ∧ <span class="id">A2</span>) ∨ <span class="id">A3</span>) ((<span class="id">A1</span> ∨ <span class="id">A3</span>) ∧ (<span class="id">A2</span> ∨ <span class="id">A3</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof267')">Proof.</div>
<div class="proofscript" id="proof267">
&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">ent</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">chainmail_db</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H4</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">chainmail_db</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">or_distributive_1</span> : <span class="id">chainmail_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">or_distributive_2</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A1</span> <span class="id">A2</span> <span class="id">A3</span>, <span class="id">entails</span> ((<span class="id">A1</span> ∨ <span class="id">A3</span>) ∧ (<span class="id">A2</span> ∨ <span class="id">A3</span>)) ((<span class="id">A1</span> ∧ <span class="id">A2</span>) ∨ <span class="id">A3</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof268')">Proof.</div>
<div class="proofscript" id="proof268">
&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">ent</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H5</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H6</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">chainmail_db</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">or_distributive_2</span> : <span class="id">chainmail_db</span>.<br/>
<br/>
<div class="doc">Lemma 6: (7) </div>
<span class="kwd">Lemma</span> <span class="id">or_distributive</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A1</span> <span class="id">A2</span> <span class="id">A3</span>, <span class="id">equiv_a</span> ((<span class="id">A1</span> ∧ <span class="id">A2</span>) ∨ <span class="id">A3</span>) ((<span class="id">A1</span> ∨ <span class="id">A3</span>) ∧ (<span class="id">A2</span> ∨ <span class="id">A3</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof269')">Proof.</div>
<div class="proofscript" id="proof269">
&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">equiv_a</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">chainmail_db</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">or_distributive</span> : <span class="id">chainmail_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">neg_distributive_and_1</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A1</span> <span class="id">A2</span>, <span class="id">entails</span> (¬(<span class="id">A1</span> ∧ <span class="id">A2</span>))  (¬<span class="id">A1</span> ∨ ¬<span class="id">A2</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof270')">Proof.</div>
<div class="proofscript" id="proof270">
&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">ent</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H4</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">chainmail_db</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">neg_distributive_and_1</span> : <span class="id">chainmail_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">neg_distributive_and_2</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A1</span> <span class="id">A2</span>, <span class="id">entails</span> (¬<span class="id">A1</span> ∨ ¬<span class="id">A2</span>) (¬(<span class="id">A1</span> ∧ <span class="id">A2</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof271')">Proof.</div>
<div class="proofscript" id="proof271">
&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">ent</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H4</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">chainmail_db</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">neg_distributive_and_2</span> : <span class="id">chainmail_db</span>.<br/>
<br/>
<div class="doc">Lemma 6: (8) </div>
<span class="kwd">Lemma</span> <span class="id">neg_distributive_and</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A1</span> <span class="id">A2</span>, <span class="id">equiv_a</span> (¬(<span class="id">A1</span> ∧ <span class="id">A2</span>))  (¬<span class="id">A1</span> ∨ ¬<span class="id">A2</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof272')">Proof.</div>
<div class="proofscript" id="proof272">
&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">equiv_a</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">chainmail_db</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">neg_distributive_and</span> : <span class="id">chainmail_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">neg_distributive_or_1</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A1</span> <span class="id">A2</span>, <span class="id">entails</span> (¬(<span class="id">A1</span> ∨ <span class="id">A2</span>)) (¬<span class="id">A1</span> ∧ ¬<span class="id">A2</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof273')">Proof.</div>
<div class="proofscript" id="proof273">
&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">ent</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H4</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">chainmail_db</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">neg_distributive_or_1</span> : <span class="id">chainmail_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">neg_distributive_or_2</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A1</span> <span class="id">A2</span>, <span class="id">entails</span> (¬<span class="id">A1</span> ∧ ¬<span class="id">A2</span>) (¬(<span class="id">A1</span> ∨ <span class="id">A2</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof274')">Proof.</div>
<div class="proofscript" id="proof274">
&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">ent</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H5</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H6</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">chainmail_db</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">neg_distributive_or_2</span> : <span class="id">chainmail_db</span>.<br/>
<br/>
<div class="doc">Lemma 6: (9) </div>
<span class="kwd">Lemma</span> <span class="id">neg_distributive_or</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A1</span> <span class="id">A2</span>, <span class="id">equiv_a</span> (¬(<span class="id">A1</span> ∨ <span class="id">A2</span>)) (¬<span class="id">A1</span> ∧ ¬<span class="id">A2</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof275')">Proof.</div>
<div class="proofscript" id="proof275">
&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">equiv_a</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">chainmail_db</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">neg_distributive_or</span> : <span class="id">chainmail_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">fresh_not_1</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> ϕ <span class="id">A</span>, <span class="id">fresh_x</span> <span class="id">x</span> ϕ <span class="id">A</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">fresh_x</span> <span class="id">x</span> ϕ (¬ <span class="id">A</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof276')">Proof.</div>
<div class="proofscript" id="proof276">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">frsh</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">chainmail_db</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">fresh_not_1</span> : <span class="id">chainmail_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">fresh_not_2</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> ϕ <span class="id">A</span>, <span class="id">fresh_x</span> <span class="id">x</span> ϕ (¬ <span class="id">A</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">fresh_x</span> <span class="id">x</span> ϕ <span class="id">A</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof277')">Proof.</div>
<div class="proofscript" id="proof277">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H1</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">frsh</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">fresh_not_2</span> : <span class="id">chainmail_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">fresh_not_</span>σ<span class="id">_1</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> σ <span class="id">A</span>, <span class="id">fresh_x_</span>σ <span class="id">x</span> σ <span class="id">A</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">fresh_x_</span>σ <span class="id">x</span> σ (¬ <span class="id">A</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof278')">Proof.</div>
<div class="proofscript" id="proof278">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">destruct_exists_loo</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">andDestruct</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">fresh_x_</span>ϕ<span class="id">_implies_</span>σ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">chainmail_db</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">fresh_not_</span>σ<span class="id">_1</span> : <span class="id">chainmail_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">fresh_not_</span>σ<span class="id">_2</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> σ <span class="id">A</span>, <span class="id">fresh_x_</span>σ <span class="id">x</span> σ (¬ <span class="id">A</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">fresh_x_</span>σ <span class="id">x</span> σ <span class="id">A</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof279')">Proof.</div>
<div class="proofscript" id="proof279">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">fresh_x_</span>σ <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">destruct_exists_loo</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">andDestruct</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">eexists</span>.<br/>
&nbsp;&nbsp;<span class="id">eexists</span>.<br/>
&nbsp;&nbsp;<span class="id">eexists</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">chainmail_db</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">fresh_not_</span>σ<span class="id">_2</span> : <span class="id">chainmail_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">not_ex_x_all_not_1</span> : <br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span>, <span class="id">entails</span> (¬(∃<span class="id">x</span>∙<span class="id">A</span>)) (∀<span class="id">x</span>∙¬<span class="id">A</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof280')">Proof.</div>
<div class="proofscript" id="proof280">
&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">ent</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H4</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">sat_all_x</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">sat_not</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">H5</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">chainmail_db</span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">not_ex_x_all_not_1</span> : <span class="id">chainmail_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">not_ex_x_all_not_2</span> : <br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span>, <span class="id">entails</span> (∀<span class="id">x</span>∙¬<span class="id">A</span>) (¬(∃<span class="id">x</span>∙<span class="id">A</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof281')">Proof.</div>
<div class="proofscript" id="proof281">
&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">ent</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">sat_not</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">nsat_ex_x</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">H4</span> <span class="kwd">in</span> <span class="id">H0</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">chainmail_db</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H0</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">chainmail_db</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">not_ex_x_all_not_2</span> : <span class="id">chainmail_db</span>.<br/>
<br/>
<div class="doc">Lemma 6: (10) </div>
<span class="kwd">Lemma</span> <span class="id">not_ex_x_all_not</span> : <br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span>, <span class="id">equiv_a</span> (¬(∃<span class="id">x</span>∙<span class="id">A</span>)) (∀<span class="id">x</span>∙¬<span class="id">A</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof282')">Proof.</div>
<div class="proofscript" id="proof282">
&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">equiv_a</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">chainmail_db</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">not_ex_x_all_not</span> : <span class="id">chainmail_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">not_all_x_ex_not_1</span> : <br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span>, <span class="id">entails</span> (¬(∀<span class="id">x</span>∙<span class="id">A</span>)) (∃<span class="id">x</span>∙¬<span class="id">A</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof283')">Proof.</div>
<div class="proofscript" id="proof283">
&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">ent</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H4</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">sat_ex_x</span> <span class="kwd">with</span> (<span class="id">z</span>:=<span class="id">z</span>)(<span class="id">y</span>:=<span class="id">y</span>)(<span class="id">v</span>:=<span class="id">v</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">chainmail_db</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sbst_simpl</span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">sat_not</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">not_all_x_ex_not_1</span> : <span class="id">chainmail_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">not_all_x_ex_not_2</span> : <br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span>, <span class="id">entails</span> (∃<span class="id">x</span>∙¬<span class="id">A</span>) (¬(∀<span class="id">x</span>∙<span class="id">A</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof284')">Proof.</div>
<div class="proofscript" id="proof284">
&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">ent</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">sat_not</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">nsat_all_x</span> <span class="kwd">with</span> (<span class="id">y</span>:=<span class="id">y</span>)(<span class="id">z</span>:=<span class="id">z</span>)(<span class="id">v</span>:=<span class="id">v</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">chainmail_db</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sbst_simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H6</span>; <span class="tactic">subst</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">not_all_x_ex_not_2</span> : <span class="id">chainmail_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">not_all_x_ex_not</span> : <br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span>, <span class="id">equiv_a</span> (¬(∀<span class="id">x</span>∙<span class="id">A</span>)) (∃<span class="id">x</span>∙¬<span class="id">A</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof285')">Proof.</div>
<div class="proofscript" id="proof285">
&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">equiv_a</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">chainmail_db</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">not_all_x_ex_not</span> : <span class="id">chainmail_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">not_ex_</span>Σ<span class="id">_all_not_1</span> : <br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span>, <span class="id">entails</span> (¬(∃<span class="id">S</span>∙<span class="id">A</span>)) (∀<span class="id">S</span>∙¬<span class="id">A</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof286')">Proof.</div>
<div class="proofscript" id="proof286">
&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">ent</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">sat_all_</span>Σ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H5</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H6</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">sat_not</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">not_ex_</span>Σ<span class="id">_all_not_1</span> : <span class="id">chainmail_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">not_ex_</span>Σ<span class="id">_all_not_2</span> : <br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span>, <span class="id">entails</span> (∀<span class="id">S</span>∙¬<span class="id">A</span>) (¬(∃<span class="id">S</span>∙<span class="id">A</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof287')">Proof.</div>
<div class="proofscript" id="proof287">
&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">ent</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">sat_not</span>, <span class="id">nsat_ex_</span>Σ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H4</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H0</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">not_ex_</span>Σ<span class="id">_all_not_2</span> : <span class="id">chainmail_db</span>.<br/>
<br/>
<div class="doc">Lemma 6: (11) </div>
<span class="kwd">Lemma</span> <span class="id">not_ex_</span>Σ<span class="id">_all_not</span> : <br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span>, <span class="id">equiv_a</span> (¬(∃<span class="id">S</span>∙<span class="id">A</span>)) (∀<span class="id">S</span>∙¬<span class="id">A</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof288')">Proof.</div>
<div class="proofscript" id="proof288">
&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">equiv_a</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">chainmail_db</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">not_ex_</span>Σ<span class="id">_all_not</span> : <span class="id">chainmail_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">not_all_</span>Σ<span class="id">_ex_not_1</span> : <br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span>, <span class="id">entails</span> (¬(∀<span class="id">S</span>∙<span class="id">A</span>)) (∃<span class="id">S</span>∙¬<span class="id">A</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof289')">Proof.</div>
<div class="proofscript" id="proof289">
&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">ent</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H4</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">sat_ex_</span>Σ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">sat_not</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">not_all_</span>Σ<span class="id">_ex_not_1</span> : <span class="id">chainmail_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">not_all_</span>Σ<span class="id">_ex_not_2</span> : <br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span>, <span class="id">entails</span> (∃<span class="id">S</span>∙¬<span class="id">A</span>) (¬(∀<span class="id">S</span>∙<span class="id">A</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof290')">Proof.</div>
<div class="proofscript" id="proof290">
&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">ent</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">sat_not</span>, <span class="id">nsat_all_</span>Σ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H5</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">not_all_</span>Σ<span class="id">_ex_not_2</span> : <span class="id">chainmail_db</span>.<br/>
<br/>
<div class="doc">Lemma 6: (13) </div>
<span class="kwd">Lemma</span> <span class="id">not_all_</span>Σ<span class="id">_ex_not</span> : <br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span>, <span class="id">equiv_a</span> (¬(∀<span class="id">S</span>∙<span class="id">A</span>)) (∃<span class="id">S</span>∙¬<span class="id">A</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof291')">Proof.</div>
<div class="proofscript" id="proof291">
&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">equiv_a</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">chainmail_db</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">not_all_</span>Σ<span class="id">_ex_not</span> : <span class="id">chainmail_db</span>.<br/>
<br/>
<div class="doc">Properties of Linking </div>
<span class="kwd">Lemma</span> <span class="id">moduleLinking_associative</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">M1</span> <span class="id">M2</span> <span class="id">M12</span>, <span class="id">M1</span> ⋄ <span class="id">M2</span> ≜ <span class="id">M12</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">M3</span> <span class="id">M23</span>, <span class="id">M2</span> ⋄ <span class="id">M3</span> ≜ <span class="id">M23</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">M</span> <span class="id">M</span>', <span class="id">M12</span> ⋄ <span class="id">M3</span> ≜ <span class="id">M</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M1</span> ⋄ <span class="id">M23</span> ≜ <span class="id">M</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M</span> = <span class="id">M</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof292')">Proof.</div>
<div class="proofscript" id="proof292">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H0</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H1</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H2</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">functional_extensionality</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">C</span>.<br/>
&nbsp;&nbsp;<span class="id">remember</span> (<span class="id">M1</span> <span class="id">C</span>) <span class="kwd">as</span> <span class="id">res1</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> (<span class="id">M2</span> <span class="id">C</span>) <span class="kwd">as</span> <span class="id">res2</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> (<span class="id">M3</span> <span class="id">C</span>) <span class="kwd">as</span> <span class="id">res3</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">res1</span> <span class="kwd">as</span> [<span class="id">CDef1</span>|];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">res2</span> <span class="kwd">as</span> [<span class="id">CDef2</span>|];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">res3</span> <span class="kwd">as</span> [<span class="id">CDef3</span>|];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">extend</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Heqres1</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">moduleLinking_commutative_1</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">M1</span> <span class="id">M2</span> <span class="id">M</span>, <span class="id">M1</span> ⋄ <span class="id">M2</span> ≜ <span class="id">M</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M_wf</span> <span class="id">M1</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M_wf</span> <span class="id">M2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M2</span> ⋄ <span class="id">M1</span> ≜ <span class="id">M</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof293')">Proof.</div>
<div class="proofscript" id="proof293">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hrewrite</span> : <span class="id">extend</span> <span class="id">M1</span> <span class="id">M2</span> = <span class="id">extend</span> <span class="id">M2</span> <span class="id">M1</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[|<span class="tactic">rewrite</span> <span class="id">Hrewrite</span>; <span class="tactic">apply</span> <span class="id">m_link</span>; <span class="tactic">eauto</span>].<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">functional_extensionality</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">C</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">extend</span>.<br/>
&nbsp;&nbsp;<span class="id">remember</span> (<span class="id">M1</span> <span class="id">C</span>) <span class="kwd">as</span> <span class="id">r1</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> (<span class="id">M2</span> <span class="id">C</span>) <span class="kwd">as</span> <span class="id">r2</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">r1</span> <span class="kwd">as</span> [<span class="id">def1</span>|];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">r2</span> <span class="kwd">as</span> [<span class="id">def2</span>|];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">eq_dec</span> <span class="id">C</span> <span class="id">ObjectName</span>) <span class="kwd">as</span> [|<span class="id">Hneq</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="tactic">subst</span>|].<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H0</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H1</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">crush</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H2</span> <span class="kwd">with</span> (<span class="id">def</span>:=<span class="id">def1</span>) <span class="kwd">in</span> <span class="id">Heqr2</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">crush</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">moduleLinking_commutative_2</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">M1</span> <span class="id">M2</span> <span class="id">M</span>, <span class="id">M1</span> ⋄ <span class="id">M2</span> ≜ <span class="id">M</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">M</span>', <span class="id">M2</span> ⋄ <span class="id">M1</span> ≜ <span class="id">M</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M_wf</span> <span class="id">M1</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M_wf</span> <span class="id">M2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M</span> = <span class="id">M</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof294')">Proof.</div>
<div class="proofscript" id="proof294">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H0</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">functional_extensionality</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">C</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">extend</span>.<br/>
&nbsp;&nbsp;<span class="id">remember</span> (<span class="id">M1</span> <span class="id">C</span>) <span class="kwd">as</span> <span class="id">res1</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> (<span class="id">M2</span> <span class="id">C</span>) <span class="kwd">as</span> <span class="id">res2</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">res1</span> <span class="kwd">as</span> [<span class="id">CDef1</span>|];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">res2</span> <span class="kwd">as</span> [<span class="id">CDef2</span>|];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">eq_dec</span> <span class="id">C</span> <span class="id">ObjectName</span>) <span class="kwd">as</span> [|<span class="id">Hneq</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="tactic">subst</span>|].<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H1</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H2</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Heqres1</span> <span class="kwd">in</span> <span class="id">H5</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Heqres2</span> <span class="kwd">in</span> <span class="id">H11</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H5</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H11</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">Heqres1</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H9</span> <span class="kwd">in</span> <span class="id">Heqres1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Heqres1</span> <span class="kwd">in</span> <span class="id">Heqres2</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">crush</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">Heqres1</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">linking_preserves_reduction</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">M1</span> σ1 σ2, <span class="id">M1</span> ∙ σ1 ⤳ σ2 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">M2</span> <span class="id">M</span>, <span class="id">M1</span> ⋄ <span class="id">M2</span> ≜ <span class="id">M</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M</span> ∙ σ1 ⤳ σ2.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof295')">Proof.</div>
<div class="proofscript" id="proof295">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">M1</span> σ1 σ2 <span class="id">Hred</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">Hred</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">loo_db</span>.<br/>
<br/>
&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id">r_mth</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H9</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">extend</span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H4</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
<br/>
&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id">r_new</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H9</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">extend</span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H3</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">entails_implies</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">M1</span> <span class="id">M2</span> χ ϕ ψ <span class="id">A1</span>, <span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ (χ, ϕ::ψ) ⊨ <span class="id">A1</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A2</span>, <span class="id">entails</span> <span class="id">A1</span> <span class="id">A2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ (χ, ϕ::ψ) ⊨ <span class="id">A2</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof296')">Proof.</div>
<div class="proofscript" id="proof296">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H0</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">entails_implies</span> : <span class="id">chainmail_db</span>.<br/>
<span class="kwd">Hint</span> <span class="id">Rewrite</span> <span class="id">entails_implies</span> : <span class="id">chainmail_db</span>.<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">sat_destruct</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| [<span class="id">Hand</span> : <span class="id">_</span> ⦂ <span class="id">_</span> ◎ <span class="id">_</span> ⊨ (<span class="id">_</span> ∧ <span class="id">_</span>) |- <span class="id">_</span>] =&gt; <span class="tactic">apply</span> <span class="id">and_iff</span> <span class="kwd">in</span> <span class="id">Hand</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hand</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">frsh_auto</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| [<span class="id">Hfrsh</span> : <span class="id">fresh_x</span> <span class="id">_</span> <span class="id">_</span> (<span class="id">_</span> ∧ <span class="id">_</span>) |- <span class="id">_</span>] =&gt; <span class="tactic">apply</span> <span class="id">fresh_and_elim</span> <span class="kwd">in</span> <span class="id">Hfrsh</span>; <span class="id">andDestruct</span><br/>
&nbsp;&nbsp;| [<span class="id">Hfrsh</span> : <span class="id">fresh_x</span> <span class="id">_</span> <span class="id">_</span> (<span class="id">_</span> ⇒ <span class="id">_</span>) |- <span class="id">_</span>] =&gt; <span class="tactic">apply</span> <span class="id">fresh_arr_elim</span> <span class="kwd">in</span> <span class="id">Hfrsh</span>; <span class="id">andDestruct</span><br/>
&nbsp;&nbsp;| [<span class="id">Hfrsh</span> : <span class="id">fresh_x</span> <span class="id">_</span> <span class="id">_</span> (∀<span class="id">x</span>∙ <span class="id">_</span>) |- <span class="id">_</span>] =&gt; <span class="tactic">apply</span> <span class="id">fresh_all_elim</span> <span class="kwd">in</span> <span class="id">Hfrsh</span><br/>
&nbsp;&nbsp;| [ |- <span class="id">fresh_x</span> <span class="id">_</span> <span class="id">_</span> (<span class="id">_</span> ∧ <span class="id">_</span>)] =&gt; <span class="tactic">apply</span> <span class="id">fresh_and_intro</span><br/>
&nbsp;&nbsp;| [ |- <span class="id">fresh_x</span> <span class="id">_</span> <span class="id">_</span> (<span class="id">_</span> ⇒ <span class="id">_</span>)] =&gt; <span class="tactic">apply</span> <span class="id">fresh_arr_intro</span><br/>
&nbsp;&nbsp;| [ |- <span class="id">fresh_x</span> <span class="id">_</span> <span class="id">_</span> (∀<span class="id">x</span>∙<span class="id">_</span>)] =&gt; <span class="tactic">apply</span> <span class="id">fresh_all_intro</span><br/>
&nbsp;&nbsp;| [ <span class="id">Hfrsh</span> : <span class="id">fresh_x</span> ?<span class="id">x</span> ?σ <span class="id">_</span> |- <span class="id">fresh_x</span> ?<span class="id">x</span> ?σ <span class="id">_</span>] =&gt; <span class="tactic">auto</span>; <span class="tactic">try</span> (<span class="tactic">eapply</span> <span class="id">fresh_notin</span>; <span class="tactic">eauto</span>)<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">a_intro</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| [|- <span class="id">_</span> ⦂ <span class="id">_</span> ◎ <span class="id">_</span> ⊨ (∀<span class="id">x</span>∙ <span class="id">_</span>)] =&gt; <span class="tactic">apply</span> <span class="id">sat_all_x</span>; <span class="tactic">intros</span>; <span class="id">sbst_simpl</span><br/>
&nbsp;&nbsp;| [|- <span class="id">_</span> ⦂ <span class="id">_</span> ◎ <span class="id">_</span> ⊨ (<span class="id">_</span> ⇒ <span class="id">_</span>)] =&gt; <span class="tactic">apply</span> <span class="id">arr_prop1</span>; <span class="tactic">intros</span>; <span class="id">sbst_simpl</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">a_intros</span> :=<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">a_intro</span>.<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">a_prop</span> :=<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span> : <span class="id">_</span> ⦂ <span class="id">_</span> ◎ <span class="id">_</span> ⊨ (<span class="id">_</span> ∧ <span class="id">_</span>) |- <span class="id">_</span>] =&gt; <span class="tactic">apply</span> -&gt; <span class="id">and_iff</span> <span class="kwd">in</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span> : <span class="id">_</span> ⦂ <span class="id">_</span> ◎ <span class="id">_</span> ⊨ (<span class="id">_</span> ∨ <span class="id">_</span>) |- <span class="id">_</span>] =&gt; <span class="tactic">apply</span> -&gt; <span class="id">or_iff</span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span> : <span class="id">_</span> ⦂ <span class="id">_</span> ◎ <span class="id">_</span> ⊨ (<span class="id">_</span> ⇒ <span class="id">_</span>) |- <span class="id">_</span>] =&gt; <span class="tactic">rewrite</span> -&gt; <span class="id">arr_prop</span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span> : <span class="id">context</span>[<span class="id">_</span> ⦂ <span class="id">_</span> ◎ <span class="id">_</span> ⊨ (<span class="id">_</span> ⇒ <span class="id">_</span>)] |- <span class="id">_</span>] =&gt; <span class="tactic">rewrite</span> -&gt; <span class="id">arr_prop</span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span> : <span class="id">_</span> ⦂ <span class="id">_</span> ◎ <span class="id">_</span> ⊨ (∀<span class="id">x</span>∙<span class="id">_</span>) |- <span class="id">_</span>] =&gt; <span class="tactic">rewrite</span> <span class="id">all_x_prop</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">sbst_simpl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [|- <span class="id">_</span> ⦂ <span class="id">_</span> ◎ <span class="id">_</span> ⊨ (<span class="id">_</span> ∧ <span class="id">_</span>)] =&gt; <span class="tactic">apply</span> <span class="id">sat_and</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [|- <span class="id">_</span> ⦂ <span class="id">_</span> ◎ <span class="id">_</span> ⊨ (<span class="id">_</span> ∨ <span class="id">_</span>)] =&gt; <span class="tactic">apply</span> &lt;- <span class="id">or_iff</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span> : <span class="id">entails</span> ?<span class="id">A1</span> ?<span class="id">A2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Ha</span> : ?<span class="id">M1</span> ⦂ ?<span class="id">M2</span> ◎ (?χ, ?ϕ::?ψ) ⊨ ?<span class="id">A1</span> |- <span class="id">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">notHyp</span> (<span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ (χ, ϕ::ψ) ⊨ <span class="id">A2</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">H</span>' := <span class="tactic">fresh</span> <span class="kwd">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">H</span>' : <span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ (χ, ϕ::ψ) ⊨ <span class="id">A2</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="tactic">apply</span> (<span class="id">entails_implies</span> <span class="id">M1</span> <span class="id">M2</span> χ ϕ ψ <span class="id">A1</span> <span class="id">Ha</span> <span class="id">A2</span> <span class="id">H</span>); <span class="tactic">eauto</span>|]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">Ha</span> : ?<span class="id">M1</span> ⦂ ?<span class="id">M2</span> ◎ ?σ ⊨ ?<span class="id">A</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hb</span> : ?<span class="id">M1</span> ⦂ ?<span class="id">M2</span> ◎ ?σ ⊨ ¬ ?<span class="id">A</span> |- <span class="id">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">sat_implies_not_nsat</span> <span class="kwd">in</span> <span class="id">Ha</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">Ha</span> : ?<span class="id">M1</span> ⦂ ?<span class="id">M2</span> ◎ ?σ ⊨ ¬ ?<span class="id">A</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hb</span> : ~ ?<span class="id">M1</span> ⦂ ?<span class="id">M2</span> ◎ ?σ ⊭ ?<span class="id">A</span> |- <span class="id">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Ha</span>; <span class="tactic">subst</span>; <span class="id">crush</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">and_forall_x_entails_1</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A1</span> <span class="id">A2</span>, <span class="id">entails</span> (<span class="id">A1</span> ∧ (∀<span class="id">x</span>∙<span class="id">A2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(∀<span class="id">x</span>∙(<span class="id">A1</span> ↑ 0 ∧ <span class="id">A2</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof297')">Proof.</div>
<div class="proofscript" id="proof297">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">ent</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">and_iff</span> <span class="kwd">in</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">andDestruct</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">all_x_prop</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">a_intros</span>; <span class="id">a_prop</span>.<br/>
<br/>
&nbsp;&nbsp;- <span class="id">admit</span>. <span class="comment">(*&nbsp;sbst&nbsp;n&nbsp;(raise&nbsp;n)&nbsp;A&nbsp;=&nbsp;A,&nbsp;and&nbsp;weakening&nbsp;with&nbsp;fresh&nbsp;var&nbsp;....&nbsp;is&nbsp;this&nbsp;going&nbsp;to&nbsp;be&nbsp;very&nbsp;difficult&nbsp;...&nbsp;&nbsp;*)</span><br/>
<br/>
&nbsp;&nbsp;- <span class="id">admit</span>. <span class="comment">(*&nbsp;construct&nbsp;inversion&nbsp;lemmas&nbsp;for&nbsp;fresh_x&nbsp;and&nbsp;fresh_x_σ&nbsp;*)</span><br/>
&nbsp;&nbsp;<br/>
Admitted.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">and_forall_x_entails_2</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A1</span> <span class="id">A2</span>, <span class="id">entails</span> (∀<span class="id">x</span>∙(<span class="id">A1</span> ↑ 0 ∧ <span class="id">A2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">A1</span> ∧ (∀<span class="id">x</span>∙<span class="id">A2</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof298')">Proof.</div>
<div class="proofscript" id="proof298">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">ent</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> (<span class="id">a_intros</span>; <span class="id">a_prop</span>).<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;variable&nbsp;map&nbsp;may&nbsp;not&nbsp;be&nbsp;empty&nbsp;because&nbsp;the&nbsp;vMap&nbsp;must&nbsp;always&nbsp;provide&nbsp;a&nbsp;mapping&nbsp;for&nbsp;`this`&nbsp;*)</span><br/>
<br/>
&nbsp;&nbsp;- <span class="id">admit</span>. <span class="comment">(*&nbsp;create&nbsp;fresh&nbsp;variable&nbsp;*)</span><br/>
<br/>
&nbsp;&nbsp;- <span class="id">admit</span>.<br/>
&nbsp;&nbsp;<br/>
Admitted.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">and_forall_x_entails_1</span> <span class="id">and_forall_x_entails_2</span> : <span class="id">chainmail_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">and_forall_x_equiv</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A1</span> <span class="id">A2</span>, <span class="id">equiv_a</span> (<span class="id">A1</span> ∧ (∀<span class="id">x</span>∙<span class="id">A2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(∀<span class="id">x</span>∙(<span class="id">A1</span> ↑ 0 ∧ <span class="id">A2</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof299')">Proof.</div>
<div class="proofscript" id="proof299">
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">chainmail_db</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">and_forall_x_equiv</span> : <span class="id">chainmail_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">and_exists_x_entails_1</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A1</span> <span class="id">A2</span>, <span class="id">entails</span> (<span class="id">A1</span> ∧ (∃<span class="id">x</span>∙<span class="id">A2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(∃<span class="id">x</span>∙(<span class="id">A1</span> ↑ 0 ∧ <span class="id">A2</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof300')">Proof.</div>
<div class="proofscript" id="proof300">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">ent</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">and_iff</span> <span class="kwd">in</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">andDestruct</span>.  <span class="tactic">rewrite</span> <span class="id">ex_x_prop</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hb</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">eexists</span>; <span class="id">eexists</span>; <span class="id">eexists</span>; <span class="tactic">repeat</span> <span class="tactic">split</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">chainmail_db</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">sbst_simpl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> (<span class="id">a_intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">a_prop</span>).<br/>
<br/>
&nbsp;&nbsp;- <span class="id">admit</span>. <span class="comment">(*&nbsp;introduce&nbsp;new&nbsp;fresh&nbsp;variable,&nbsp;show&nbsp;equivalence&nbsp;*)</span><br/>
<br/>
&nbsp;&nbsp;- <span class="id">admit</span>. <span class="comment">(*&nbsp;subst&nbsp;on&nbsp;raise&nbsp;and&nbsp;weakening&nbsp;*)</span><br/>
<br/>
&nbsp;&nbsp;- <span class="id">admit</span>. <span class="comment">(*&nbsp;follows&nbsp;directly&nbsp;from&nbsp;introducing&nbsp;an&nbsp;alternative&nbsp;fresh&nbsp;variable&nbsp;*)</span><br/>
&nbsp;&nbsp;<br/>
Admitted.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">and_exists_x_entails_2</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A1</span> <span class="id">A2</span>, <span class="id">entails</span> (∃<span class="id">x</span>∙(<span class="id">A1</span> ↑ 0 ∧ <span class="id">A2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">A1</span> ∧ (∃<span class="id">x</span>∙<span class="id">A2</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof301')">Proof.</div>
<div class="proofscript" id="proof301">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">ent</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> (<span class="id">a_intros</span>; <span class="id">a_prop</span>).<br/>
<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">ex_x_prop</span> <span class="kwd">in</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">destruct_exists_loo</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">andDestruct</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">sbst_simpl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> (<span class="id">a_intros</span>; <span class="id">a_prop</span>). <span class="comment">(*&nbsp;x1&nbsp;is&nbsp;fresh&nbsp;in&nbsp;A,&nbsp;and&nbsp;subst/raise&nbsp;with&nbsp;weakening&nbsp;gives&nbsp;the&nbsp;desired&nbsp;result&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">admit</span>.<br/>
<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">ex_x_prop</span> <span class="kwd">in</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">destruct_exists_loo</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">andDestruct</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">sbst_simpl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> (<span class="id">a_intros</span>; <span class="id">a_prop</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">sat_ex_x</span>; <span class="tactic">eauto</span>. <span class="comment">(*&nbsp;fresh&nbsp;inversion&nbsp;lemmas&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">admit</span>.<br/>
&nbsp;&nbsp;<br/>
Admitted.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">and_exists_x_entails_1</span> <span class="id">and_exists_x_entails_2</span> : <span class="id">chainmail_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">or_forall_x_entails_1</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A1</span> <span class="id">A2</span>, <span class="id">entails</span> (<span class="id">A1</span> ∨ (∀<span class="id">x</span>∙<span class="id">A2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(∀<span class="id">x</span>∙(<span class="id">A1</span> ↑ 0 ∨ <span class="id">A2</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof302')">Proof.</div>
<div class="proofscript" id="proof302">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">ent</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">or_iff</span> <span class="kwd">in</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">andDestruct</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">all_x_prop</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">sbst_simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">a_intros</span>; <span class="id">a_prop</span>.<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| [<span class="id">H</span> : <span class="id">_</span> \/ <span class="id">_</span> |- <span class="id">_</span>] =&gt; <span class="tactic">destruct</span> <span class="id">H</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;- <span class="id">left</span>. <span class="id">admit</span>. <span class="comment">(*&nbsp;sbst&nbsp;n&nbsp;(raise&nbsp;n)&nbsp;A&nbsp;=&nbsp;A,&nbsp;and&nbsp;weakening&nbsp;with&nbsp;fresh&nbsp;var&nbsp;....&nbsp;is&nbsp;this&nbsp;going&nbsp;to&nbsp;be&nbsp;very&nbsp;difficult????&nbsp;...&nbsp;&nbsp;*)</span><br/>
<br/>
&nbsp;&nbsp;- <span class="id">right</span>. <span class="id">admit</span>. <span class="comment">(*&nbsp;construct&nbsp;inversion&nbsp;lemmas&nbsp;for&nbsp;fresh_x&nbsp;and&nbsp;fresh_x_σ&nbsp;*)</span><br/>
&nbsp;&nbsp;<br/>
Admitted.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">or_forall_x_entails_2</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A1</span> <span class="id">A2</span>, <span class="id">entails</span> (∀<span class="id">x</span>∙(<span class="id">A1</span> ↑ 0 ∨ <span class="id">A2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">A1</span> ∨ (∀<span class="id">x</span>∙<span class="id">A2</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof303')">Proof.</div>
<div class="proofscript" id="proof303">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">ent</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> (<span class="id">a_intros</span>; <span class="id">a_prop</span>).<br/>
<br/>
&nbsp;&nbsp;- <span class="id">admit</span>. <span class="comment">(*&nbsp;create&nbsp;fresh&nbsp;variable&nbsp;*)</span><br/>
&nbsp;&nbsp;<br/>
Admitted.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">or_forall_x_entails_1</span> <span class="id">or_forall_x_entails_2</span> : <span class="id">chainmail_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">or_forall_x_equiv</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A1</span> <span class="id">A2</span>, <span class="id">equiv_a</span> (<span class="id">A1</span> ∨ (∀<span class="id">x</span>∙<span class="id">A2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(∀<span class="id">x</span>∙(<span class="id">A1</span> ↑ 0 ∨ <span class="id">A2</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof304')">Proof.</div>
<div class="proofscript" id="proof304">
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">chainmail_db</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">or_forall_x_equiv</span> : <span class="id">chainmail_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">or_exists_x_entails_1</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A1</span> <span class="id">A2</span>, <span class="id">entails</span> (<span class="id">A1</span> ∨ (∃<span class="id">x</span>∙<span class="id">A2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(∃<span class="id">x</span>∙(<span class="id">A1</span> ↑ 0 ∨ <span class="id">A2</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof305')">Proof.</div>
<div class="proofscript" id="proof305">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">ent</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="id">admit</span>.<br/>
&nbsp;&nbsp;<br/>
Admitted.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">or_exists_x_entails_2</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A1</span> <span class="id">A2</span>, <span class="id">entails</span> (∃<span class="id">x</span>∙(<span class="id">A1</span> ↑ 0 ∨ <span class="id">A2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">A1</span> ∨ (∃<span class="id">x</span>∙<span class="id">A2</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof306')">Proof.</div>
<div class="proofscript" id="proof306">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">ent</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="id">admit</span>.<br/>
&nbsp;&nbsp;<br/>
Admitted.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">or_exists_x_entails_1</span> <span class="id">or_exists_x_entails_2</span> : <span class="id">chainmail_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">or_exists_x_equiv</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A1</span> <span class="id">A2</span>, <span class="id">equiv_a</span> (<span class="id">A1</span> ∨ (∃<span class="id">x</span>∙<span class="id">A2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(∃<span class="id">x</span>∙(<span class="id">A1</span> ↑ 0 ∨ <span class="id">A2</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof307')">Proof.</div>
<div class="proofscript" id="proof307">
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">chainmail_db</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">or_exists_x_equiv</span> : <span class="id">chainmail_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">arr_cnf_1</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A1</span> <span class="id">A2</span>, <span class="id">entails</span> (<span class="id">A1</span> ⇒ <span class="id">A2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id">A1</span> ∧ <span class="id">A2</span>) ∨ (¬ <span class="id">A1</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof308')">Proof.</div>
<div class="proofscript" id="proof308">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">ent</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> (<span class="id">a_intros</span>; <span class="id">a_prop</span>).<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">sat_excluded_middle</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> (<span class="id">M1</span>:=<span class="id">M1</span>)(<span class="id">M2</span>:=<span class="id">M2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(σ:=(χ, ϕ::ψ))(<span class="id">A</span>:=<span class="id">A1</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">chainmail_db</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">arr_cnf_2</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A1</span> <span class="id">A2</span>, <span class="id">entails</span> ((<span class="id">A1</span> ∧ <span class="id">A2</span>) ∨ (¬ <span class="id">A1</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">A1</span> ⇒ <span class="id">A2</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof309')">Proof.</div>
<div class="proofscript" id="proof309">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">ent</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> (<span class="id">a_intros</span>; <span class="id">a_prop</span>).<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>; <span class="tactic">repeat</span> <span class="id">a_prop</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">arr_cnf_1</span> <span class="id">arr_cnf_2</span> : <span class="id">chainmail_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">arr_cnf_equiv</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A1</span> <span class="id">A2</span>, <span class="id">equiv_a</span> ((<span class="id">A1</span> ∧ <span class="id">A2</span>) ∨ (¬ <span class="id">A1</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">A1</span> ⇒ <span class="id">A2</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof310')">Proof.</div>
<div class="proofscript" id="proof310">
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">chainmail_db</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">arr_cnf_equiv</span> : <span class="id">chainmail_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">and_entails</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A1</span> <span class="id">A2</span>, <span class="id">entails</span> <span class="id">A1</span> <span class="id">A2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span>, <span class="id">entails</span> (<span class="id">A1</span> ∧ <span class="id">A</span>) (<span class="id">A2</span> ∧ <span class="id">A</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof311')">Proof.</div>
<div class="proofscript" id="proof311">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">ent</span>; <span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">a_prop</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">chainmail_db</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">or_entails</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A1</span> <span class="id">A2</span>, <span class="id">entails</span> <span class="id">A1</span> <span class="id">A2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span>, <span class="id">entails</span> (<span class="id">A1</span> ∨ <span class="id">A</span>) (<span class="id">A2</span> ∨ <span class="id">A</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof312')">Proof.</div>
<div class="proofscript" id="proof312">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">ent</span>; <span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">a_prop</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span> : <span class="id">_</span> \/ <span class="id">_</span> |- <span class="id">_</span>] =&gt; <span class="tactic">destruct</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">a_prop</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">chainmail_db</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">neg_entails</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A1</span> <span class="id">A2</span>, <span class="id">equiv_a</span> <span class="id">A1</span> <span class="id">A2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">entails</span> (¬ <span class="id">A1</span>) (¬ <span class="id">A2</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof313')">Proof.</div>
<div class="proofscript" id="proof313">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">ent</span>; <span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">a_prop</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">chainmail_db</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">sat_excluded_middle</span> <span class="id">M1</span> <span class="id">M2</span> (χ, ϕ::ψ) <span class="id">A2</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">chainmail_db</span>.<br/>
<br/>
&nbsp;&nbsp;- <span class="tactic">unfold</span> <span class="id">equiv_a</span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">andDestruct</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">Ha</span> : <span class="id">entails</span> <span class="id">_</span> <span class="id">_</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hb</span> : <span class="id">entails</span> <span class="id">_</span> <span class="id">_</span> |- <span class="id">_</span>] =&gt; <span class="tactic">inversion</span> <span class="id">Ha</span>; <span class="tactic">inversion</span> <span class="id">Hb</span>; <span class="tactic">subst</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H4</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">sat_implies_not_nsat</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H0</span>; <span class="id">crush</span>.<br/>
Qed.</div>
<br/>
<br/>
<span class="kwd">Inductive</span> <span class="id">ltac_No_arg</span> : <span class="kwd">Set</span> :=<br/>
&nbsp;&nbsp;| <span class="id">ltac_no_arg</span> : <span class="id">ltac_No_arg</span>.<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">a_exists_base</span> <span class="id">y</span>' <span class="id">v</span>' <span class="id">z</span>' :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">type</span> <span class="id">of</span> <span class="id">z</span>' <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id">ltac_No_arg</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">type</span> <span class="id">of</span> <span class="id">v</span>' <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">ltac_No_arg</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [|- <span class="id">_</span> ⦂ <span class="id">_</span> ◎ <span class="id">_</span> ⊨ (∃<span class="id">x</span>∙<span class="id">_</span>)] =&gt; <span class="tactic">eapply</span> <span class="id">sat_ex_x</span> <span class="kwd">with</span> (<span class="id">y</span>:=<span class="id">y</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [|- <span class="id">_</span> ⦂ <span class="id">_</span> ◎ <span class="id">_</span> ⊨ (∃<span class="id">x</span>∙<span class="id">_</span>)] =&gt; <span class="tactic">eapply</span> <span class="id">sat_ex_x</span> <span class="kwd">with</span> (<span class="id">y</span>:=<span class="id">y</span>')(<span class="id">v</span>:=<span class="id">v</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [|- <span class="id">_</span> ⦂ <span class="id">_</span> ◎ <span class="id">_</span> ⊨ (∃<span class="id">x</span>∙<span class="id">_</span>)] =&gt; <span class="tactic">eapply</span> <span class="id">sat_ex_x</span> <span class="kwd">with</span> (<span class="id">y</span>:=<span class="id">y</span>')(<span class="id">v</span>:=<span class="id">v</span>')(<span class="id">z</span>:=<span class="id">z</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">a_exists</span>" <span class="id">constr</span>(<span class="id">x</span>) :=<br/>
&nbsp;&nbsp;<span class="id">a_exists_base</span> <span class="id">x</span> <span class="id">ltac_no_arg</span> <span class="id">ltac_no_arg</span>.<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">a_exists</span>" <span class="id">constr</span>(<span class="id">x</span>) <span class="id">constr</span>(<span class="id">y</span>) :=<br/>
&nbsp;&nbsp;<span class="id">a_exists_base</span> <span class="id">x</span> <span class="id">y</span> <span class="id">ltac_no_arg</span>.<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">a_exists</span>" <span class="id">constr</span>(<span class="id">x</span>) <span class="id">constr</span>(<span class="id">y</span>) <span class="id">constr</span>(<span class="id">z</span>) :=<br/>
&nbsp;&nbsp;<span class="id">a_exists_base</span> <span class="id">x</span> <span class="id">y</span> <span class="id">z</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">a_contradiction_1</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">M1</span> <span class="id">M2</span> σ <span class="id">A</span>, (<span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ ⊨ <span class="id">A</span> -&gt; <span class="id">False</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ ⊨ ¬ <span class="id">A</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof314')">Proof.</div>
<div class="proofscript" id="proof314">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">sat_excluded_middle</span> <span class="id">M1</span> <span class="id">M2</span> σ <span class="id">A</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">chainmail_db</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">crush</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">a_contradiction_2</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">M1</span> <span class="id">M2</span> σ <span class="id">A</span>, (<span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ ⊨ <span class="id">A</span> -&gt; <span class="id">False</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ ⊭ <span class="id">A</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof315')">Proof.</div>
<div class="proofscript" id="proof315">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">sat_excluded_middle</span> <span class="id">M1</span> <span class="id">M2</span> σ <span class="id">A</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">chainmail_db</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">crush</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">a_contradiction_3</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">M1</span> <span class="id">M2</span> σ <span class="id">A</span>, (<span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ ⊨ (¬ <span class="id">A</span>) -&gt; <span class="id">False</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ ⊨ <span class="id">A</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof316')">Proof.</div>
<div class="proofscript" id="proof316">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">sat_excluded_middle</span> <span class="id">M1</span> <span class="id">M2</span> σ <span class="id">A</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">chainmail_db</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">crush</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">not_implies_nsat</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">M1</span> <span class="id">M2</span> σ <span class="id">A</span>, <span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ ⊨ (¬ <span class="id">A</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ ⊭ <span class="id">A</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof317')">Proof.</div>
<div class="proofscript" id="proof317">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Ltac</span> <span class="id">a_contra_base</span> <span class="id">H</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">type</span> <span class="id">of</span> <span class="id">H</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id">ltac_No_arg</span> =&gt; <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [|- <span class="id">_</span> ⦂ <span class="id">_</span> ◎ <span class="id">_</span> ⊨ ¬ <span class="id">_</span>] =&gt; <span class="tactic">apply</span> <span class="id">a_contradiction_1</span>; <span class="tactic">intros</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [|- <span class="id">_</span> ⦂ <span class="id">_</span> ◎ <span class="id">_</span> ⊭ <span class="id">_</span>] =&gt; <span class="tactic">apply</span> <span class="id">a_contradiction_2</span>; <span class="tactic">intros</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [|- <span class="id">_</span> ⦂ <span class="id">_</span> ◎ <span class="id">_</span> ⊨ <span class="id">_</span>] =&gt; <span class="tactic">apply</span> <span class="id">a_contradiction_3</span>; <span class="tactic">intros</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span> : ?<span class="id">M1</span> ⦂ ?<span class="id">M2</span> ◎ ?σ ⊨ ¬ ?<span class="id">A</span> |- <span class="id">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">not_implies_nsat</span>, <span class="id">nsat_implies_not_sat</span> <span class="kwd">in</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contradiction</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span> : ?<span class="id">M1</span> ⦂ ?<span class="id">M2</span> ◎ ?σ ⊭ ?<span class="id">A</span> |- <span class="id">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">nsat_implies_not_sat</span> <span class="kwd">in</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contradiction</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">a_contra</span>" :=<br/>
&nbsp;&nbsp;<span class="id">a_contra_base</span> <span class="id">ltac_no_arg</span>.<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">a_contra</span>" <span class="id">constr</span>(<span class="id">H</span>) :=<br/>
&nbsp;&nbsp;<span class="id">a_contra_base</span> <span class="id">H</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">next_neg</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">M1</span> <span class="id">M2</span> σ <span class="id">A</span>, <span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ ⊨ (¬ <span class="id">a_next</span> <span class="id">A</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> χ ϕ ψ, σ = (χ, ϕ::ψ) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> σ' σ'', <span class="id">M1</span> ⦂ <span class="id">M2</span> ⦿ (χ, ϕ::<span class="id">nil</span>) ⤳ σ' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ ◁ σ' ≜ σ'' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ'' ⊨ (¬ <span class="id">A</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof318')">Proof.</div>
<div class="proofscript" id="proof318">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">a_contra</span>.<br/>
&nbsp;&nbsp;<span class="id">a_contra</span> <span class="id">H</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">chainmail_db</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">will_neg</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">M1</span> <span class="id">M2</span> σ <span class="id">A</span>, <span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ ⊨ (¬ <span class="id">a_will</span> <span class="id">A</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> χ ϕ ψ, σ = (χ, ϕ::ψ) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> σ' σ'', <span class="id">M1</span> ⦂ <span class="id">M2</span> ⦿ (χ, ϕ::<span class="id">nil</span>) ⤳⋆ σ' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ ◁ σ' ≜ σ'' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ'' ⊨ (¬ <span class="id">A</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof319')">Proof.</div>
<div class="proofscript" id="proof319">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">a_contra</span>.<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| [<span class="id">H</span> : <span class="id">_</span> ⦂ <span class="id">_</span> ◎ <span class="id">_</span> ⊨ (¬ <span class="id">a_will</span> <span class="id">_</span>) |- <span class="id">_</span>] =&gt; <span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;<span class="id">a_contra</span> <span class="id">H</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">chainmail_db</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">next_disj_1</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A1</span> <span class="id">A2</span>, <span class="id">entails</span> (<span class="id">a_next</span> (<span class="id">A1</span> ∨ <span class="id">A2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id">a_next</span> <span class="id">A1</span>) ∨ (<span class="id">a_next</span> <span class="id">A2</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof320')">Proof.</div>
<div class="proofscript" id="proof320">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">ent</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">sat_excluded_middle</span> <span class="id">M1</span> <span class="id">M2</span> (χ, ϕ::ψ) (<span class="id">a_next</span> <span class="id">A1</span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">chainmail_db</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">inversion</span> <span class="id">H0</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span> : (<span class="id">_</span>, <span class="id">_</span>) = (<span class="id">_</span>, <span class="id">_</span>)|- <span class="id">_</span>] =&gt; <span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span>; <span class="tactic">clear</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">pair_reduction_unique</span> <span class="kwd">with</span> (σ1:=σ'0) <span class="kwd">in</span> <span class="id">H3</span>; <span class="tactic">auto</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">a_prop</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H8</span>.<br/>
<br/>
&nbsp;&nbsp;- <span class="id">left</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">chainmail_db</span>.<br/>
&nbsp;&nbsp;- <span class="id">right</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">chainmail_db</span>.<br/>
<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">next_disj_2</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A1</span> <span class="id">A2</span>, <span class="id">entails</span> ((<span class="id">a_next</span> <span class="id">A1</span>) ∨ (<span class="id">a_next</span> <span class="id">A2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">a_next</span> (<span class="id">A1</span> ∨ <span class="id">A2</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof321')">Proof.</div>
<div class="proofscript" id="proof321">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">ent</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">a_prop</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span> : (<span class="id">_</span>, <span class="id">_</span>) = (<span class="id">_</span>, <span class="id">_</span>)|- <span class="id">_</span>] =&gt; <span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span>; <span class="tactic">clear</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">sat_next</span> <span class="kwd">with</span> (ϕ:=ϕ0)(ψ:=ψ0)(χ:=χ0)(σ':=σ')(σ'':=σ''); <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">chainmail_db</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span> : (<span class="id">_</span>, <span class="id">_</span>) = (<span class="id">_</span>, <span class="id">_</span>)|- <span class="id">_</span>] =&gt; <span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span>; <span class="tactic">clear</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">sat_next</span> <span class="kwd">with</span> (ϕ:=ϕ0)(ψ:=ψ0)(χ:=χ0)(σ':=σ')(σ'':=σ''); <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">chainmail_db</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">next_disj_1</span> <span class="id">next_disj_2</span> : <span class="id">chainmail_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">next_disj_equiv</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A1</span> <span class="id">A2</span>, <span class="id">equiv_a</span> ((<span class="id">a_next</span> <span class="id">A1</span>) ∨ (<span class="id">a_next</span> <span class="id">A2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">a_next</span> (<span class="id">A1</span> ∨ <span class="id">A2</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof322')">Proof.</div>
<div class="proofscript" id="proof322">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">split</span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">chainmail_db</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">next_disj_equiv</span> : <span class="id">chainmail_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">will_not_disj</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A1</span> <span class="id">A2</span>, <span class="id">entails</span> (<span class="id">a_will</span> (<span class="id">A1</span> ∨ <span class="id">A2</span>) ∧ (¬ (<span class="id">a_will</span> <span class="id">A1</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">a_will</span> <span class="id">A2</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof323')">Proof.</div>
<div class="proofscript" id="proof323">
&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">ent</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="id">a_prop</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| [<span class="id">H</span> : (<span class="id">_</span>, <span class="id">_</span>) = (<span class="id">_</span>, <span class="id">_</span>)|- <span class="id">_</span>] =&gt; <span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span>; <span class="tactic">clear</span> <span class="id">H</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;<span class="id">a_prop</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H8</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">chainmail_db</span>.<br/>
&nbsp;&nbsp;<span class="id">a_contra</span> <span class="id">H0</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">chainmail_db</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">will_not_disj</span> : <span class="id">chainmail_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">will_disj_1</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A1</span> <span class="id">A2</span>, <span class="id">entails</span> (<span class="id">a_will</span> (<span class="id">A1</span> ∨ <span class="id">A2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id">a_will</span> <span class="id">A1</span>) ∨ (<span class="id">a_will</span> <span class="id">A2</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof324')">Proof.</div>
<div class="proofscript" id="proof324">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">ent</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">sat_excluded_middle</span> <span class="id">M1</span> <span class="id">M2</span> (χ, ϕ::ψ) (<span class="id">a_will</span> <span class="id">A1</span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">chainmail_db</span>.<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">a_prop</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hasrt</span> : <span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ (χ, ϕ :: ψ) ⊨ <span class="id">a_will</span> <span class="id">A2</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="tactic">apply</span> (<span class="id">entails_implies</span>) <span class="kwd">with</span> (<span class="id">A1</span>:=(<span class="id">a_will</span> (<span class="id">A1</span> ∨ <span class="id">A2</span>) ∧ (¬ <span class="id">a_will</span> <span class="id">A1</span>)));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">chainmail_db</span>|].<br/>
&nbsp;&nbsp;<span class="id">a_prop</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">will_disj_2</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A1</span> <span class="id">A2</span>, <span class="id">entails</span> ((<span class="id">a_will</span> <span class="id">A1</span>) ∨ (<span class="id">a_will</span> <span class="id">A2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">a_will</span> (<span class="id">A1</span> ∨ <span class="id">A2</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof325')">Proof.</div>
<div class="proofscript" id="proof325">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">ent</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">a_prop</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span> : (<span class="id">_</span>, <span class="id">_</span>) = (<span class="id">_</span>, <span class="id">_</span>)|- <span class="id">_</span>] =&gt; <span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span>; <span class="tactic">clear</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">sat_will</span> <span class="kwd">with</span> (ϕ:=ϕ0)(ψ:=ψ0)(χ:=χ0)(σ':=σ')(σ'':=σ''); <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">chainmail_db</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span> : (<span class="id">_</span>, <span class="id">_</span>) = (<span class="id">_</span>, <span class="id">_</span>)|- <span class="id">_</span>] =&gt; <span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span>; <span class="tactic">clear</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">sat_will</span> <span class="kwd">with</span> (ϕ:=ϕ0)(ψ:=ψ0)(χ:=χ0)(σ':=σ')(σ'':=σ''); <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">chainmail_db</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">will_disj_1</span> <span class="id">will_disj_2</span> : <span class="id">chainmail_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">will_disj_equiv</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A1</span> <span class="id">A2</span>, <span class="id">equiv_a</span> ((<span class="id">a_will</span> <span class="id">A1</span>) ∨ (<span class="id">a_will</span> <span class="id">A2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">a_will</span> (<span class="id">A1</span> ∨ <span class="id">A2</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof326')">Proof.</div>
<div class="proofscript" id="proof326">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">split</span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">chainmail_db</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">will_disj_equiv</span> : <span class="id">chainmail_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">prev_neg</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">M1</span> <span class="id">M2</span> σ <span class="id">A</span>, <span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ ⊨ (¬ <span class="id">a_prev</span> <span class="id">A</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">exists</span> σ0 σ' σ'', <span class="id">initial</span> σ0 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M1</span> ⦂ <span class="id">M2</span> ⦿ σ0 ⤳⋆ σ' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M1</span> ⦂ <span class="id">M2</span> ⦿ σ' ⤳ σ -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ ◁ σ' ≜ σ'' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ'' ⊨ (¬ <span class="id">A</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof327')">Proof.</div>
<div class="proofscript" id="proof327">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
Admitted.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">was_neg</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">M1</span> <span class="id">M2</span> σ <span class="id">A</span>, <span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ ⊨ (¬ <span class="id">a_was</span> <span class="id">A</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">exists</span> σ0 σ' σ'', <span class="id">initial</span> σ0 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M1</span> ⦂ <span class="id">M2</span> ⦿ σ0 ⤳⋆ σ' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M1</span> ⦂ <span class="id">M2</span> ⦿ σ' ⤳⋆ σ -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ ◁ σ' ≜ σ'' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ'' ⊨ (¬ <span class="id">A</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof328')">Proof.</div>
<div class="proofscript" id="proof328">
Admitted.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">prev_not_disj</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A1</span> <span class="id">A2</span>, <span class="id">entails</span> (<span class="id">a_prev</span> (<span class="id">A1</span> ∨ <span class="id">A2</span>) ∧ (<span class="id">a_prev</span> (¬ <span class="id">A1</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">a_prev</span> <span class="id">A2</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof329')">Proof.</div>
<div class="proofscript" id="proof329">
&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">ent</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">a_prop</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">sat_prev</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H5</span> σ0 σ' σ'' <span class="id">H1</span> <span class="id">H2</span> <span class="id">H3</span> <span class="id">H4</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">a_prop</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H5</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H0</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H10</span> σ0 σ' σ'' <span class="id">H1</span> <span class="id">H2</span> <span class="id">H3</span> <span class="id">H4</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">a_prop</span>.<br/>
Qed.</div>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">prev_disj</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A1</span> <span class="id">A2</span>, <span class="id">entails</span> ((<span class="id">a_prev</span> <span class="id">A1</span>) ∨ (<span class="id">a_prev</span> <span class="id">A2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">a_prev</span> (<span class="id">A1</span> ∨ <span class="id">A2</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof330')">Proof.</div>
<div class="proofscript" id="proof330">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">ent</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">a_prop</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">sat_prev</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H8</span> σ0 σ' σ'' <span class="id">H0</span> <span class="id">H1</span> <span class="id">H2</span> <span class="id">H3</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">a_prop</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">sat_prev</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H8</span> σ0 σ' σ'' <span class="id">H0</span> <span class="id">H1</span> <span class="id">H2</span> <span class="id">H3</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">a_prop</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">prev_disj</span> : <span class="id">chainmail_db</span>.<br/>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">will_was_1</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span>, <span class="id">entails</span> (<span class="id">a_will</span> (<span class="id">a_was</span> <span class="id">A</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id">a_was</span> <span class="id">A</span>) ∨ <span class="id">A</span> ∨ (<span class="id">a_will</span> <span class="id">A</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof331')">Proof.</div>
<div class="proofscript" id="proof331">
Admitted.</div>
 <br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">will_was_2</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span>, <span class="id">entails</span> ((<span class="id">a_was</span> <span class="id">A</span>) ∨ <span class="id">A</span> ∨ (<span class="id">a_will</span> <span class="id">A</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">a_will</span> (<span class="id">a_was</span> <span class="id">A</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof332')">Proof.</div>
<div class="proofscript" id="proof332">
Admitted.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">was_will</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span>, <span class="id">entails</span> (<span class="id">a_was</span> (<span class="id">a_will</span> <span class="id">A</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">a_will</span> (<span class="id">a_was</span> <span class="id">A</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof333')">Proof.</div>
<div class="proofscript" id="proof333">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">ent</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<br/>
Admitted.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">exists_adaptation</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> σ1 σ2, σ<span class="id">_wf</span> σ1 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ<span class="id">_wf</span> σ2 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> σ, σ1 ◁ σ2 ≜ σ.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof334')">Proof.</div>
<div class="proofscript" id="proof334">
&nbsp;&nbsp;<br/>
Admitted.</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">was_change_pair_reduction</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">M1</span> <span class="id">M2</span> σ' σ, <span class="id">M1</span> ⦂ <span class="id">M2</span> ⦿ σ' ⤳⋆ σ -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ<span class="id">_wf</span> σ' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span>, <span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ ⊨ <span class="id">A</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> σ'', σ ◁ σ' ≜ σ'' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ'' ⊨ (¬ <span class="id">A</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">exists</span> σ1 σ1' σ2 σ2', <span class="id">M1</span> ⦂ <span class="id">M2</span> ⦿ σ' ⤳⋆ σ1 /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M1</span> ⦂ <span class="id">M2</span> ⦿ σ1 ⤳ σ2 /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M1</span> ⦂ <span class="id">M2</span> ⦿ σ2 ⤳⋆ σ /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ ◁ σ1 ≜ σ1' /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ ◁ σ2 ≜ σ2' /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ1' ⊨ (¬ <span class="id">A</span>) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ2' ⊨ <span class="id">A</span>) \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">exists</span> σ<span class="id">a</span> σ<span class="id">b</span>, <span class="id">M1</span> ⦂ <span class="id">M2</span> ⦿ σ' ⤳⋆ σ<span class="id">a</span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M1</span> ⦂ <span class="id">M2</span> ⦿ σ<span class="id">a</span> ⤳ σ /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ ◁ σ<span class="id">a</span> ≜ σ<span class="id">b</span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ<span class="id">b</span> ⊨ (¬ <span class="id">A</span>)) \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">exists</span> σ<span class="id">a</span> σ<span class="id">b</span>, <span class="id">M1</span> ⦂ <span class="id">M2</span> ⦿ σ' ⤳ σ<span class="id">a</span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M1</span> ⦂ <span class="id">M2</span> ⦿ σ<span class="id">a</span> ⤳⋆ σ /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ ◁ σ<span class="id">a</span> ≜ σ<span class="id">b</span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ<span class="id">b</span> ⊨ <span class="id">A</span>) \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">M1</span> ⦂ <span class="id">M2</span> ⦿ σ' ⤳ σ).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof335')">Proof.</div>
<div class="proofscript" id="proof335">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">M1</span> <span class="id">M2</span> σ' σ <span class="id">Hred</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">Hred</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
<br/>
&nbsp;&nbsp;- <span class="id">specialize</span> (<span class="id">IHHred</span> (<span class="id">pair_reduction_preserves_config_wf</span> <span class="id">M1</span> <span class="id">M2</span> σ1 σ <span class="id">H</span> <span class="id">H0</span>) <span class="id">A</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">some</span>σ := <span class="tactic">fresh</span> "σ" <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">exists_adaptation</span> σ2 σ) <span class="kwd">as</span> [<span class="id">some</span>σ];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">loo_db</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">sat_excluded_middle</span> <span class="id">M1</span> <span class="id">M2</span> σ0 <span class="id">A</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">right</span>; <span class="id">right</span>; <span class="id">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">loo_db</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id">sat_not</span> <span class="kwd">in</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHHred</span> σ0 <span class="id">H4</span> <span class="id">H5</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">IHHred</span> <span class="kwd">as</span> [<span class="id">IH</span>|<span class="id">IH</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|<span class="tactic">destruct</span> <span class="id">IH</span> <span class="kwd">as</span> [<span class="id">IH</span>|<span class="id">IH</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|<span class="tactic">destruct</span> <span class="id">IH</span> <span class="kwd">as</span> [<span class="id">IH</span>|<span class="id">IH</span>]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="kwd">let</span> <span class="id">some</span>σ1 := <span class="tactic">fresh</span> "σ" <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">some</span>σ2 := <span class="tactic">fresh</span> "σ" <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">some</span>σ3 := <span class="tactic">fresh</span> "σ" <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">some</span>σ4 := <span class="tactic">fresh</span> "σ" <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">IH</span> <span class="kwd">as</span> [<span class="id">some</span>σ1 <span class="id">Htmp</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Htmp</span> <span class="kwd">as</span> [<span class="id">some</span>σ2 <span class="id">Htmp</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Htmp</span> <span class="kwd">as</span> [<span class="id">some</span>σ3 <span class="id">Htmp</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Htmp</span> <span class="kwd">as</span> [<span class="id">some</span>σ4];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">andDestruct</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">some</span>σ1, <span class="id">some</span>σ2, <span class="id">some</span>σ3, <span class="id">some</span>σ4;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">split</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">loo_db</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="kwd">let</span> <span class="id">some</span>σ1 := <span class="tactic">fresh</span> "σ" <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">some</span>σ2 := <span class="tactic">fresh</span> "σ" <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">IH</span> <span class="kwd">as</span> [<span class="id">some</span>σ1 <span class="id">Htmp</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Htmp</span> <span class="kwd">as</span> [<span class="id">some</span>σ2 <span class="id">Htmp</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">andDestruct</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> σ3, σ4;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">split</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">loo_db</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="kwd">let</span> <span class="id">some</span>σ1 := <span class="tactic">fresh</span> "σ" <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">some</span>σ2 := <span class="tactic">fresh</span> "σ" <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">IH</span> <span class="kwd">as</span> [<span class="id">some</span>σ1 <span class="id">Htmp</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Htmp</span> <span class="kwd">as</span> [<span class="id">some</span>σ2 <span class="id">Htmp</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">andDestruct</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> σ, σ0, <span class="id">some</span>σ1, <span class="id">some</span>σ2;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">split</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">loo_db</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">right</span>; <span class="id">left</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> σ, σ0;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">loo_db</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Print</span> <span class="id">pair_reductions</span>.<br/>
<br/>
<span class="kwd">Inductive</span> <span class="id">pair_reductions_alt</span> : <span class="id">mdl</span> -&gt; <span class="id">mdl</span> -&gt; <span class="id">config</span> -&gt; <span class="id">config</span> -&gt; <span class="kwd">Prop</span> :=<br/>
| <span class="id">prs_single</span>' : <span class="kwd">forall</span> <span class="id">M1</span> <span class="id">M2</span> σ1 σ2, <span class="id">M1</span> ⦂ <span class="id">M2</span> ⦿ σ1 ⤳ σ2 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pair_reductions_alt</span> <span class="id">M1</span> <span class="id">M2</span> σ1 σ2<br/>
| <span class="id">prs_trans</span>'  : <span class="kwd">forall</span> <span class="id">M1</span> <span class="id">M2</span> σ1 σ σ2, <span class="id">pair_reductions_alt</span> <span class="id">M1</span> <span class="id">M2</span> σ1 σ -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M1</span> ⦂ <span class="id">M2</span> ⦿ σ ⤳ σ2 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pair_reductions_alt</span> <span class="id">M1</span> <span class="id">M2</span> σ1 σ2.<br/>
<br/>
<span class="kwd">Hint</span> <span class="id">Constructors</span> <span class="id">pair_reductions_alt</span> : <span class="id">loo_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">pair_reductions_alt_implies_pair_reductions</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">M1</span> <span class="id">M2</span> σ1 σ2, <span class="id">pair_reductions_alt</span> <span class="id">M1</span> <span class="id">M2</span> σ1 σ2 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M1</span> ⦂ <span class="id">M2</span> ⦿ σ1 ⤳⋆ σ2.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof336')">Proof.</div>
<div class="proofscript" id="proof336">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">M1</span> <span class="id">M2</span> σ1 σ2 <span class="id">Hred</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">Hred</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">loo_db</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">pair_reductions_transitive</span> <span class="kwd">with</span> (σ2:=σ); <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">loo_db</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">pair_reductions_alt_implies_pair_reductions</span> : <span class="id">loo_db</span>.<br/>
<span class="kwd">Hint</span> <span class="id">Rewrite</span> <span class="id">pair_reductions_alt_implies_pair_reductions</span> : <span class="id">loo_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">pair_reductions_alt_extend</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">M1</span> <span class="id">M2</span> σ1 σ2, <span class="id">pair_reductions_alt</span> <span class="id">M1</span> <span class="id">M2</span> σ1 σ2 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> σ, <span class="id">M1</span> ⦂ <span class="id">M2</span> ⦿ σ ⤳ σ1 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pair_reductions_alt</span> <span class="id">M1</span> <span class="id">M2</span> σ σ2.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof337')">Proof.</div>
<div class="proofscript" id="proof337">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">M1</span> <span class="id">M2</span> σ1 σ2 <span class="id">Hred</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">Hred</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">loo_db</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">pair_reductions_implies_pair_reductions_alt</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">M1</span> <span class="id">M2</span> σ1 σ2, <span class="id">M1</span> ⦂ <span class="id">M2</span> ⦿ σ1 ⤳⋆ σ2 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pair_reductions_alt</span> <span class="id">M1</span> <span class="id">M2</span> σ1 σ2.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof338')">Proof.</div>
<div class="proofscript" id="proof338">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">M1</span> <span class="id">M2</span> σ1 σ2 <span class="id">Hred</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">Hred</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">loo_db</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">pair_reductions_alt_extend</span> <span class="kwd">with</span> (σ1:=σ); <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">loo_db</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">pair_reductions_implies_pair_reductions_alt</span> : <span class="id">loo_db</span>.<br/>
<span class="kwd">Hint</span> <span class="id">Rewrite</span> <span class="id">pair_reductions_implies_pair_reductions_alt</span> : <span class="id">loo_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">pair_reductions_alt_definition</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">M1</span> <span class="id">M2</span> σ1 σ2, <span class="id">M1</span> ⦂ <span class="id">M2</span> ⦿ σ1 ⤳⋆ σ2 &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">M1</span> ⦂ <span class="id">M2</span> ⦿ σ1 ⤳ σ2) \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">exists</span> σ, <span class="id">M1</span> ⦂ <span class="id">M2</span> ⦿ σ1 ⤳⋆ σ /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M1</span> ⦂ <span class="id">M2</span> ⦿ σ ⤳⋆ σ2).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof339')">Proof.</div>
<div class="proofscript" id="proof339">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">M1</span> <span class="id">M2</span> σ1 σ2;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="tactic">intro</span> <span class="id">Hred</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">Hred</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">loo_db</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="tactic">intro</span> <span class="id">Hred</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hred</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">loo_db</span>].<br/>
<br/>
&nbsp;&nbsp;- <span class="tactic">repeat</span> <span class="id">destruct_exists_loo</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">andDestruct</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">loo_db</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">pair_reductions_transitive</span>; <span class="tactic">eauto</span>.<br/>
<br/>
Qed.</div>
<br/>
<span class="kwd">Inductive</span> <span class="id">reductions</span> : <span class="id">mdl</span> -&gt; <span class="id">config</span> -&gt; <span class="id">config</span> -&gt; <span class="kwd">Prop</span> :=<br/>
| <span class="id">red_single</span> : <span class="kwd">forall</span> <span class="id">M</span> σ1 σ2, <span class="id">M</span> ∙ σ1 ⤳ σ2 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">reductions</span> <span class="id">M</span> σ1 σ2<br/>
| <span class="id">red_trans</span> : <span class="kwd">forall</span> <span class="id">M</span> σ1 σ2 σ3, <span class="id">reductions</span> <span class="id">M</span> σ1 σ2 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M</span> ∙ σ2 ⤳ σ3 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">reductions</span> <span class="id">M</span> σ1 σ3.<br/>
<br/>
<span class="kwd">Hint</span> <span class="id">Constructors</span> <span class="id">reductions</span> : <span class="id">loo_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">list_does_not_contain_itself</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">A</span> : <span class="kwd">Type</span>} (<span class="id">l</span> : <span class="id">list</span> <span class="id">A</span>) <span class="id">a</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">a</span> :: <span class="id">l</span> = <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">False</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof340')">Proof.</div>
<div class="proofscript" id="proof340">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">A</span> <span class="id">l</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">crush</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Inductive</span> <span class="id">substmt</span> : <span class="id">stmt</span> -&gt; <span class="id">stmt</span> -&gt; <span class="kwd">Prop</span> :=<br/>
| <span class="id">sub_eq1</span> : <span class="kwd">forall</span> <span class="id">s</span> <span class="id">s</span>', <span class="id">substmt</span> <span class="id">s</span> (<span class="id">s_stmts</span> <span class="id">s</span> <span class="id">s</span>')<br/>
| <span class="id">sub_eq2</span> : <span class="kwd">forall</span> <span class="id">s</span> <span class="id">s</span>', <span class="id">substmt</span> <span class="id">s</span> (<span class="id">s_stmts</span> <span class="id">s</span>' <span class="id">s</span>)<br/>
| <span class="id">sub_trns1</span> : <span class="kwd">forall</span> <span class="id">s</span> <span class="id">s1</span> <span class="id">s2</span>, <span class="id">substmt</span> <span class="id">s</span> <span class="id">s1</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">substmt</span> <span class="id">s</span> (<span class="id">s_stmts</span> <span class="id">s1</span> <span class="id">s2</span>)<br/>
| <span class="id">sub_trns2</span> : <span class="kwd">forall</span> <span class="id">s</span> <span class="id">s1</span> <span class="id">s2</span>, <span class="id">substmt</span> <span class="id">s</span> <span class="id">s2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">substmt</span> <span class="id">s</span> (<span class="id">s_stmts</span> <span class="id">s1</span> <span class="id">s2</span>).<br/>
<br/>
<span class="kwd">Hint</span> <span class="id">Constructors</span> <span class="id">substmt</span> : <span class="id">loo_db</span>.<br/>
<br/>
<span class="kwd">Parameter</span> <span class="id">stmt_not_strict_substatement_of_itself</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s</span> <span class="id">s</span>', <span class="id">substmt</span> <span class="id">s</span> <span class="id">s</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">s</span> = <span class="id">s</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">False</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">acyclic_reduction</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">M</span> σ1 σ2, <span class="id">M</span> ∙ σ1 ⤳ σ2 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ2 &lt;&gt; σ1.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof341')">Proof.</div>
<div class="proofscript" id="proof341">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">M</span> σ1 σ2 <span class="id">Hred</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">Hred</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">Hcontra</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
<br/>
&nbsp;&nbsp;- <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span> : (<span class="id">_</span>, <span class="id">_</span>) = (<span class="id">_</span>, <span class="id">_</span>) |- <span class="id">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">list_does_not_contain_itself</span> <span class="kwd">in</span> <span class="id">H8</span>; <span class="tactic">auto</span>.<br/>
<br/>
&nbsp;&nbsp;- <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span> : (<span class="id">_</span>, <span class="id">_</span>) = (<span class="id">_</span>, <span class="id">_</span>) |- <span class="id">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H7</span> <span class="kwd">in</span> <span class="id">H1</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H1</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">stmt_not_strict_substatement_of_itself</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">loo_db</span>.<br/>
<br/>
&nbsp;&nbsp;- <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span> : (<span class="id">_</span>, <span class="id">_</span>) = (<span class="id">_</span>, <span class="id">_</span>) |- <span class="id">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H8</span> <span class="kwd">in</span> <span class="id">H0</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H0</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">stmt_not_strict_substatement_of_itself</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">loo_db</span>.<br/>
<br/>
&nbsp;&nbsp;- <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span> : (<span class="id">_</span>, <span class="id">_</span>) = (<span class="id">_</span>, <span class="id">_</span>) |- <span class="id">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H7</span> <span class="kwd">in</span> <span class="id">H1</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H1</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">stmt_not_strict_substatement_of_itself</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">loo_db</span>.<br/>
<br/>
&nbsp;&nbsp;- <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span> : (<span class="id">_</span>, <span class="id">_</span>) = (<span class="id">_</span>, <span class="id">_</span>) |- <span class="id">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">list_does_not_contain_itself</span>; <span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;- <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span> : (<span class="id">_</span>, <span class="id">_</span>) = (<span class="id">_</span>, <span class="id">_</span>) |- <span class="id">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">list_does_not_contain_itself</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">acyclic_reduction</span> : <span class="id">loo_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">acyclic_reductions</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">M</span> σ1 σ2, <span class="id">reductions</span> <span class="id">M</span> σ1 σ2 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ2 &lt;&gt; σ1.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof342')">Proof.</div>
<div class="proofscript" id="proof342">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">M</span> σ1 σ2 <span class="id">Hred</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">Hred</span>.<br/>
<br/>
&nbsp;&nbsp;- <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">loo_db</span>.<br/>
<br/>
&nbsp;&nbsp;- <span class="tactic">intro</span> <span class="id">Hcontra</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<br/>
Admitted.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">acyclic_pair_reductions</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">M1</span> <span class="id">M2</span> σ1 σ2, <span class="id">M1</span> ⦂ <span class="id">M2</span> ⦿ σ1 ⤳⋆ σ2 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ1 &lt;&gt; σ2.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof343')">Proof.</div>
<div class="proofscript" id="proof343">
Admitted.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">pair_reductions_path_unique</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">M1</span> <span class="id">M2</span> σ1 σ2, <span class="id">M1</span> ⦂ <span class="id">M2</span> ⦿ σ1 ⤳ σ2 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> σ, <span class="id">M1</span> ⦂ <span class="id">M2</span> ⦿ σ1 ⤳⋆ σ -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M1</span> ⦂ <span class="id">M2</span> ⦿ σ ⤳⋆ σ2 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">False</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof344')">Proof.</div>
<div class="proofscript" id="proof344">
Admitted.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">adaptation_satisfaction</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">M1</span> <span class="id">M2</span> σ <span class="id">A</span>, <span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ ⊨ <span class="id">A</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> σ1 σ2 σ', σ1 ◁ σ2 ≜ σ -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ1 ◁ σ2 ≜ σ' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ' ⊨ <span class="id">A</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof345')">Proof.</div>
<div class="proofscript" id="proof345">
Admitted.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">will_change_pair_reduction</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">M1</span> <span class="id">M2</span> σ1 σ2, <span class="id">M1</span> ⦂ <span class="id">M2</span> ⦿ σ1 ⤳⋆ σ2 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> σ, σ<span class="id">_wf</span> σ -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ<span class="id">_wf</span> σ1 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> σ1' σ2', σ ◁ σ1 ≜ σ1' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ ◁ σ2 ≜ σ2' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span>, <span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ1' ⊨ <span class="id">A</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ2' ⊨ (¬ <span class="id">A</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">exists</span> σ<span class="id">a</span> σ<span class="id">b</span>, <span class="id">M1</span> ⦂ <span class="id">M2</span> ⦿ σ1 ⤳⋆ σ<span class="id">a</span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ ◁ σ<span class="id">a</span> ≜ σ<span class="id">b</span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ<span class="id">b</span> ⊨ (¬ <span class="id">A</span>) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> σ<span class="id">a</span>' σ<span class="id">b</span>', <span class="id">M1</span> ⦂ <span class="id">M2</span> ⦿ σ1 ⤳⋆ σ<span class="id">a</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M1</span> ⦂ <span class="id">M2</span> ⦿ σ<span class="id">a</span>' ⤳⋆ σ<span class="id">a</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ ◁ σ<span class="id">a</span>' ≜ σ<span class="id">b</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ<span class="id">b</span>' ⊨ <span class="id">A</span>)) \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">M1</span> ⦂ <span class="id">M2</span> ⦿ σ1 ⤳ σ2).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof346')">Proof.</div>
<div class="proofscript" id="proof346">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">M1</span> <span class="id">M2</span> σ1 σ2 <span class="id">Hred</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">Hred</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">loo_db</span>.<br/>
<br/>
&nbsp;&nbsp;- <span class="tactic">assert</span> (<span class="id">Hwf</span> : σ<span class="id">_wf</span> σ);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">loo_db</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">some</span>σ := <span class="tactic">fresh</span> "σ" <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">Hadapt</span> := <span class="tactic">fresh</span> "<span class="id">H</span>" <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">exists_adaptation</span> σ0 σ) <span class="kwd">as</span> [<span class="id">some</span>σ <span class="id">Hadapt</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">sat_excluded_middle</span> <span class="id">M1</span> <span class="id">M2</span> σ3 <span class="id">A</span>) <span class="kwd">as</span> [<span class="id">Hsat</span>|<span class="id">Hnsat</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHHred</span> σ0);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">auto_specialize</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHHred</span> <span class="id">some</span>σ σ2');<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">auto_specialize</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">specialize</span> (<span class="id">IHHred</span> <span class="id">A</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">auto_specialize</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">IHHred</span> <span class="kwd">as</span> [<span class="id">IH</span>|<span class="id">IH</span>].<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">repeat</span> <span class="id">destruct_exists_loo</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">andDestruct</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> σ4, σ5;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">split</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">loo_db</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">Hb</span> σ<span class="id">a</span>' σ<span class="id">b</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H7</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="tactic">apply</span> <span class="id">pair_reduction_unique</span> <span class="kwd">with</span> (σ2:=σ) <span class="kwd">in</span> <span class="id">H10</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">adaptation_satisfaction</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="tactic">apply</span> <span class="id">pair_reduction_unique</span> <span class="kwd">with</span> (σ2:=σ) <span class="kwd">in</span> <span class="id">H10</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hb</span>; <span class="tactic">auto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> σ2, σ2';<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">split</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">loo_db</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H7</span>; <span class="tactic">inversion</span> <span class="id">H8</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="tactic">apply</span> <span class="id">pair_reduction_unique</span> <span class="kwd">with</span> (σ2:=σ) <span class="kwd">in</span> <span class="id">H10</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">adaptation_satisfaction</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="tactic">apply</span> <span class="id">pair_reduction_unique</span> <span class="kwd">with</span> (σ2:=σ) <span class="kwd">in</span> <span class="id">H10</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">pair_reduction_unique</span> <span class="kwd">with</span> (σ2:=σ2) <span class="kwd">in</span> <span class="id">H15</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">adaptation_satisfaction</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="tactic">apply</span> <span class="id">pair_reduction_unique</span> <span class="kwd">with</span> (σ2:=σ) <span class="kwd">in</span> <span class="id">H10</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">pair_reductions_path_unique</span> <span class="kwd">with</span> (σ:=σ<span class="id">a</span>') <span class="kwd">in</span> <span class="id">IH</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">crush</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="tactic">apply</span> <span class="id">pair_reduction_unique</span> <span class="kwd">with</span> (σ2:=σ) <span class="kwd">in</span> <span class="id">H10</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">pair_reductions_path_unique</span> <span class="kwd">with</span> (σ:=σ<span class="id">a</span>') <span class="kwd">in</span> <span class="id">IH</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">crush</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">left</span>; <span class="id">exists</span> σ, σ3;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">split</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">loo_db</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="tactic">apply</span> <span class="id">sat_not</span>; <span class="tactic">auto</span>|<span class="tactic">intros</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">pair_reductions_path_unique</span> <span class="kwd">with</span> (σ:=σ<span class="id">a</span>') <span class="kwd">in</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">crush</span>.<br/>
Qed.</div>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">interpret_update</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> σ <span class="id">y</span> <span class="id">v</span> <span class="id">v</span>', ⌊ <span class="id">x</span> ⌋ (<span class="id">update_</span>σ<span class="id">_map</span> σ <span class="id">y</span> <span class="id">v</span>) ≜ <span class="id">v</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">x</span> &lt;&gt; <span class="id">y</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;⌊ <span class="id">x</span> ⌋ σ ≜ <span class="id">v</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof347')">Proof.</div>
<div class="proofscript" id="proof347">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> σ <span class="kwd">as</span> [χ ψ'];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> ψ' <span class="kwd">as</span> [|ϕ0 ψ0];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span> : <span class="id">_</span> = <span class="id">_</span> :: <span class="id">_</span> |- <span class="id">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">update</span>, <span class="id">t_update</span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;<span class="id">eq_auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">int_x</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">loo_db</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">interpret_update</span> : <span class="id">loo_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">class_of_update</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> σ <span class="id">y</span> <span class="id">v</span> <span class="id">C</span>, <span class="id">classOf</span> <span class="id">x</span> (<span class="id">update_</span>σ<span class="id">_map</span> σ <span class="id">y</span> <span class="id">v</span>) <span class="id">C</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">x</span> &lt;&gt; <span class="id">y</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">classOf</span> <span class="id">x</span> σ <span class="id">C</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof348')">Proof.</div>
<div class="proofscript" id="proof348">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">interpret_update</span> <span class="kwd">in</span> <span class="id">H1</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">cls_of</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">class_of_update</span> : <span class="id">loo_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">interpret_update_vMap</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> χ ϕ ψ <span class="id">v</span>, ⌊ <span class="id">x</span> ⌋ (χ, ϕ::ψ) ≜ <span class="id">v</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> ϕ' <span class="id">y</span> <span class="id">v</span>', <span class="id">vMap</span> ϕ = <span class="id">update</span> <span class="id">y</span> <span class="id">v</span>' (<span class="id">vMap</span> ϕ') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">x</span> &lt;&gt; <span class="id">y</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;⌊ <span class="id">x</span> ⌋ (χ, ϕ'::ψ) ≜ <span class="id">v</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof349')">Proof.</div>
<div class="proofscript" id="proof349">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span> : <span class="id">_</span> = <span class="id">_</span> :: <span class="id">_</span> |- <span class="id">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">update</span>, <span class="id">t_update</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">equal_f</span> <span class="kwd">with</span> (<span class="id">x0</span>:=<span class="id">x</span>) <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">eq_auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">int_x</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">crush</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">interpret_update_vMap</span> : <span class="id">loo_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">class_of_update_vMap</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> χ ϕ ψ <span class="id">C</span>, <span class="id">classOf</span> <span class="id">x</span> (χ, ϕ::ψ) <span class="id">C</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> ϕ' <span class="id">y</span> <span class="id">v</span>, <span class="id">vMap</span> ϕ = <span class="id">update</span> <span class="id">y</span> <span class="id">v</span> (<span class="id">vMap</span> ϕ') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">x</span> &lt;&gt; <span class="id">y</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">classOf</span> <span class="id">x</span> (χ, ϕ'::ψ) <span class="id">C</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof350')">Proof.</div>
<div class="proofscript" id="proof350">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">interpret_update_vMap</span> <span class="kwd">with</span> (ϕ':=ϕ')(<span class="id">y</span>:=<span class="id">y</span>)(<span class="id">v</span>':=<span class="id">v</span>) <span class="kwd">in</span> <span class="id">H2</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">cls_of</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">class_of_update_vMap</span> : <span class="id">loo_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">class_of_unique</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> σ <span class="id">C</span> <span class="id">C</span>', <span class="id">classOf</span> <span class="id">x</span> σ <span class="id">C</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">classOf</span> <span class="id">x</span> σ <span class="id">C</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">C</span>' = <span class="id">C</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof351')">Proof.</div>
<div class="proofscript" id="proof351">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H0</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">interpretation_rewrite</span>.<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| [<span class="id">H</span> : <span class="id">v_addr</span> ?α1 = <span class="id">v_addr</span> ?α2,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Ha</span> : ?<span class="id">f</span> ?α1 = <span class="id">Some</span> ?<span class="id">o1</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hb</span> : ?<span class="id">f</span> ?α2 = <span class="id">Some</span> ?<span class="id">o2</span> |- <span class="id">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Ha</span> <span class="kwd">in</span> <span class="id">Hb</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hb</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">class_of_unique</span> : <span class="id">loo_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">interpretation_same_variable_map</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> σ <span class="id">v</span>, ⌊ <span class="id">x</span> ⌋ σ ≜ <span class="id">v</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> χ ϕ ψ χ' ϕ' ψ',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ = (χ, ϕ::ψ) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">vMap</span> ϕ' = <span class="id">vMap</span> ϕ -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;⌊ <span class="id">x</span> ⌋ (χ', ϕ'::ψ') ≜ <span class="id">v</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof352')">Proof.</div>
<div class="proofscript" id="proof352">
&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| [<span class="id">H</span> : <span class="id">_</span>::<span class="id">_</span> = <span class="id">_</span>::<span class="id">_</span> |- <span class="id">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">int_x</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">loo_db</span>.<br/>
&nbsp;&nbsp;<span class="id">crush</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">interpretation_same_variable_map</span> : <span class="id">loo_db</span>.<br/>
<span class="kwd">Hint</span> <span class="id">Rewrite</span> <span class="id">interpretation_same_variable_map</span> : <span class="id">loo_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">class_of_same_variable_map</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> σ <span class="id">C</span>, <span class="id">classOf</span> <span class="id">x</span> σ <span class="id">C</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> χ ϕ ψ ϕ' ψ',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ = (χ, ϕ::ψ) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">vMap</span> ϕ' = <span class="id">vMap</span> ϕ -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">classOf</span> <span class="id">x</span> (χ, ϕ'::ψ') <span class="id">C</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof353')">Proof.</div>
<div class="proofscript" id="proof353">
&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">cls_of</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">loo_db</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">interpretation_same_variable_map</span> : <span class="id">loo_db</span>.<br/>
<span class="kwd">Hint</span> <span class="id">Rewrite</span> <span class="id">interpretation_same_variable_map</span> : <span class="id">loo_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">interpret_x_update_heap_fresh</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> α <span class="id">v</span>α χ ψ <span class="id">v</span>, ⌊ <span class="id">x</span> ⌋ (χ, ψ) ≜ <span class="id">v</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">v</span>', ⌊ <span class="id">x</span> ⌋ (<span class="id">update</span> α <span class="id">v</span>α χ, ψ) ≜ <span class="id">v</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">fresh_</span>χ χ α -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">v</span>' = <span class="id">v</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof354')">Proof.</div>
<div class="proofscript" id="proof354">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H0</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">crush</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">interpret_x_update_heap_fresh</span> : <span class="id">loo_db</span>.<br/>
<span class="kwd">Hint</span> <span class="id">Rewrite</span> <span class="id">interpret_x_update_heap_fresh</span> : <span class="id">loo_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">class_of_update_heap_fresh</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> α <span class="id">v</span> χ ψ <span class="id">C</span>, <span class="id">classOf</span> <span class="id">x</span> (χ, ψ) <span class="id">C</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">C</span>', <span class="id">classOf</span> <span class="id">x</span> (<span class="id">update</span> α <span class="id">v</span> χ, ψ) <span class="id">C</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">fresh_</span>χ χ α -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">C</span>' = <span class="id">C</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof355')">Proof.</div>
<div class="proofscript" id="proof355">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H0</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| [<span class="id">Ha</span> : ⌊ ?<span class="id">x</span> ⌋ (?χ, ?ψ) ≜ ?<span class="id">v1</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hb</span> : ⌊ ?<span class="id">x</span> ⌋ (?χ', ?ψ) ≜ ?<span class="id">v2</span> |- <span class="id">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">interpret_x_update_heap_fresh</span> <span class="kwd">in</span> <span class="id">Ha</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Ha</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">eq_dec</span> α α0);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">map_rewrite</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eq_auto</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">fresh_heap_none</span> <span class="kwd">in</span> <span class="id">H1</span>; <span class="id">crush</span>.<br/>
&nbsp;&nbsp;- <span class="id">crush</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">class_of_update_heap_fresh</span> : <span class="id">loo_db</span>.<br/>
<span class="kwd">Hint</span> <span class="id">Rewrite</span> <span class="id">class_of_update_heap_fresh</span> : <span class="id">loo_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">class_of_update_same_cname</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> σ <span class="id">C</span>, <span class="id">classOf</span> <span class="id">x</span> σ <span class="id">C</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> χ ψ, σ = (χ, ψ) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> α <span class="id">o</span> <span class="id">o</span>', χ α = <span class="id">Some</span> <span class="id">o</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cname</span> <span class="id">o</span>' = <span class="id">cname</span> <span class="id">o</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">C</span>', <span class="id">classOf</span> <span class="id">x</span> (<span class="id">update</span> α <span class="id">o</span>' χ, ψ) <span class="id">C</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">C</span>' = <span class="id">C</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof356')">Proof.</div>
<div class="proofscript" id="proof356">
<br/>
&nbsp;&nbsp;Admitted.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">reduction_different_classes_implies_method_call_or_rtrn</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">M</span> σ1 σ2, <span class="id">M</span> ∙ σ1 ⤳ σ2 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">C1</span> <span class="id">C2</span>, <span class="id">classOf</span> <span class="id">this</span> σ1 <span class="id">C1</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">classOf</span> <span class="id">this</span> σ2 <span class="id">C2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">C1</span> &lt;&gt; <span class="id">C2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">exists</span> χ1 ϕ1 ψ1 <span class="id">x0</span> <span class="id">y0</span> <span class="id">m</span> <span class="id">ps</span> <span class="id">s</span>, σ1 = (χ1, ϕ1::ψ1) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contn</span> ϕ1 = (<span class="id">c_stmt</span> (<span class="id">s_stmts</span> (<span class="id">s_meth</span> <span class="id">x0</span> <span class="id">y0</span> <span class="id">m</span> <span class="id">ps</span>) <span class="id">s</span>))) \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">exists</span> χ1 ϕ1 ψ1 <span class="id">x0</span>, σ1 = (χ1, ϕ1::ψ1) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contn</span> ϕ1 = (<span class="id">c_stmt</span> (<span class="id">s_rtrn</span> <span class="id">x0</span>))) \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">exists</span> χ1 ϕ1 ψ1 <span class="id">x0</span> <span class="id">s</span>, σ1 = (χ1, ϕ1::ψ1) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contn</span> ϕ1 = (<span class="id">c_stmt</span> (<span class="id">s_stmts</span> (<span class="id">s_rtrn</span> <span class="id">x0</span>) <span class="id">s</span>))).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof357')">Proof.</div>
<div class="proofscript" id="proof357">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">M</span> σ1 σ2 <span class="id">Hred</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">Hred</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="id">solve</span> [<span class="id">left</span>; <span class="tactic">repeat</span> <span class="id">eexists</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">loo_db</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="id">solve</span> [<span class="id">right</span>; <span class="id">left</span>; <span class="tactic">repeat</span> <span class="id">eexists</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">loo_db</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="id">solve</span> [<span class="id">right</span>; <span class="id">right</span>; <span class="tactic">repeat</span> <span class="id">eexists</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">loo_db</span>].<br/>
<br/>
&nbsp;&nbsp;- <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">class_of_same_variable_map</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(χ:=χ)(ϕ:=<span class="id">frm</span> (<span class="id">update</span> <span class="id">x</span> <span class="id">v</span> (<span class="id">vMap</span> ϕ)) (<span class="id">c_stmt</span> <span class="id">s</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(ψ:=ψ)(ϕ':=<span class="id">update_</span>ϕ<span class="id">_map</span> ϕ <span class="id">x</span> <span class="id">v</span>)(ψ':=ψ)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">in</span> <span class="id">H9</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Htmp</span> : (χ, <span class="id">update_</span>ϕ<span class="id">_map</span> ϕ <span class="id">x</span> <span class="id">v</span> :: ψ) = <span class="id">update_</span>σ<span class="id">_map</span> (χ, ϕ::ψ) <span class="id">x</span> <span class="id">v</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="tactic">auto</span>|<span class="tactic">rewrite</span> <span class="id">Htmp</span> <span class="kwd">in</span> <span class="id">H9</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span> : <span class="id">classOf</span> ?<span class="id">x</span> (<span class="id">update_</span>σ<span class="id">_map</span> <span class="id">_</span> ?<span class="id">y</span> <span class="id">_</span>) <span class="id">_</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hneq</span> : ?<span class="id">y</span> &lt;&gt; ?<span class="id">x</span> |- <span class="id">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">class_of_update</span> <span class="kwd">in</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|[<span class="id">C1</span> : <span class="id">cls</span>, <span class="id">C2</span> : <span class="id">cls</span>, <span class="id">H</span> : <span class="id">C1</span> &lt;&gt; <span class="id">C2</span> |- <span class="id">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contradiction</span> <span class="id">H</span>; <span class="tactic">subst</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">loo_db</span>.<br/>
<br/>
&nbsp;&nbsp;-  <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|[<span class="id">C1</span> : <span class="id">cls</span>, <span class="id">C2</span> : <span class="id">cls</span>, <span class="id">H</span> : <span class="id">C1</span> &lt;&gt; <span class="id">C2</span> |- <span class="id">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contradiction</span> <span class="id">H</span>; <span class="tactic">subst</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">class_of_same_variable_map</span> <span class="kwd">with</span> (ϕ':=ϕ)(ψ':=ψ) <span class="kwd">in</span> <span class="id">H12</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">class_of_update_same_cname</span> <span class="kwd">in</span> <span class="id">H12</span>; <span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;- <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|[<span class="id">C1</span> : <span class="id">cls</span>, <span class="id">C2</span> : <span class="id">cls</span>, <span class="id">H</span> : <span class="id">C1</span> &lt;&gt; <span class="id">C2</span> |- <span class="id">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contradiction</span> <span class="id">H</span>; <span class="tactic">subst</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">class_of_update_vMap</span> <span class="id">this</span>) <span class="kwd">with</span> (ϕ':=ϕ)(<span class="id">y</span>:=<span class="id">x</span>)(<span class="id">v</span>:=<span class="id">v_addr</span> α) <span class="kwd">in</span> <span class="id">H10</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">class_of_update_heap_fresh</span> <span class="kwd">with</span> (<span class="id">C</span>:=<span class="id">C1</span>) <span class="kwd">in</span> <span class="id">H10</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">wf_config_this_has_class</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> σ, σ<span class="id">_wf</span> σ -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">C</span>, <span class="id">classOf</span> <span class="id">this</span> σ <span class="id">C</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof358')">Proof.</div>
<div class="proofscript" id="proof358">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H0</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H2</span> <span class="kwd">as</span> [ϕ <span class="id">Htmp</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Htmp</span> <span class="kwd">as</span> [ψ'];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">andDestruct</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H4</span> ϕ (<span class="id">in_eq</span> ϕ ψ')).<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H4</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H2</span> <span class="kwd">as</span> [α <span class="id">Htmp</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Htmp</span> <span class="kwd">as</span> [<span class="id">o</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">andDestruct</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id">cname</span> <span class="id">o</span>).<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">cls_of</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">int_x</span>; <span class="tactic">simpl</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">reductions_implies_method_call_or_rtrn</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">M1</span> <span class="id">M2</span> σ1 σ2, <span class="id">M1</span> ⦂ <span class="id">M2</span> ⦿ σ1 ⤳… σ2 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ<span class="id">_wf</span> σ1 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">exists</span> χ1 ϕ1 ψ1 <span class="id">x0</span> <span class="id">y0</span> <span class="id">m</span> <span class="id">ps</span> <span class="id">s</span>, σ1 = (χ1, ϕ1::ψ1) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contn</span> ϕ1 = (<span class="id">c_stmt</span> (<span class="id">s_stmts</span> (<span class="id">s_meth</span> <span class="id">x0</span> <span class="id">y0</span> <span class="id">m</span> <span class="id">ps</span>) <span class="id">s</span>))) \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">exists</span> χ1 ϕ1 ψ1 <span class="id">x0</span>, σ1 = (χ1, ϕ1::ψ1) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contn</span> ϕ1 = (<span class="id">c_stmt</span> (<span class="id">s_rtrn</span> <span class="id">x0</span>))) \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">exists</span> χ1 ϕ1 ψ1 <span class="id">x0</span> <span class="id">s</span>, σ1 = (χ1, ϕ1::ψ1) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contn</span> ϕ1 = (<span class="id">c_stmt</span> (<span class="id">s_stmts</span> (<span class="id">s_rtrn</span> <span class="id">x0</span>) <span class="id">s</span>))).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof359')">Proof.</div>
<div class="proofscript" id="proof359">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">H</span>; <span class="tactic">subst</span>; <span class="tactic">auto</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">wf_config_this_has_class</span> σ <span class="id">H0</span>) <span class="kwd">as</span> [<span class="id">C</span>].<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hwf</span> : σ<span class="id">_wf</span> σ');<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="tactic">eapply</span> <span class="id">reduction_preserves_config_wf</span>; <span class="tactic">eauto</span>|].<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">wf_config_this_has_class</span> σ' <span class="id">Hwf</span>) <span class="kwd">as</span> [<span class="id">C</span>'].<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">Ha</span> : <span class="kwd">forall</span> <span class="id">_</span> : <span class="id">cls</span>, <span class="id">classOf</span> <span class="id">this</span> ?σ <span class="id">_</span> -&gt; <span class="id">_</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hb</span> : <span class="id">classOf</span> <span class="id">this</span> ?σ ?<span class="id">C</span> |- <span class="id">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">Ha</span> <span class="id">C</span> <span class="id">Hb</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">reduction_different_classes_implies_method_call_or_rtrn</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">Hcontra</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">crush</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">pair_reduction_change_implies_method_call</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">M1</span> <span class="id">M2</span> σ1 σ2, <span class="id">M1</span> ⦂ <span class="id">M2</span> ⦿ σ1 ⤳ σ2 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ<span class="id">_wf</span> σ1 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">exists</span> χ1 ϕ1 ψ1 <span class="id">x0</span> <span class="id">y0</span> <span class="id">m</span> <span class="id">ps</span> <span class="id">s</span>, σ1 = (χ1, ϕ1::ψ1) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contn</span> ϕ1 = (<span class="id">c_stmt</span> (<span class="id">s_stmts</span> (<span class="id">s_meth</span> <span class="id">x0</span> <span class="id">y0</span> <span class="id">m</span> <span class="id">ps</span>) <span class="id">s</span>))) \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">exists</span> χ1 ϕ1 ψ1 <span class="id">x0</span>, σ1 = (χ1, ϕ1::ψ1) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contn</span> ϕ1 = (<span class="id">c_stmt</span> (<span class="id">s_rtrn</span> <span class="id">x0</span>))) \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">exists</span> χ1 ϕ1 ψ1 <span class="id">x0</span> <span class="id">s</span>, σ1 = (χ1, ϕ1::ψ1) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contn</span> ϕ1 = (<span class="id">c_stmt</span> (<span class="id">s_stmts</span> (<span class="id">s_rtrn</span> <span class="id">x0</span>) <span class="id">s</span>))).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof360')">Proof.</div>
<div class="proofscript" id="proof360">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">reductions_implies_method_call_or_rtrn</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">was_change</span> :<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">M1</span> <span class="id">M2</span> σ <span class="id">A</span>, <span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ ⊨ <span class="id">A</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ ⊨ (<span class="id">a_was</span> (¬ <span class="id">A</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ ⊨ (<span class="id">a_was</span> (¬ <span class="id">A</span> ∧ (<span class="id">a_next</span> <span class="id">A</span>)))) /\<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">M1</span> <span class="id">M2</span> σ <span class="id">A</span>, <span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ ⊭ <span class="id">A</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ ⊭ (<span class="id">a_was</span> (¬ <span class="id">A</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ ⊭ (<span class="id">a_was</span> (¬ <span class="id">A</span> ∧ (<span class="id">a_next</span> <span class="id">A</span>)))).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof361')">Proof.</div>
<div class="proofscript" id="proof361">
Admitted.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">was_conjunction</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A1</span> <span class="id">A2</span>, <span class="id">entails</span> (<span class="id">a_was</span> (<span class="id">A1</span> ∧ <span class="id">A2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id">a_was</span> <span class="id">A1</span>) ∧ (<span class="id">a_was</span> <span class="id">A2</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof362')">Proof.</div>
<div class="proofscript" id="proof362">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">ent</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> (<span class="id">a_prop</span>).<br/>
<br/>
&nbsp;&nbsp;- <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span> : <span class="id">_</span> ⦂ <span class="id">_</span> ◎ <span class="id">_</span> ⊨ (<span class="id">a_was</span> (<span class="id">_</span> ∧ <span class="id">_</span>)) |- <span class="id">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">sat_was</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id">Ha</span> : <span class="id">initial</span> ?σ0,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hb</span> : ?<span class="id">M1</span> ⦂ ?<span class="id">M2</span> ⦿ ?σ0 ⤳⋆ ?σ',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hc</span> : <span class="kwd">forall</span> σ, <span class="id">initial</span> σ -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;?<span class="id">M1</span> ⦂ ?<span class="id">M2</span> ⦿ σ ⤳⋆ ?σ' -&gt;  <span class="id">_</span> |- <span class="id">exists</span> <span class="id">_</span> : <span class="id">config</span>, <span class="id">_</span> ] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">Hc</span> σ0 <span class="id">Ha</span> <span class="id">Hb</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">some</span>σ1 := <span class="tactic">fresh</span> "σ" <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">some</span>σ2 := <span class="tactic">fresh</span> "σ" <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">Htmp</span> := <span class="tactic">fresh</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hc</span> <span class="kwd">as</span> [<span class="id">some</span>σ1 <span class="id">Htmp</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Htmp</span> <span class="kwd">as</span> [<span class="id">some</span>σ2];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">some</span>σ1, <span class="id">some</span>σ2;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">andDestruct</span>; <span class="id">a_prop</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">split</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">loo_db</span>.<br/>
<br/>
&nbsp;&nbsp;- <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span> : <span class="id">_</span> ⦂ <span class="id">_</span> ◎ <span class="id">_</span> ⊨ (<span class="id">a_was</span> (<span class="id">_</span> ∧ <span class="id">_</span>)) |- <span class="id">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">sat_was</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id">Ha</span> : <span class="id">initial</span> ?σ0,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hb</span> : ?<span class="id">M1</span> ⦂ ?<span class="id">M2</span> ⦿ ?σ0 ⤳⋆ ?σ',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hc</span> : <span class="kwd">forall</span> σ, <span class="id">initial</span> σ -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;?<span class="id">M1</span> ⦂ ?<span class="id">M2</span> ⦿ σ ⤳⋆ ?σ' -&gt;  <span class="id">_</span> |- <span class="id">exists</span> <span class="id">_</span> : <span class="id">config</span>, <span class="id">_</span> ] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">Hc</span> σ0 <span class="id">Ha</span> <span class="id">Hb</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">some</span>σ1 := <span class="tactic">fresh</span> "σ" <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">some</span>σ2 := <span class="tactic">fresh</span> "σ" <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">Htmp</span> := <span class="tactic">fresh</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hc</span> <span class="kwd">as</span> [<span class="id">some</span>σ1 <span class="id">Htmp</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Htmp</span> <span class="kwd">as</span> [<span class="id">some</span>σ2];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">some</span>σ1, <span class="id">some</span>σ2;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">andDestruct</span>; <span class="id">a_prop</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">split</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">loo_db</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">was_conjunction</span> : <span class="id">chainmail_db</span>.<br/>
<span class="kwd">Hint</span> <span class="id">Rewrite</span> <span class="id">was_conjunction</span> : <span class="id">chainmail_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">pair_reductions_trans</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">M1</span> <span class="id">M2</span> σ1 σ2, <span class="id">M1</span> ⦂ <span class="id">M2</span> ⦿ σ1 ⤳⋆ σ2 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> σ3, <span class="id">M1</span> ⦂ <span class="id">M2</span> ⦿ σ2 ⤳⋆ σ3 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M1</span> ⦂ <span class="id">M2</span> ⦿ σ1 ⤳⋆ σ3.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof363')">Proof.</div>
<div class="proofscript" id="proof363">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">M1</span> <span class="id">M2</span> σ1 σ2 <span class="id">Hred</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">Hred</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">loo_db</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">pair_reductions_trans</span> : <span class="id">loo_db</span>.<br/>
<span class="kwd">Hint</span> <span class="id">Rewrite</span> <span class="id">pair_reductions_trans</span> : <span class="id">loo_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">finite_</span>ψ<span class="id">_top_frame</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> ϕ ψ, <span class="id">finite_</span>ψ (ϕ::ψ) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">finite_</span>ψ (ϕ::<span class="id">nil</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof364')">Proof.</div>
<div class="proofscript" id="proof364">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">finite_auto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H0</span>; <span class="tactic">subst</span>.<br/>
<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">H</span>, <span class="id">in_eq</span>.<br/>
<br/>
&nbsp;&nbsp;- <span class="id">crush</span>.<br/>
<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">finite_</span>ψ<span class="id">_top_frame</span> : <span class="id">loo_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">finite_</span>σ<span class="id">_top_frame</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> χ ϕ ψ, <span class="id">finite_</span>σ (χ, ϕ::ψ) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> χ', <span class="id">finite_</span>σ (χ', ϕ::<span class="id">nil</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof365')">Proof.</div>
<div class="proofscript" id="proof365">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">finite_</span>σ <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">loo_db</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">finite_</span>σ<span class="id">_top_frame</span> : <span class="id">loo_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">has_self_</span>σ<span class="id">_top_frame</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> χ ϕ ψ, <span class="id">has_self_</span>σ (χ, ϕ::ψ) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">has_self_</span>σ (χ, ϕ::<span class="id">nil</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof366')">Proof.</div>
<div class="proofscript" id="proof366">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">self_config</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H0</span>; <span class="tactic">subst</span>.<br/>
<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">H1</span>, <span class="id">in_eq</span>.<br/>
<br/>
&nbsp;&nbsp;- <span class="id">crush</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">has_self_</span>σ<span class="id">_top_frame</span> : <span class="id">loo_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">not_stuck_</span>σ<span class="id">_top_frame</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> χ ϕ ψ, <span class="id">not_stuck_</span>σ (χ, ϕ::ψ) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">not_stuck_</span>σ (χ, ϕ::<span class="id">nil</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof367')">Proof.</div>
<div class="proofscript" id="proof367">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">not_stuck_</span>σ.<br/>
&nbsp;&nbsp;<span class="id">destruct_exists_loo</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">andDestruct</span>.<br/>
&nbsp;&nbsp;<span class="id">crush</span>.<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">eexists</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">not_stuck_</span>σ<span class="id">_top_frame</span> : <span class="id">loo_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">waiting_</span>σ<span class="id">_top_frame</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> χ ϕ ψ, <span class="id">waiting_</span>σ (χ, ϕ::ψ) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">waiting_</span>σ (χ, ϕ::<span class="id">nil</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof368')">Proof.</div>
<div class="proofscript" id="proof368">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">waiting_</span>σ.<br/>
&nbsp;&nbsp;<span class="id">destruct_exists_loo</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">andDestruct</span>.<br/>
&nbsp;&nbsp;<span class="id">crush</span>.<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">eexists</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">waiting_</span>ψ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">crush</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">waiting_</span>σ<span class="id">_top_frame</span> : <span class="id">loo_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> σ<span class="id">_wf_top_frame</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> χ ϕ ψ, σ<span class="id">_wf</span> (χ, ϕ::ψ) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ<span class="id">_wf</span> (χ, ϕ::<span class="id">nil</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof369')">Proof.</div>
<div class="proofscript" id="proof369">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">config_wf</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">loo_db</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> σ<span class="id">_wf_top_frame</span> : <span class="id">loo_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">finite_</span>ϕ<span class="id">_update</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> ϕ, <span class="id">finite_</span>ϕ ϕ -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">y</span> <span class="id">v</span>, <span class="id">finite_</span>ϕ (<span class="id">update_</span>ϕ<span class="id">_map</span> ϕ <span class="id">y</span> <span class="id">v</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof370')">Proof.</div>
<div class="proofscript" id="proof370">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">finite_auto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> ϕ <span class="kwd">as</span> [<span class="id">m</span> <span class="id">c</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">map_db</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">finite_</span>ϕ<span class="id">_update</span> : <span class="id">loo_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">finite_</span>ψ<span class="id">_update</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> ψ, <span class="id">finite_</span>ψ ψ -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">y</span> <span class="id">v</span>, <span class="id">finite_</span>ψ (<span class="id">update_</span>ψ<span class="id">_map</span> ψ <span class="id">y</span> <span class="id">v</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof371')">Proof.</div>
<div class="proofscript" id="proof371">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">finite_</span>ψ <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> ψ <span class="kwd">as</span> [|ϕ' ψ'];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">crush</span>|].<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span>; <span class="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">loo_db</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">finite_</span>ψ<span class="id">_update</span> : <span class="id">loo_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">finite_</span>σ<span class="id">_update</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> σ, <span class="id">finite_</span>σ σ -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">y</span> <span class="id">v</span>, <span class="id">finite_</span>σ (<span class="id">update_</span>σ<span class="id">_map</span> σ <span class="id">y</span> <span class="id">v</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof372')">Proof.</div>
<div class="proofscript" id="proof372">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">finite_</span>σ <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">loo_db</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">finite_</span>σ<span class="id">_update</span> : <span class="id">loo_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">has_self_</span>σ<span class="id">_update</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> σ, <span class="id">has_self_</span>σ σ -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">y</span> <span class="id">v</span> <span class="id">A</span>, <span class="id">fresh_x_</span>σ <span class="id">y</span> σ <span class="id">A</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">has_self_</span>σ (<span class="id">update_</span>σ<span class="id">_map</span> σ <span class="id">y</span> <span class="id">v</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof373')">Proof.</div>
<div class="proofscript" id="proof373">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">self_config</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> ψ <span class="kwd">as</span> [|ϕ' ψ'];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">update_</span>ψ<span class="id">_map</span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">update_</span>ϕ<span class="id">_map</span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">crush</span>|].<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H2</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">self_frm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H1</span> ϕ' (<span class="id">in_eq</span> ϕ' ψ')).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H1</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">destruct_exists_loo</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">andDestruct</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">crush</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> α, <span class="id">o</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">eq_dec</span> <span class="id">y</span> <span class="id">this</span>) <span class="kwd">as</span> [<span class="id">Heq</span>|<span class="id">Hneq</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">map_rewrite</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eq_auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">fresh_x_</span>σ <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">destruct_exists_loo</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">andDestruct</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span> : (<span class="id">_</span>, <span class="id">_</span>) = (<span class="id">_</span>, <span class="id">_</span>) |- <span class="id">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span> : <span class="id">fresh_x</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> |- <span class="id">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">crush</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">H1</span>, <span class="id">in_cons</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">has_self_</span>σ<span class="id">_update</span> : <span class="id">loo_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">not_stuck_</span>σ<span class="id">_update</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> σ, <span class="id">not_stuck_</span>σ σ -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">y</span> <span class="id">v</span>, <span class="id">not_stuck_</span>σ (<span class="id">update_</span>σ<span class="id">_map</span> σ <span class="id">y</span> <span class="id">v</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof374')">Proof.</div>
<div class="proofscript" id="proof374">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">not_stuck_</span>σ.<br/>
&nbsp;&nbsp;<span class="id">destruct_exists_loo</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">andDestruct</span>.<br/>
&nbsp;&nbsp;<span class="id">crush</span>.<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">eexists</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">not_stuck_</span>σ<span class="id">_update</span> : <span class="id">loo_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">waiting_</span>σ<span class="id">_update</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> σ, <span class="id">waiting_</span>σ σ -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">y</span> <span class="id">v</span>, <span class="id">waiting_</span>σ (<span class="id">update_</span>σ<span class="id">_map</span> σ <span class="id">y</span> <span class="id">v</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof375')">Proof.</div>
<div class="proofscript" id="proof375">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">waiting_</span>σ.<br/>
&nbsp;&nbsp;<span class="id">destruct_exists_loo</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">andDestruct</span>.<br/>
&nbsp;&nbsp;<span class="id">crush</span>.<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">eexists</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">waiting_</span>σ<span class="id">_update</span> : <span class="id">loo_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> σ<span class="id">_wf_update</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> σ, σ<span class="id">_wf</span> σ -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">y</span> <span class="id">v</span> <span class="id">A</span>, <span class="id">fresh_x_</span>σ <span class="id">y</span> σ <span class="id">A</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ<span class="id">_wf</span> (<span class="id">update_</span>σ<span class="id">_map</span> σ <span class="id">y</span> <span class="id">v</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof376')">Proof.</div>
<div class="proofscript" id="proof376">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">config_wf</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">loo_db</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> σ<span class="id">_wf_update</span> : <span class="id">loo_db</span>.<br/>
<br/>
<span class="kwd">Notation</span> "'<span class="id">a</span>♢' <span class="id">n</span>" := (<span class="id">a_hole</span> <span class="id">n</span>)(<span class="tactic">at</span> <span class="id">level</span> 40).<br/>
<span class="kwd">Notation</span> "'<span class="id">e</span>♢' <span class="id">n</span>" := (<span class="id">e_hole</span> <span class="id">n</span>)(<span class="tactic">at</span> <span class="id">level</span> 40).<br/>
<span class="kwd">Notation</span> "'<span class="id">a_</span>' <span class="id">x</span>" := (<span class="id">a_bind</span> <span class="id">x</span>)(<span class="tactic">at</span> <span class="id">level</span> 40).<br/>
<span class="kwd">Notation</span> "'<span class="id">e_</span>' <span class="id">x</span>" := (<span class="id">e_var</span> <span class="id">x</span>)(<span class="tactic">at</span> <span class="id">level</span> 40).<br/>
<span class="kwd">Notation</span> "<span class="id">e1</span> '⩦' <span class="id">e2</span>" := (<span class="id">a_eq</span> <span class="id">e1</span> <span class="id">e2</span>)(<span class="tactic">at</span> <span class="id">level</span> 40).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">guards</span> (<span class="id">x</span> <span class="id">y</span> : <span class="id">a_var</span>) : <span class="id">asrt</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">x</span>, <span class="id">y</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id">a_</span> <span class="id">x</span>', <span class="id">a_</span> <span class="id">y</span>' =&gt; (∀<span class="id">x</span>∙((¬ ((<span class="id">a</span>♢ 0) <span class="id">access</span> <span class="id">y</span>)) ∨ ((<span class="id">e</span>♢ 0) ⩦ (<span class="id">e_</span> <span class="id">x</span>'))))<br/>
&nbsp;&nbsp;| <span class="id">a_</span> <span class="id">x</span>', <span class="id">a</span>♢ <span class="id">n</span> =&gt; (∀<span class="id">x</span>∙((¬ ((<span class="id">a</span>♢ 0) <span class="id">access</span> (<span class="id">a</span>♢ (<span class="id">S</span> <span class="id">n</span>)))) ∨ ((<span class="id">e</span>♢ 0) ⩦ (<span class="id">e_</span> <span class="id">x</span>'))))<br/>
&nbsp;&nbsp;| <span class="id">a</span>♢ <span class="id">n</span>, <span class="id">a_</span> <span class="id">y</span>' =&gt; (∀<span class="id">x</span>∙((¬ ((<span class="id">a</span>♢ 0) <span class="id">access</span> <span class="id">y</span>)) ∨ ((<span class="id">e</span>♢ 0) ⩦ (<span class="id">e</span>♢ (<span class="id">S</span> <span class="id">n</span>)))))<br/>
&nbsp;&nbsp;| <span class="id">a</span>♢ <span class="id">n</span>, <span class="id">a</span>♢ <span class="id">m</span> =&gt; (∀<span class="id">x</span>∙((¬ ((<span class="id">a</span>♢ 0) <span class="id">access</span> (<span class="id">a</span>♢ (<span class="id">S</span> <span class="id">m</span>)))) ∨ ((<span class="id">e</span>♢ 0) ⩦ (<span class="id">e</span>♢ (<span class="id">S</span> <span class="id">n</span>)))))<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">has_self_</span>σ<span class="id">_this_interpretation</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> χ ϕ ψ, <span class="id">has_self_</span>σ (χ, ϕ::ψ) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> α <span class="id">o</span>, ⌊ <span class="id">this</span> ⌋ (χ, ϕ::ψ) ≜ (<span class="id">v_addr</span> α) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;χ α = <span class="id">Some</span> <span class="id">o</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof377')">Proof.</div>
<div class="proofscript" id="proof377">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| [<span class="id">H</span> : <span class="id">has_self_</span>σ ?σ |- <span class="id">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| [<span class="id">H</span> : <span class="kwd">forall</span> ϕ, <span class="id">In</span> ϕ (?ϕ::?ψ) -&gt; <span class="id">_</span> |- <span class="id">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> ϕ (<span class="id">in_eq</span> ϕ ψ));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">destruct_exists_loo</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">andDestruct</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> α, <span class="id">o</span>; <span class="tactic">split</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">int_x</span>; <span class="tactic">simpl</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">has_self_</span>σ<span class="id">_this_interpretation</span> : <span class="id">loo_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">wf_</span>σ<span class="id">_this_interpretation</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> χ ϕ ψ, σ<span class="id">_wf</span> (χ, ϕ::ψ) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> α <span class="id">o</span>, ⌊ <span class="id">this</span> ⌋ (χ, ϕ::ψ) ≜ (<span class="id">v_addr</span> α) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;χ α = <span class="id">Some</span> <span class="id">o</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof378')">Proof.</div>
<div class="proofscript" id="proof378">
&nbsp;&nbsp;<span class="tactic">intros</span> χ ϕ ψ <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">loo_db</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">wf_</span>σ<span class="id">_this_interpretation</span> : <span class="id">loo_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">update_map_implies_mapping</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">A</span> <span class="id">B</span> : <span class="kwd">Type</span>}`{<span class="id">Eq</span> <span class="id">A</span>} (<span class="id">f</span> : <span class="id">partial_map</span> <span class="id">A</span> <span class="id">B</span>) <span class="id">a</span> <span class="id">b</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f</span> <span class="id">a</span> = <span class="id">Some</span> <span class="id">b</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">a</span>' <span class="id">b</span>', <span class="id">exists</span> <span class="id">b</span>'', (<span class="id">update</span> <span class="id">a</span>' <span class="id">b</span>' <span class="id">f</span>) <span class="id">a</span> = <span class="id">Some</span> <span class="id">b</span>''.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof379')">Proof.</div>
<div class="proofscript" id="proof379">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">map_rewrite</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">eq_dec</span> <span class="id">a</span> <span class="id">a</span>');<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eq_auto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">update_map_implies_mapping</span> : <span class="id">map_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">reduction_heap_monotonic</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">M</span> σ1 σ2, <span class="id">M</span> ∙ σ1 ⤳ σ2 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> α <span class="id">o</span>, (<span class="id">fst</span> σ1) α = <span class="id">Some</span> <span class="id">o</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">o</span>', (<span class="id">fst</span> σ2) α = <span class="id">Some</span> <span class="id">o</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof380')">Proof.</div>
<div class="proofscript" id="proof380">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">M</span> σ1 σ2 <span class="id">Hred</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">Hred</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">map_db</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">reduction_heap_monotonic</span> : <span class="id">loo_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">reductions_heap_monotonic</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">M1</span> <span class="id">M2</span> σ1 σ2, <span class="id">M1</span> ⦂ <span class="id">M2</span> ⦿ σ1 ⤳… σ2 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> α <span class="id">o</span>, (<span class="id">fst</span> σ1) α = <span class="id">Some</span> <span class="id">o</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">o</span>', (<span class="id">fst</span> σ2) α = <span class="id">Some</span> <span class="id">o</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof381')">Proof.</div>
<div class="proofscript" id="proof381">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">M1</span> <span class="id">M2</span> σ1 σ2 <span class="id">Hred</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">Hred</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">loo_db</span>.<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| [<span class="id">Ha</span> : <span class="kwd">forall</span> α' <span class="id">o</span>', <span class="id">fst</span> ?σ1 α' = <span class="id">Some</span> <span class="id">o</span>' -&gt; <span class="id">exists</span> <span class="id">o</span>'', <span class="id">_</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hb</span> : <span class="id">fst</span> ?σ1 ?α = <span class="id">Some</span> ?<span class="id">o</span> |- <span class="id">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">Ha</span> α <span class="id">o</span> <span class="id">Hb</span>)<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct_exists_loo</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">loo_db</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">reductions_heap_monotonic</span> : <span class="id">loo_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">pair_reduction_heap_monotonic</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">M1</span> <span class="id">M2</span> σ1 σ2, <span class="id">M1</span> ⦂ <span class="id">M2</span> ⦿ σ1 ⤳ σ2 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> α <span class="id">o</span>, (<span class="id">fst</span> σ1) α = <span class="id">Some</span> <span class="id">o</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">o</span>', (<span class="id">fst</span> σ2) α = <span class="id">Some</span> <span class="id">o</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof382')">Proof.</div>
<div class="proofscript" id="proof382">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">M1</span> <span class="id">M2</span> σ1 σ2 <span class="id">Hred</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">Hred</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">loo_db</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">pair_reduction_heap_monotonic</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">pair_reductions_heap_monotonic</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">M1</span> <span class="id">M2</span> σ1 σ2, <span class="id">M1</span> ⦂ <span class="id">M2</span> ⦿ σ1 ⤳⋆ σ2 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> α <span class="id">o</span>, (<span class="id">fst</span> σ1) α = <span class="id">Some</span> <span class="id">o</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">o</span>', (<span class="id">fst</span> σ2) α = <span class="id">Some</span> <span class="id">o</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof383')">Proof.</div>
<div class="proofscript" id="proof383">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">M1</span> <span class="id">M2</span> σ1 σ2 <span class="id">Hred</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">Hred</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">loo_db</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">pair_reduction_heap_monotonic</span> <span class="id">M1</span> <span class="id">M2</span> σ1 σ <span class="id">H</span> α <span class="id">o</span>) <span class="kwd">as</span> [<span class="id">o</span>'];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| [<span class="id">Ha</span> : <span class="kwd">forall</span> α' <span class="id">o</span>', <span class="id">fst</span> ?σ α' = <span class="id">Some</span> <span class="id">o</span>' -&gt; <span class="id">exists</span> <span class="id">o</span>'', <span class="id">_</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hb</span> : <span class="id">fst</span> ?σ ?α = <span class="id">Some</span> ?<span class="id">o</span> |- <span class="id">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">Ha</span> α <span class="id">o</span> <span class="id">Hb</span>)<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct_exists_loo</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">loo_db</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">pair_reductions_heap_monotonic</span> : <span class="id">loo_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">has_self_adaptation</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> σ1 σ2, <span class="id">has_self_</span>σ σ1 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">has_self_</span>σ σ2 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> σ, σ1 ◁ σ2 ≜ σ -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> α <span class="id">o</span>, (<span class="id">fst</span> σ1) α = <span class="id">Some</span> <span class="id">o</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">o</span>', (<span class="id">fst</span> σ2) α = <span class="id">Some</span> <span class="id">o</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">has_self_</span>σ σ.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof384')">Proof.</div>
<div class="proofscript" id="proof384">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| [<span class="id">H</span> : ?σ1 ◁ ?σ2 ≜ ?σ |- <span class="id">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span> : <span class="id">has_self_</span>σ (?χ, ?ψ)  |- <span class="id">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">notHyp</span> (<span class="kwd">forall</span> ϕ : <span class="id">frame</span>, <span class="id">In</span> ϕ ψ -&gt; <span class="id">has_self_</span>ϕ χ ϕ);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">self_config</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ϕ <span class="id">Hin</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hin</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
<br/>
&nbsp;&nbsp;- <span class="tactic">repeat</span> <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span> : <span class="kwd">forall</span> ϕ' : <span class="id">frame</span>, <span class="id">In</span> ϕ' (?ϕ::?ψ) -&gt; <span class="id">has_self_</span>ϕ <span class="id">_</span> <span class="id">_</span> |- <span class="id">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> ϕ (<span class="id">in_eq</span> ϕ ψ));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">destruct_exists_loo</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">andDestruct</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span> : <span class="id">context</span> [<span class="id">vMap</span> <span class="id">_</span>] |- <span class="id">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">self_frm</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">fst</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|[<span class="id">Ha</span> : <span class="kwd">forall</span> α' <span class="id">o</span>', ?χ α' = <span class="id">Some</span> <span class="id">o</span>' -&gt; <span class="id">exists</span> <span class="id">_</span>, <span class="id">_</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hb</span> : ?χ ?α = <span class="id">Some</span> ?<span class="id">o</span> |- <span class="id">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">Ha</span> α <span class="id">o</span> <span class="id">Hb</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">destruct_exists_loo</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> α0, <span class="id">o1</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">extend_some_2</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">disjoint_dom_symmetry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">disjoint_composition</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">map_db</span>.<br/>
<br/>
&nbsp;&nbsp;- <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">Ha</span> : <span class="kwd">forall</span> ϕ', <span class="id">In</span> ϕ' (<span class="id">_</span>::?ψ) -&gt; <span class="id">has_self_</span>ϕ ?χ' ϕ',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hb</span> : <span class="id">In</span> ?ϕ ?ψ |- <span class="id">has_self_</span>ϕ ?χ' ?ϕ] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Ha</span>, <span class="id">in_cons</span>; <span class="tactic">auto</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">has_self_adaptation</span> : <span class="id">loo_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">extend_update</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">A</span> <span class="id">B</span> : <span class="kwd">Type</span>}`{<span class="id">Eq</span> <span class="id">A</span>}(<span class="id">f</span> <span class="id">g</span> : <span class="id">partial_map</span> <span class="id">A</span> <span class="id">B</span>) <span class="id">a</span> <span class="id">b</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">update</span> <span class="id">a</span> <span class="id">b</span> <span class="id">f</span>) ∪ <span class="id">g</span> = (<span class="id">update</span> <span class="id">a</span> <span class="id">b</span> (<span class="id">f</span> ∪ <span class="id">g</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof385')">Proof.</div>
<div class="proofscript" id="proof385">
&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">extend</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">map_rewrite</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">functional_extensionality</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">a</span>';<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">eq_dec</span> <span class="id">a</span>' <span class="id">a</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eq_auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">extend_update</span> : <span class="id">map_db</span>.<br/>
<span class="kwd">Hint</span> <span class="id">Rewrite</span> @<span class="id">extend_update</span> : <span class="id">map_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">finite_extend</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">A</span> <span class="id">B</span> : <span class="kwd">Type</span>}`{<span class="id">Eq</span> <span class="id">A</span>}(<span class="id">f</span> : <span class="id">partial_map</span> <span class="id">A</span> <span class="id">B</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">finite</span> <span class="id">f</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">g</span>, <span class="id">finite</span> <span class="id">g</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">finite</span> (<span class="id">f</span> ∪ <span class="id">g</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof386')">Proof.</div>
<div class="proofscript" id="proof386">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">A</span> <span class="id">B</span> <span class="id">HeqA</span> <span class="id">f</span> <span class="id">Hfin</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">Hfin</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">extend_update</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">map_db</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">finite_extend</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">compose_empty_right</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">A</span> <span class="id">B</span> <span class="id">C</span> : <span class="kwd">Type</span>}`{<span class="id">Eq</span> <span class="id">A</span>}{<span class="id">HeqB</span> : <span class="id">Eq</span> <span class="id">B</span>}(<span class="id">f</span> : <span class="id">partial_map</span> <span class="id">A</span> <span class="id">B</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f</span> ∘ (@<span class="id">empty</span> <span class="id">B</span> <span class="id">C</span> <span class="id">HeqB</span>)) = <span class="id">empty</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof387')">Proof.</div>
<div class="proofscript" id="proof387">
&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">functional_extensionality</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">a</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">map_rewrite</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">f</span> <span class="id">a</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">compose_empty_right</span> : <span class="id">map_db</span>.<br/>
<span class="kwd">Hint</span> <span class="id">Rewrite</span> @<span class="id">compose_empty_right</span> : <span class="id">map_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">compose_empty_left</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">A</span> <span class="id">B</span> <span class="id">C</span> : <span class="kwd">Type</span>}{<span class="id">HeqA</span> : <span class="id">Eq</span> <span class="id">A</span>}`{<span class="id">Eq</span> <span class="id">B</span>}(<span class="id">f</span> : <span class="id">partial_map</span> <span class="id">B</span> <span class="id">C</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;((@<span class="id">empty</span> <span class="id">A</span> <span class="id">B</span> <span class="id">HeqA</span>) ∘ <span class="id">f</span>) = <span class="id">empty</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof388')">Proof.</div>
<div class="proofscript" id="proof388">
&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">compose_empty_left</span> : <span class="id">map_db</span>.<br/>
<span class="kwd">Hint</span> <span class="id">Rewrite</span> @<span class="id">compose_empty_left</span> : <span class="id">map_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">finite_map_composition_2</span>' :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">A</span> <span class="id">B</span> <span class="id">C</span> : <span class="kwd">Type</span>}`{<span class="id">Eq</span> <span class="id">A</span>}`{<span class="id">Eq</span> <span class="id">B</span>}(<span class="id">g</span> : <span class="id">partial_map</span> <span class="id">B</span> <span class="id">C</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">finite_normal_form</span> <span class="id">g</span> -&gt; <span class="kwd">forall</span> (<span class="id">f</span> : <span class="id">partial_map</span> <span class="id">A</span> <span class="id">B</span>), <span class="id">one_to_one</span> <span class="id">f</span> -&gt; <span class="id">finite_normal_form</span> (<span class="id">f</span> ∘ <span class="id">g</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof389')">Proof.</div>
<div class="proofscript" id="proof389">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">A</span> <span class="id">B</span> <span class="id">C</span> <span class="id">HeqA</span> <span class="id">HeqB</span> <span class="id">g</span> <span class="id">Hfin</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">Hfin</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">f</span> <span class="id">H121</span>.<br/>
<br/>
&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">compose_empty_right</span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">map_db</span>.<br/>
<br/>
&nbsp;&nbsp;- <span class="tactic">destruct</span> (<span class="id">excluded_middle</span> (<span class="id">exists</span> <span class="id">a</span>', <span class="id">f</span> <span class="id">a</span>' = <span class="id">Some</span> <span class="id">a</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">destruct_exists_loo</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Heq</span> : <span class="id">f</span> ∘ (<span class="id">update</span> <span class="id">a</span> <span class="id">b</span> <span class="id">m</span>) = (<span class="id">update</span> <span class="id">x</span> <span class="id">b</span> (<span class="id">f</span> ∘ <span class="id">m</span>)));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="tactic">apply</span> <span class="id">functional_extensionality</span>; <span class="tactic">intros</span> <span class="id">a</span>'; <span class="tactic">simpl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="tactic">rewrite</span> <span class="id">Heq</span>; <span class="tactic">apply</span> <span class="id">norm_update</span>; <span class="tactic">auto</span>; <span class="id">crush</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">map_rewrite</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">partial_map_dec</span> <span class="id">a</span>' <span class="id">f</span>) <span class="kwd">as</span> [<span class="id">Hsome</span>|<span class="id">Hnone</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="tactic">destruct</span> <span class="id">Hsome</span> <span class="kwd">as</span> [<span class="id">b</span>' <span class="id">Htmp</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Htmp</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="tactic">rewrite</span> <span class="id">Hnone</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">destruct</span> (<span class="id">eq_dec</span> <span class="id">b</span>' <span class="id">a</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eq_auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="tactic">destruct</span> (<span class="id">eq_dec</span> <span class="id">a</span>' <span class="id">x</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eq_auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H121</span> <span class="id">x</span> <span class="id">a</span>' <span class="id">a</span> <span class="id">H0</span> <span class="id">Htmp</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">crush</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="tactic">destruct</span> (<span class="id">eq_dec</span> <span class="id">a</span>' <span class="id">x</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eq_auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">crush</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">destruct</span> (<span class="id">eq_dec</span> <span class="id">a</span>' <span class="id">x</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">crush</span>|<span class="id">eq_auto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">assert</span> (<span class="id">Heq</span> : <span class="id">f</span> ∘ <span class="id">update</span> <span class="id">a</span> <span class="id">b</span> <span class="id">m</span> = <span class="id">f</span> ∘ <span class="id">m</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="tactic">apply</span> <span class="id">functional_extensionality</span>; <span class="tactic">intros</span> <span class="id">a</span>';<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="tactic">rewrite</span> <span class="id">Heq</span>; <span class="tactic">auto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">partial_map_dec</span> <span class="id">a</span>' <span class="id">f</span>) <span class="kwd">as</span> [<span class="id">Hsome</span>|<span class="id">Hnone</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="tactic">destruct</span> <span class="id">Hsome</span> <span class="kwd">as</span> [<span class="id">b</span>' <span class="id">Hsome</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hsome</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="tactic">rewrite</span> <span class="id">Hnone</span>; <span class="tactic">auto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">map_rewrite</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">eq_dec</span> <span class="id">a</span> <span class="id">b</span>');<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eq_auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contradiction</span> <span class="id">n</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">finite_map_composition_2</span>' : <span class="id">map_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">finite_map_composition_2</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">A</span> <span class="id">B</span> <span class="id">C</span> : <span class="kwd">Type</span>}`{<span class="id">Eq</span> <span class="id">A</span>}`{<span class="id">Eq</span> <span class="id">B</span>}(<span class="id">g</span> : <span class="id">partial_map</span> <span class="id">B</span> <span class="id">C</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">finite</span> <span class="id">g</span> -&gt; <span class="kwd">forall</span> (<span class="id">f</span> : <span class="id">partial_map</span> <span class="id">A</span> <span class="id">B</span>), <span class="id">one_to_one</span> <span class="id">f</span> -&gt; <span class="id">finite</span> (<span class="id">f</span> ∘ <span class="id">g</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof390')">Proof.</div>
<div class="proofscript" id="proof390">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">map_db</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">finite_map_composition_2</span> : <span class="id">map_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">finite_adaptation</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> σ1 σ2, <span class="id">finite_</span>σ σ1 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">finite_</span>σ σ2 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> σ, σ1 ◁ σ2 ≜ σ -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">finite_</span>σ σ.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof391')">Proof.</div>
<div class="proofscript" id="proof391">
&nbsp;&nbsp;<span class="tactic">intros</span> σ1 σ2 <span class="id">Hfin1</span> <span class="id">Hfin2</span> σ <span class="id">Hadapt</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hadapt</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">finite_</span>σ, <span class="id">finite_</span>ψ, <span class="id">finite_</span>ϕ <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ϕ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">snd</span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">Hin</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hin</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="tactic">unfold</span> <span class="id">vMap</span>|].<br/>
<br/>
&nbsp;&nbsp;- <span class="tactic">repeat</span> <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span> : <span class="kwd">forall</span> ϕ', <span class="id">In</span> ϕ' (?ϕ::?ψ) -&gt; <span class="id">finite</span> (<span class="id">vMap</span> ϕ')  |- <span class="id">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> ϕ (<span class="id">in_eq</span> ϕ ψ));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">vMap</span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">finite_extend</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">finite_map_composition_2</span>; <span class="tactic">auto</span>.<br/>
<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">Hfin2</span>, <span class="id">in_cons</span>; <span class="tactic">auto</span>.<br/>
<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">finite_adaptation</span> : <span class="id">loo_db</span>.<br/>
<br/>
<span class="kwd">Print</span> σ<span class="id">_wf</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">not_stuck_adaptation</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> σ1 σ2, <span class="id">not_stuck_</span>σ σ2 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> σ, σ1 ◁ σ2 ≜ σ -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">not_stuck_</span>σ σ.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof392')">Proof.</div>
<div class="proofscript" id="proof392">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| [<span class="id">H</span> : ?σ1 ◁ ?σ2 ≜ ?σ |- <span class="id">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">not_stuck_</span>σ, <span class="id">snd</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">destruct_exists_loo</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">andDestruct</span>.<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| [<span class="id">H</span> : ?ϕ1::?ψ  = ?ϕ2::?ψ2 |- <span class="id">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id">frm</span> ((<span class="id">f</span> ∘ β') ∪ β) (<span class="id">c_stmt</span> (❲ <span class="id">f</span>' ↦ <span class="id">s</span> ❳))), ψ0;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">not_stuck_</span>ϕ, <span class="id">contn</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">loo_db</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">not_stuck_adaptation</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">waiting_adaptation</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> σ1 σ2, <span class="id">waiting_</span>σ σ2 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> σ, σ1 ◁ σ2 ≜ σ -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">waiting_</span>σ σ.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof393')">Proof.</div>
<div class="proofscript" id="proof393">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| [<span class="id">H</span> : ?σ1 ◁ ?σ2 ≜ ?σ |- <span class="id">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">waiting_</span>σ, <span class="id">snd</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">destruct_exists_loo</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">andDestruct</span>.<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| [<span class="id">H</span> : ?ϕ1::?ψ  = ?ϕ2::?ψ2 |- <span class="id">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;<span class="id">eexists</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">waiting_adaptation</span> : <span class="id">loo_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">wf_adaptation</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> σ1 σ2, σ<span class="id">_wf</span> σ1 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ<span class="id">_wf</span> σ2 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> σ, σ1 ◁ σ2 ≜ σ -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> α <span class="id">o</span>, (<span class="id">fst</span> σ1) α = <span class="id">Some</span> <span class="id">o</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">o</span>', (<span class="id">fst</span> σ2) α = <span class="id">Some</span> <span class="id">o</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ<span class="id">_wf</span> σ.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof394')">Proof.</div>
<div class="proofscript" id="proof394">
&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">Ha</span> : σ<span class="id">_wf</span> ?σ1,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hb</span> : σ<span class="id">_wf</span> ?σ2 |- <span class="id">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Ha</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hb</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">config_wf</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">loo_db</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">wf_adaptation</span> : <span class="id">loo_db</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">guards_method_call</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">M1</span> <span class="id">M2</span> σ1 σ2, <span class="id">M1</span> ⦂ <span class="id">M2</span> ⦿ σ1 ⤳ σ2 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> χ ϕ σ1' σ2', (χ, ϕ::<span class="id">nil</span>) ◁ σ1 ≜ σ1' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(χ, ϕ::<span class="id">nil</span>) ◁ σ2 ≜ σ2' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ<span class="id">_wf</span> (χ, ϕ::<span class="id">nil</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M1</span> ⦂ <span class="id">M2</span> ⦿ (χ, ϕ::<span class="id">nil</span>) ⤳⋆ σ1 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>, <span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ1' ⊨ <span class="id">guards</span> <span class="id">x</span> <span class="id">y</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ2' ⊨ (¬ <span class="id">guards</span> <span class="id">x</span> <span class="id">y</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> σ σ', <span class="id">M1</span> ⦂ <span class="id">M2</span> ⦿ (χ, ϕ::<span class="id">nil</span>) ⤳⋆ σ -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M1</span> ⦂ <span class="id">M2</span> ⦿ σ ⤳⋆ σ1 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(χ, ϕ::<span class="id">nil</span>) ◁ σ ≜ σ' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ' ⊨ <span class="id">guards</span> <span class="id">x</span> <span class="id">y</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ (χ, ϕ::<span class="id">nil</span>) ⊨ <span class="id">guards</span> <span class="id">x</span> <span class="id">y</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">z</span> <span class="id">m</span> <span class="id">vMap</span>, <span class="id">M1</span> ⦂ <span class="id">M2</span> ◎ σ1' ⊨ ((<span class="id">a_</span> <span class="id">this</span>) <span class="id">calls</span> (<span class="id">a_</span> <span class="id">z</span>) ∎ <span class="id">m</span> ⟨ <span class="id">vMap</span> ⟩).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof395')">Proof.</div>
<div class="proofscript" id="proof395">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">pair_reduction_change_implies_method_call</span> <span class="id">M1</span> <span class="id">M2</span> σ1 σ2);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
<br/>
&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id">pair_reductions_preserves_config_wf</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;- <span class="tactic">repeat</span> <span class="id">destruct_exists_loo</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">andDestruct</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span> : (<span class="id">_</span>, <span class="id">_</span>) ◁ (<span class="id">_</span>, <span class="id">_</span>) ≜ <span class="id">_</span> |- <span class="id">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> (<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">Heq</span> : ?<span class="id">x</span> = ?<span class="id">x</span> |- <span class="id">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">Heq</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span> : (<span class="id">_</span>, <span class="id">_</span>) = (<span class="id">_</span>, <span class="id">_</span>) |- <span class="id">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span> : <span class="id">context</span> [<span class="id">contn</span> <span class="id">_</span>] |- <span class="id">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span> : <span class="id">c_stmt</span> <span class="id">_</span> = <span class="id">c_stmt</span> <span class="id">_</span> |- <span class="id">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rename_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> α := <span class="tactic">fresh</span> "α" <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">o</span> := <span class="tactic">fresh</span> "<span class="id">o</span>" <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">H</span> := <span class="tactic">fresh</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">wf_</span>σ<span class="id">_this_interpretation</span> χ')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(ψ:=ψ')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(ϕ:=<span class="id">frm</span> ((<span class="id">f</span> ∘ β') ∪ β)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">c_stmt</span> (<span class="id">s_stmts</span> (<span class="id">s_meth</span> (❲ <span class="id">f</span>' ↦ <span class="id">x0</span> ❳) (❲ <span class="id">f</span>' ↦ <span class="id">x1</span> ❳) <span class="id">m</span> (❲ <span class="id">f</span>' ↦ <span class="id">vMap</span> ❳)) (❲ <span class="id">f</span>' ↦ <span class="id">s</span> ❳))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> [α <span class="id">H</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+  <span class="tactic">apply</span> (<span class="id">wf_adaptation</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(σ1:= (χ1, (<span class="id">frm</span> β <span class="id">c</span>) :: <span class="id">nil</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(σ2:= (χ', (<span class="id">frm</span> β' (<span class="id">c_stmt</span> (<span class="id">s_stmts</span> (<span class="id">s_meth</span> <span class="id">x0</span> <span class="id">x1</span> <span class="id">m</span> <span class="id">vMap</span>) <span class="id">s</span>))) :: ψ'));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">eapply</span> <span class="id">pair_reductions_preserves_config_wf</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">pair_reductions_heap_monotonic</span>; <span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">destruct_exists_loo</span>; <span class="id">andDestruct</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> (❲ <span class="id">f</span>' ↦ <span class="id">x1</span> ❳), <span class="id">m</span>, (❲ <span class="id">f</span>' ↦ <span class="id">vMap</span> ❳ ∘ <span class="id">v_to_av</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">sat_call</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> (χ:=χ')(ψ:=ψ')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">x</span>':=❲ <span class="id">f</span>' ↦ <span class="id">x0</span> ❳)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">y</span>':=❲ <span class="id">f</span>' ↦ <span class="id">x1</span> ❳)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">vMap</span>':=❲ <span class="id">f</span>' ↦ <span class="id">vMap</span> ❳)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span>:=❲ <span class="id">f</span>' ↦ <span class="id">s</span> ❳);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">admit</span>. <span class="comment">(*&nbsp;x1&nbsp;maps&nbsp;to&nbsp;something&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">admit</span>. <span class="comment">(*&nbsp;x1&nbsp;maps&nbsp;to&nbsp;something&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">admit</span>. <span class="comment">(*&nbsp;same&nbsp;domain&nbsp;refl&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;vMap,&nbsp;the&nbsp;parameters&nbsp;supplied&nbsp;to&nbsp;the&nbsp;method&nbsp;call&nbsp;maps&nbsp;to&nbsp;some&nbsp;values&nbsp;in&nbsp;the&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;this&nbsp;perhaps&nbsp;needs&nbsp;to&nbsp;be&nbsp;added&nbsp;to&nbsp;the&nbsp;reduction&nbsp;definition&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">admit</span>.<br/>
<br/>
&nbsp;&nbsp;- <span class="id">admit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;if&nbsp;the&nbsp;continuation&nbsp;is&nbsp;a&nbsp;return&nbsp;statement,&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;then&nbsp;there&nbsp;is&nbsp;some&nbsp;method&nbsp;call&nbsp;from&nbsp;within&nbsp;M1&nbsp;that&nbsp;is&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;being&nbsp;returned&nbsp;from.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Subsequently,&nbsp;either&nbsp;some&nbsp;method&nbsp;then&nbsp;returns&nbsp;back&nbsp;to&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;client&nbsp;code,&nbsp;or&nbsp;client&nbsp;code&nbsp;is&nbsp;called&nbsp;from&nbsp;the&nbsp;module&nbsp;in&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;question.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)</span><br/>
<br/>
Admitted.</div>
<br/>
<span class="kwd">Module</span> <span class="id">ExposeExample</span>.<br/>
<br/>
<div class="doc"><h3> Safe example: </h3> </div>
<div class="doc">---------------------------------------------------- </div>
<div class="doc"><code> &gt;MyModule = { </code> </div>
<div class="doc"><code> &gt;  Inside = {} </code> </div>
<div class="doc"><code> &gt;  Boundary = { </code> </div>
<div class="doc"><code> &gt;    field inside : Inside </code> </div>
<div class="doc"><code> &gt;    meth expose() = {return this.inside} </code> </div>
<div class="doc"><code> &gt;  } </code> </div>
<div class="doc"><code> &gt;} </code> </div>
<div class="doc">--------------------------------------------------- </div>
<div class="doc"><code> we want to prove: </code> </div>
<div class="doc"> </div>
<div class="doc"><code> &gt;MyModule ⊨  </code> </div>
<div class="doc"><code> &gt;(∀ b, b : Boundary, ∀ i, (b.inside = i ∧ (∀ x, x access i ⇒ x = b)) </code> </div>
<div class="doc"><code> &gt;             ⇒ (∀ p, will⟨ p access i ⟩ </code> </div>
<div class="doc"><code> &gt;               ⇒ (∃ o, will⟨ o calls b.expose() ⟩))) </code> </div>
<div class="doc"> </div>
<div class="doc"> </div>
<br/>
<div class="doc">Inside Definition  </div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">Inside</span> := <span class="id">classID</span> 6.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">InsideDef</span> := <span class="id">clazz</span> <span class="id">Inside</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">nil</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">empty</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">empty</span>.<br/>
<br/>
<div class="doc">Boundary Definition </div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">Boundary</span> := <span class="id">classID</span> 7.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">inside</span> := <span class="id">fieldID</span> 0.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">expose</span> := <span class="id">methID</span> 0.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">x</span> := <span class="id">bnd</span> 10.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">exposeBody</span> := <span class="id">s_stmts</span> (<span class="id">s_asgn</span> (<span class="id">r_var</span> <span class="id">x</span>) (<span class="id">r_fld</span> <span class="id">this</span> <span class="id">inside</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s_rtrn</span> <span class="id">x</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">BoundaryDef</span> := <span class="id">clazz</span> <span class="id">Boundary</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">inside</span> :: <span class="id">nil</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">update</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">expose</span> (<span class="id">nil</span>, <span class="id">exposeBody</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">empty</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">empty</span>.<br/>
<br/>
<div class="doc">MyModule Definition </div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">MyModule</span> := (<span class="id">update</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Boundary</span> <span class="id">BoundaryDef</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">update</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Inside</span> <span class="id">InsideDef</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">empty</span>)).<br/>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Theorem</span> <span class="id">expose_example_will</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">MyModule</span> ⊨<span class="id">m</span> (∀<span class="id">x</span>∙∀<span class="id">x</span>∙(((<span class="id">a_class</span> (<span class="id">e</span>♢1) <span class="id">Boundary</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;∧<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id">e_acc_f</span> (<span class="id">e</span>♢1) <span class="id">inside</span>) ⩦ (<span class="id">e</span>♢0))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;∧<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id">guards</span> (<span class="id">a</span>♢1) (<span class="id">a</span>♢0))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;∧<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">a_will</span> (¬ <span class="id">guards</span> (<span class="id">a</span>♢1) (<span class="id">a</span>♢0)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">a_will</span> (∃<span class="id">x</span>∙((<span class="id">a</span>♢0) <span class="id">calls</span> (<span class="id">a</span>♢2) ∎ <span class="id">expose</span> ⟨ <span class="id">empty</span> ⟩)) ∨<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id">a_</span> <span class="id">this</span>) <span class="id">calls</span> (<span class="id">a</span>♢1) ∎ <span class="id">expose</span> ⟨ <span class="id">empty</span> ⟩)))).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof396')">Proof.</div>
<div class="proofscript" id="proof396">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">mdl_sat</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>;    <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> (<span class="id">a_intros</span>; <span class="id">a_prop</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">destruct_exists_loo</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> σ <span class="kwd">as</span> [χ]; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">subst</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H6</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H10</span>; <span class="tactic">subst</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">admit</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">assert</span> (σ<span class="id">_wf</span> (χ0, ϕ0::ψ0)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span> : <span class="id">update_</span>σ<span class="id">_map</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> = ?σ |- <span class="id">context</span>[?σ]] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> (<span class="tactic">eapply</span> σ<span class="id">_wf_update</span>; <span class="tactic">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">arising_wf</span> <span class="kwd">with</span> (<span class="id">M1</span>:=<span class="id">MyModule</span>)(<span class="id">M2</span>:=<span class="id">M</span>'); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">some</span>σ := <span class="tactic">fresh</span> "σ" <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">exists_adaptation</span> (χ0,ϕ0::ψ0) σ) <span class="kwd">as</span> [<span class="id">some</span>σ];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">pair_reduction_preserves_config_wf</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> (<span class="id">M1</span>:=<span class="id">MyModule</span>)(<span class="id">M2</span>:=<span class="id">M</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(σ1:=(χ0, ϕ0::<span class="id">nil</span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> σ<span class="id">_wf_top_frame</span>; <span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">sat_excluded_middle</span> <span class="id">MyModule</span> <span class="id">M</span>' σ0 (<span class="id">guards</span> (<span class="id">a_</span> <span class="id">z</span>) (<span class="id">a_</span> <span class="id">z0</span>))) <span class="kwd">as</span> [<span class="id">Hsat</span>|<span class="id">Hnsat</span>].<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> <span class="id">will_change_pair_reduction</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> (<span class="id">M1</span>:=<span class="id">MyModule</span>)(<span class="id">M2</span>:=<span class="id">M</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">A</span>:=<span class="id">guards</span> (<span class="id">a_</span> <span class="id">z</span>) (<span class="id">a_</span> <span class="id">z0</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(σ1:=σ)(σ1':=σ0)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(σ2:=σ')(σ2':=σ'')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(σ:=(χ0,ϕ0::ψ0));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">loo_db</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">crush</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">repeat</span> <span class="id">destruct_exists_loo</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">andDestruct</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">Ha</span> := <span class="tactic">fresh</span> "<span class="id">H</span>" <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">Hb</span> := <span class="tactic">fresh</span> "<span class="id">H</span>" <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">pair_reductions_alt_definition</span> <span class="id">MyModule</span> <span class="id">M</span>' σ σ1)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> [<span class="id">Ha</span> <span class="id">Hb</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span> : <span class="id">MyModule</span> ⦂ <span class="id">M</span>' ⦿ σ ⤳⋆ σ1 |- <span class="id">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">Ha</span> <span class="id">H</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Ha</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="tactic">destruct</span> (<span class="id">pair_reduction_change_implies_method_call</span> <span class="id">MyModule</span> <span class="id">M</span>' σ σ1);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">loo_db</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*** <span class="tactic">repeat</span> <span class="id">destruct_exists_loo</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">andDestruct</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">sat_will</span> <span class="kwd">with</span> (χ:=χ0)(ψ:=ψ0)(ϕ:=ϕ0)(σ':=(χ1,ϕ1::ψ1))(σ'':=σ0);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">loo_db</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H9</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">admit</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*** <span class="id">admit</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id">admit</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">admit</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">admit</span>.<br/>
<br/>
&nbsp;&nbsp;Admitted.</div>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Theorem</span> <span class="id">expose_example_was</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">MyModule</span> ⊨<span class="id">m</span> (∀<span class="id">x</span>∙∀<span class="id">x</span>∙((<span class="id">a_was</span> (((<span class="id">a_class</span> (<span class="id">e</span>♢1) <span class="id">Boundary</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;∧<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id">e_acc_f</span> (<span class="id">e</span>♢1) <span class="id">inside</span>) ⩦ (<span class="id">e</span>♢0)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;∧<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id">guards</span> (<span class="id">a</span>♢1) (<span class="id">a</span>♢0))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;∧<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(¬ <span class="id">guards</span> (<span class="id">a</span>♢1) (<span class="id">a</span>♢0)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">a_was</span>(∃<span class="id">x</span>∙((<span class="id">a</span>♢0) <span class="id">calls</span> (<span class="id">a</span>♢2) ∎ <span class="id">expose</span> ⟨ <span class="id">empty</span> ⟩)))).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof397')">Proof.</div>
<div class="proofscript" id="proof397">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">mdl_sat</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> (<span class="id">a_intros</span>; <span class="id">a_prop</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.    <br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H5</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">sat_was</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H11</span> σ0);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">auto_specialize</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H11</span> <span class="kwd">as</span> [σ' <span class="id">Htmp</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Htmp</span> <span class="kwd">as</span> [σ''];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">andDestruct</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hb</span>; <span class="tactic">subst</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hwf</span> : σ<span class="id">_wf</span> σ');<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">loo_db</span>|].<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">was_change_pair_reduction</span> <span class="id">MyModule</span> <span class="id">M</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> (σ:=(<span class="id">update_</span>σ<span class="id">_map</span> (<span class="id">update_</span>σ<span class="id">_map</span> σ <span class="id">z</span> <span class="id">v</span>) <span class="id">z0</span> <span class="id">v0</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(σ':=σ')(<span class="id">A</span>:=¬ <span class="id">guards</span> (<span class="id">a_</span> <span class="id">z</span>) (<span class="id">a_</span> <span class="id">z0</span>))(σ'':=σ'')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> [<span class="id">Hwas</span>|<span class="id">Hwas</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="tactic">apply</span> <span class="id">sat_not</span>, <span class="id">nsat_not</span>; <span class="tactic">auto</span>| |<span class="tactic">destruct</span> <span class="id">Hwas</span> <span class="kwd">as</span> [<span class="id">Hwas</span>|<span class="id">Hwas</span>]].<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">Hwas</span> <span class="kwd">as</span> [σ1 <span class="id">Htmp</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Htmp</span> <span class="kwd">as</span> [σ1' <span class="id">Htmp</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Htmp</span> <span class="kwd">as</span> [σ2 <span class="id">Htmp</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Htmp</span> <span class="kwd">as</span> [σ2' <span class="id">Htmp</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">andDestruct</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> σ1, σ1';<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">split</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">loo_db</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">pair_reduction_change_implies_method_call</span> <span class="id">MyModule</span> <span class="id">M</span>' σ1 σ2)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> [<span class="id">Hcont</span>|<span class="id">Hcont</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">loo_db</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|<span class="tactic">destruct</span> <span class="id">Hcont</span> <span class="kwd">as</span> [<span class="id">Hcont</span>|<span class="id">Hcont</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">destruct</span> <span class="id">Hcont</span> <span class="kwd">as</span> [χ1 <span class="id">Hcont</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hcont</span> <span class="kwd">as</span> [ϕ1 <span class="id">Hcont</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hcont</span> <span class="kwd">as</span> [ψ1 <span class="id">Hcont</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hcont</span> <span class="kwd">as</span> [<span class="id">x</span>' <span class="id">Hcont</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hcont</span> <span class="kwd">as</span> [<span class="id">y</span>' <span class="id">Hcont</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hcont</span> <span class="kwd">as</span> [<span class="id">m</span> <span class="id">Hcont</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hcont</span> <span class="kwd">as</span> [<span class="id">ps</span> <span class="id">Hcont</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hcont</span> <span class="kwd">as</span> [<span class="id">s</span> <span class="id">Hcont</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">andDestruct</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">admit</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">admit</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">admit</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">Hwas</span> <span class="kwd">as</span> [σ1 <span class="id">Htmp</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Htmp</span> <span class="kwd">as</span> [σ1' <span class="id">Htmp</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">andDestruct</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> σ1, σ1';<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">split</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">loo_db</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;Abort.</div>
<br/>
<span class="kwd">End</span> <span class="id">ExposeExample</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
<span class="kwd">Fixpoint</span> <span class="id">syntactic_depth</span> (<span class="id">A</span> : <span class="id">asrt</span>) : <span class="id">nat</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">A</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id">A1</span> ⇒ <span class="id">A2</span> =&gt; 1 + (<span class="id">syntactic_depth</span> <span class="id">A1</span>) + (<span class="id">syntactic_depth</span> <span class="id">A2</span>)<br/>
&nbsp;&nbsp;| <span class="id">A1</span> ∨ <span class="id">A2</span> =&gt; 1 + (<span class="id">syntactic_depth</span> <span class="id">A1</span>) + (<span class="id">syntactic_depth</span> <span class="id">A2</span>)<br/>
&nbsp;&nbsp;| <span class="id">A1</span> ∧ <span class="id">A2</span> =&gt; 1 + (<span class="id">syntactic_depth</span> <span class="id">A1</span>) + (<span class="id">syntactic_depth</span> <span class="id">A2</span>)<br/>
&nbsp;&nbsp;| ¬ <span class="id">A</span> =&gt; 1 + (<span class="id">syntactic_depth</span> <span class="id">A</span>)<br/>
&nbsp;&nbsp;| (∀<span class="id">x</span>∙ <span class="id">A</span>) =&gt; 1 + (<span class="id">syntactic_depth</span> <span class="id">A</span>)<br/>
&nbsp;&nbsp;| (∀<span class="id">S</span>∙ <span class="id">A</span>) =&gt; 1 + (<span class="id">syntactic_depth</span> <span class="id">A</span>)<br/>
&nbsp;&nbsp;| (∃<span class="id">x</span>∙ <span class="id">A</span>) =&gt; 1 + (<span class="id">syntactic_depth</span> <span class="id">A</span>)<br/>
&nbsp;&nbsp;| (∃<span class="id">S</span>∙ <span class="id">A</span>) =&gt; 1 + (<span class="id">syntactic_depth</span> <span class="id">A</span>)<br/>
&nbsp;&nbsp;| <span class="id">a_next</span> <span class="id">A</span> =&gt; 1 + (<span class="id">syntactic_depth</span> <span class="id">A</span>)<br/>
&nbsp;&nbsp;| <span class="id">a_will</span> <span class="id">A</span> =&gt; 1 + (<span class="id">syntactic_depth</span> <span class="id">A</span>)<br/>
&nbsp;&nbsp;| <span class="id">a_prev</span> <span class="id">A</span> =&gt; 1 + (<span class="id">syntactic_depth</span> <span class="id">A</span>)<br/>
&nbsp;&nbsp;| <span class="id">a_was</span> <span class="id">A</span> =&gt; 1 + (<span class="id">syntactic_depth</span> <span class="id">A</span>)<br/>
&nbsp;&nbsp;| <span class="id">a_in</span> <span class="id">A</span> <span class="id">_</span> =&gt; 1 + (<span class="id">syntactic_depth</span> <span class="id">A</span>)<br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; 0<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">syntactic_depth_eq_raise</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span> <span class="id">n</span>, <span class="id">syntactic_depth</span> <span class="id">A</span> = (<span class="id">syntactic_depth</span> (<span class="id">A</span> ↑ <span class="id">n</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof398')">Proof.</div>
<div class="proofscript" id="proof398">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">A</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">A</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Coq.Program.Wf</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">substitution_entails</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A1</span> <span class="id">A2</span>, <span class="id">entails</span> <span class="id">A1</span> <span class="id">A2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">z</span>, <span class="id">notin_Ax</span> <span class="id">A1</span> <span class="id">z</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">notin_Ax</span> <span class="id">A2</span> <span class="id">z</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">entails</span> ([<span class="id">z</span> /<span class="id">s</span> 0] <span class="id">A1</span>) ([<span class="id">z</span> /<span class="id">s</span> 0] <span class="id">A2</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof399')">Proof.</div>
<div class="proofscript" id="proof399">
&nbsp;&nbsp;<span class="tactic">intros</span><br/>
Qed.</div>
<br/>
<div class="doc">&lt;h2&gt;Thoughts on access, expose, temporal operators:&lt;/h2&gt; </div>
<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</a></div>
</body>
</html>
